Sets
i Steiner points / 1*108 /
j terminals / 1*110 /
k dimensions / 1*3 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.9510547662752967; terminals('1', '2') = 0.6172409509966349; terminals('1', '3') = 0.9346548918561803; 
terminals('2', '1') = 0.40197650760905357; terminals('2', '2') = 0.01624096433105726; terminals('2', '3') = 0.6170019620134667; 
terminals('3', '1') = 0.3369321436481334; terminals('3', '2') = 0.8843622858860657; terminals('3', '3') = 0.6339546560746055; 
terminals('4', '1') = 0.8241562414287954; terminals('4', '2') = 0.12081363892888786; terminals('4', '3') = 0.08556682575353469; 
terminals('5', '1') = 0.8079675691156876; terminals('5', '2') = 0.24500415135673737; terminals('5', '3') = 0.8535742722620738; 
terminals('6', '1') = 0.026761133364168188; terminals('6', '2') = 0.5733331968723385; terminals('6', '3') = 0.054238398028165324; 
terminals('7', '1') = 0.05793363185252032; terminals('7', '2') = 0.9137461289638272; terminals('7', '3') = 0.7479259647221425; 
terminals('8', '1') = 0.7420708079590199; terminals('8', '2') = 0.22702036915765444; terminals('8', '3') = 0.5726017391331775; 
terminals('9', '1') = 0.8600782726444334; terminals('9', '2') = 0.5199193402008849; terminals('9', '3') = 0.901107627962905; 
terminals('10', '1') = 0.933779034036333; terminals('10', '2') = 0.5558807896585998; terminals('10', '3') = 0.17225365684912508; 
terminals('11', '1') = 0.6010147441429369; terminals('11', '2') = 0.9006061572961407; terminals('11', '3') = 0.34061368561011307; 
terminals('12', '1') = 0.9863084481078073; terminals('12', '2') = 0.7746287978395865; terminals('12', '3') = 0.026869591052983366; 
terminals('13', '1') = 0.3905915807676845; terminals('13', '2') = 0.6161003776181447; terminals('13', '3') = 0.6337964077636216; 
terminals('14', '1') = 0.7664781758602898; terminals('14', '2') = 0.5143636599648348; terminals('14', '3') = 0.5482646385999219; 
terminals('15', '1') = 0.21276862147157183; terminals('15', '2') = 0.7750222332540398; terminals('15', '3') = 0.7952482039387619; 
terminals('16', '1') = 0.9723441259256966; terminals('16', '2') = 0.388338755683606; terminals('16', '3') = 0.029021493001968324; 
terminals('17', '1') = 0.3529493775288868; terminals('17', '2') = 0.3969892203413542; terminals('17', '3') = 0.18098052348976146; 
terminals('18', '1') = 0.8493227935175711; terminals('18', '2') = 0.7982231609892717; terminals('18', '3') = 0.9873868263053331; 
terminals('19', '1') = 0.5372571091712501; terminals('19', '2') = 0.715365207387404; terminals('19', '3') = 0.10074689456427677; 
terminals('20', '1') = 0.01648776793349438; terminals('20', '2') = 0.9274639280337236; terminals('20', '3') = 0.6293812915877414; 
terminals('21', '1') = 0.18049912114118316; terminals('21', '2') = 0.9367360830446041; terminals('21', '3') = 0.2341558311446228; 
terminals('22', '1') = 0.25755653590461347; terminals('22', '2') = 0.9820080239522452; terminals('22', '3') = 0.836677327264396; 
terminals('23', '1') = 0.5676506629957698; terminals('23', '2') = 0.7720025533528064; terminals('23', '3') = 0.22851553592397844; 
terminals('24', '1') = 0.6359746493257586; terminals('24', '2') = 0.45311652774464695; terminals('24', '3') = 0.16688042972784844; 
terminals('25', '1') = 0.49246420198933094; terminals('25', '2') = 0.7495397783221704; terminals('25', '3') = 0.09784193698815347; 
terminals('26', '1') = 0.7117963971960715; terminals('26', '2') = 0.5516613438382773; terminals('26', '3') = 0.5709967404491492; 
terminals('27', '1') = 0.7584109112308475; terminals('27', '2') = 0.38073222960522135; terminals('27', '3') = 0.6435998616722133; 
terminals('28', '1') = 0.912889318507763; terminals('28', '2') = 0.3577250773247831; terminals('28', '3') = 0.010031433417426738; 
terminals('29', '1') = 0.4696248292834464; terminals('29', '2') = 0.9066554431012276; terminals('29', '3') = 0.5949928648616241; 
terminals('30', '1') = 0.9838766606986024; terminals('30', '2') = 0.19675774422629833; terminals('30', '3') = 0.9065858869591341; 
terminals('31', '1') = 0.23846408949219844; terminals('31', '2') = 0.671084860962739; terminals('31', '3') = 0.6118525712129222; 
terminals('32', '1') = 0.7017780942028411; terminals('32', '2') = 0.5629668749569305; terminals('32', '3') = 0.7769210285471131; 
terminals('33', '1') = 0.3078868287902946; terminals('33', '2') = 0.03987067653758447; terminals('33', '3') = 0.306564412208846; 
terminals('34', '1') = 0.43904943818754005; terminals('34', '2') = 0.8724853746298067; terminals('34', '3') = 0.5252270205638708; 
terminals('35', '1') = 0.9337662576023821; terminals('35', '2') = 0.9884464430234128; terminals('35', '3') = 0.9840818994875974; 
terminals('36', '1') = 0.812743585873776; terminals('36', '2') = 0.48022298036876865; terminals('36', '3') = 0.6451706155172016; 
terminals('37', '1') = 0.44355364787843976; terminals('37', '2') = 0.9103575317125497; terminals('37', '3') = 0.10073933480713348; 
terminals('38', '1') = 0.1504932768129852; terminals('38', '2') = 0.667946140707317; terminals('38', '3') = 0.19099978613203594; 
terminals('39', '1') = 0.02434133746347744; terminals('39', '2') = 0.9928833836871681; terminals('39', '3') = 0.3961829189178937; 
terminals('40', '1') = 0.5682662414421826; terminals('40', '2') = 0.8835881194400554; terminals('40', '3') = 0.6382710958216954; 
terminals('41', '1') = 0.3912732819946426; terminals('41', '2') = 0.40168557936316396; terminals('41', '3') = 0.9523907220446194; 
terminals('42', '1') = 0.16453043882295326; terminals('42', '2') = 0.6346943588831249; terminals('42', '3') = 0.20715241777464122; 
terminals('43', '1') = 0.06943166354171781; terminals('43', '2') = 0.3040330304196599; terminals('43', '3') = 0.7221529639517139; 
terminals('44', '1') = 0.6252256702760552; terminals('44', '2') = 0.5291352797946632; terminals('44', '3') = 0.7826217952088669; 
terminals('45', '1') = 0.7457626187855395; terminals('45', '2') = 0.2767750372261346; terminals('45', '3') = 0.3805693169371762; 
terminals('46', '1') = 0.8724635689877681; terminals('46', '2') = 0.018068720852228215; terminals('46', '3') = 0.9059820402500065; 
terminals('47', '1') = 0.36611433807067784; terminals('47', '2') = 0.09908375455995522; terminals('47', '3') = 0.5850193887464502; 
terminals('48', '1') = 0.40878813849230544; terminals('48', '2') = 0.26641169371666484; terminals('48', '3') = 0.3556664720138901; 
terminals('49', '1') = 0.39107034569579413; terminals('49', '2') = 0.20927912732027032; terminals('49', '3') = 0.4761895782130783; 
terminals('50', '1') = 0.7316242250861715; terminals('50', '2') = 0.37096997806137966; terminals('50', '3') = 0.8081950347951061; 
terminals('51', '1') = 0.06462635544382245; terminals('51', '2') = 0.5067981717334412; terminals('51', '3') = 0.9788365164862023; 
terminals('52', '1') = 0.951104824872365; terminals('52', '2') = 0.08910427571238666; terminals('52', '3') = 0.7954519356070203; 
terminals('53', '1') = 0.8594413582522673; terminals('53', '2') = 0.48421790644054763; terminals('53', '3') = 0.8673077076054742; 
terminals('54', '1') = 0.553069439231885; terminals('54', '2') = 0.19543791511700026; terminals('54', '3') = 0.9509281493539403; 
terminals('55', '1') = 0.4902411866877836; terminals('55', '2') = 0.8045373381762799; terminals('55', '3') = 0.3704301544660551; 
terminals('56', '1') = 0.7066075210322362; terminals('56', '2') = 0.2669704318733409; terminals('56', '3') = 0.27013508046012524; 
terminals('57', '1') = 0.6303372959229193; terminals('57', '2') = 0.2471907524196192; terminals('57', '3') = 0.20028905085710313; 
terminals('58', '1') = 0.34193654064725965; terminals('58', '2') = 0.0003097931843550894; terminals('58', '3') = 0.9596731707371229; 
terminals('59', '1') = 0.9383464698013702; terminals('59', '2') = 0.18582942710985506; terminals('59', '3') = 0.9943017906886827; 
terminals('60', '1') = 0.7380521157227046; terminals('60', '2') = 0.44666972527822546; terminals('60', '3') = 0.614996287979456; 
terminals('61', '1') = 0.1509257325151172; terminals('61', '2') = 0.3647011543544908; terminals('61', '3') = 0.6744144715933038; 
terminals('62', '1') = 0.6692048132588313; terminals('62', '2') = 0.24801615495483864; terminals('62', '3') = 0.47738620066552806; 
terminals('63', '1') = 0.14996260249190996; terminals('63', '2') = 0.40489079081488333; terminals('63', '3') = 0.19870194395702778; 
terminals('64', '1') = 0.91146092207856; terminals('64', '2') = 0.4499837329624883; terminals('64', '3') = 0.7169935146577796; 
terminals('65', '1') = 0.7811625612359842; terminals('65', '2') = 0.8474076640149486; terminals('65', '3') = 0.22438335428354306; 
terminals('66', '1') = 0.18083901814294567; terminals('66', '2') = 0.7722429534794218; terminals('66', '3') = 0.28976106920203637; 
terminals('67', '1') = 0.14742855198716331; terminals('67', '2') = 0.8859922819227511; terminals('67', '3') = 0.43669074172632294; 
terminals('68', '1') = 0.30731668490688435; terminals('68', '2') = 0.12910541102560513; terminals('68', '3') = 0.6162744708887896; 
terminals('69', '1') = 0.210646627960831; terminals('69', '2') = 0.6319158321661651; terminals('69', '3') = 0.3963322100819112; 
terminals('70', '1') = 0.5513504972140493; terminals('70', '2') = 0.8576008045208265; terminals('70', '3') = 0.16481672869115294; 
terminals('71', '1') = 0.43752429902706513; terminals('71', '2') = 0.6645914511172242; terminals('71', '3') = 0.5858439935853963; 
terminals('72', '1') = 0.05122560938803489; terminals('72', '2') = 0.9392017988072437; terminals('72', '3') = 0.008720087168976765; 
terminals('73', '1') = 0.3236768910093356; terminals('73', '2') = 0.2981185403097588; terminals('73', '3') = 0.6859724726734859; 
terminals('74', '1') = 0.643248532504355; terminals('74', '2') = 0.16609688748470808; terminals('74', '3') = 0.9362910144536516; 
terminals('75', '1') = 0.8577629068930511; terminals('75', '2') = 0.7640945909788059; terminals('75', '3') = 0.7759037786825097; 
terminals('76', '1') = 0.7839784505359435; terminals('76', '2') = 0.059734790632174906; terminals('76', '3') = 0.2783343800621082; 
terminals('77', '1') = 0.7356434149894201; terminals('77', '2') = 0.7556750370183328; terminals('77', '3') = 0.902805363151665; 
terminals('78', '1') = 0.01711989607913189; terminals('78', '2') = 0.056225346719007696; terminals('78', '3') = 0.31289956586168977; 
terminals('79', '1') = 0.05730554480734962; terminals('79', '2') = 0.697207287251056; terminals('79', '3') = 0.9112031737824637; 
terminals('80', '1') = 0.2692240692582991; terminals('80', '2') = 0.02483004323343363; terminals('80', '3') = 0.751435573228565; 
terminals('81', '1') = 0.5366552639955446; terminals('81', '2') = 0.17033799674480465; terminals('81', '3') = 0.4530515142623963; 
terminals('82', '1') = 0.5301537958547827; terminals('82', '2') = 0.21983345145363653; terminals('82', '3') = 0.605757862081105; 
terminals('83', '1') = 0.027006422084201676; terminals('83', '2') = 0.45115306070888417; terminals('83', '3') = 0.056600984088434725; 
terminals('84', '1') = 0.7248574201494469; terminals('84', '2') = 0.36054524783308195; terminals('84', '3') = 0.07299624713978237; 
terminals('85', '1') = 0.25424823208496283; terminals('85', '2') = 0.700304561394926; terminals('85', '3') = 0.06156482134061869; 
terminals('86', '1') = 0.6846375379092766; terminals('86', '2') = 0.23978425576159512; terminals('86', '3') = 0.23968909100844848; 
terminals('87', '1') = 0.06350986958059623; terminals('87', '2') = 0.8870672277576449; terminals('87', '3') = 0.23182332942699502; 
terminals('88', '1') = 0.30332070114985854; terminals('88', '2') = 0.8700746676755409; terminals('88', '3') = 0.42933493401612954; 
terminals('89', '1') = 0.06421655755116118; terminals('89', '2') = 0.2599981041184365; terminals('89', '3') = 0.094286769214459; 
terminals('90', '1') = 0.9848190911079403; terminals('90', '2') = 0.2588174301801279; terminals('90', '3') = 0.6816008313559141; 
terminals('91', '1') = 0.1880088071389895; terminals('91', '2') = 0.7476130501518468; terminals('91', '3') = 0.13203824910947204; 
terminals('92', '1') = 0.9325066666254789; terminals('92', '2') = 0.5832343591698166; terminals('92', '3') = 0.5908748204842681; 
terminals('93', '1') = 0.3972198665720259; terminals('93', '2') = 0.9428590784011228; terminals('93', '3') = 0.8363735759110847; 
terminals('94', '1') = 0.49408714565798106; terminals('94', '2') = 0.2547605673872676; terminals('94', '3') = 0.7465485737537437; 
terminals('95', '1') = 0.7699080318983902; terminals('95', '2') = 0.1879432001521879; terminals('95', '3') = 0.49122659800350144; 
terminals('96', '1') = 0.4255646843325829; terminals('96', '2') = 0.8561100915715734; terminals('96', '3') = 0.01326603005650051; 
terminals('97', '1') = 0.9889919601368051; terminals('97', '2') = 0.8480847837025108; terminals('97', '3') = 0.707199942759544; 
terminals('98', '1') = 0.36246761303907016; terminals('98', '2') = 0.17426758300594347; terminals('98', '3') = 0.3785402960351125; 
terminals('99', '1') = 0.9144589065427334; terminals('99', '2') = 0.2558439870348954; terminals('99', '3') = 0.07616518175025322; 
terminals('100', '1') = 0.4677507779478314; terminals('100', '2') = 0.6026352275107286; terminals('100', '3') = 0.42185459486206256; 
terminals('101', '1') = 0.07783691651030711; terminals('101', '2') = 0.4751717920470586; terminals('101', '3') = 0.5331313569694979; 
terminals('102', '1') = 0.7491305607195783; terminals('102', '2') = 0.7508286534107024; terminals('102', '3') = 0.4566935921230776; 
terminals('103', '1') = 0.048604050197762705; terminals('103', '2') = 0.13199907566286895; terminals('103', '3') = 0.03190819393099853; 
terminals('104', '1') = 0.035245142836677346; terminals('104', '2') = 0.49585021797861284; terminals('104', '3') = 0.6159329910654692; 
terminals('105', '1') = 0.9509254267961512; terminals('105', '2') = 0.3279577184062211; terminals('105', '3') = 0.7827258625753813; 
terminals('106', '1') = 0.5252638968849452; terminals('106', '2') = 0.5066468131298322; terminals('106', '3') = 0.7730457234480026; 
terminals('107', '1') = 0.6097703427430404; terminals('107', '2') = 0.214749347944303; terminals('107', '3') = 0.8464108173094237; 
terminals('108', '1') = 0.434415036136356; terminals('108', '2') = 0.8043746125029826; terminals('108', '3') = 0.21381314532894558; 
terminals('109', '1') = 0.8783351502063406; terminals('109', '2') = 0.6154733800070209; terminals('109', '3') = 0.9146266332744603; 
terminals('110', '1') = 0.30800412369493513; terminals('110', '2') = 0.34460862472596476; terminals('110', '3') = 0.8798109751145105; 
Parameter bigM / 1.7320508075688772 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
