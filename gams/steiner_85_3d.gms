Sets
i Steiner points / 1*83 /
j terminals / 1*85 /
k dimensions / 1*3 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.055298181805084945; terminals('1', '2') = 0.6404929208469637; terminals('1', '3') = 0.7953219233817382; 
terminals('2', '1') = 0.0461501622313375; terminals('2', '2') = 0.9923938838564021; terminals('2', '3') = 0.6106436383124418; 
terminals('3', '1') = 0.1266073921027111; terminals('3', '2') = 0.6856397877646961; terminals('3', '3') = 0.5621919949134299; 
terminals('4', '1') = 0.38421825989439873; terminals('4', '2') = 0.2925853102271584; terminals('4', '3') = 0.44470673765596047; 
terminals('5', '1') = 0.18465490604184442; terminals('5', '2') = 0.606499779718042; terminals('5', '3') = 0.3123587848088659; 
terminals('6', '1') = 0.8581085284554757; terminals('6', '2') = 0.5346054669201374; terminals('6', '3') = 0.35261349973807044; 
terminals('7', '1') = 0.841487037326937; terminals('7', '2') = 0.8640112191166323; terminals('7', '3') = 0.20218575336824018; 
terminals('8', '1') = 0.5212189018890245; terminals('8', '2') = 0.33389598467827064; terminals('8', '3') = 0.7142628163205057; 
terminals('9', '1') = 0.1468817661477596; terminals('9', '2') = 0.21332820705030475; terminals('9', '3') = 0.589888033605876; 
terminals('10', '1') = 0.36998867660515034; terminals('10', '2') = 0.21781301953813792; terminals('10', '3') = 0.9553949293916332; 
terminals('11', '1') = 0.42644622498069895; terminals('11', '2') = 0.23934011784898723; terminals('11', '3') = 0.06409779890293976; 
terminals('12', '1') = 0.5466669753225312; terminals('12', '2') = 0.6427934285033698; terminals('12', '3') = 0.8993421474278135; 
terminals('13', '1') = 0.11447384690342344; terminals('13', '2') = 0.2973886375511099; terminals('13', '3') = 0.722616988963009; 
terminals('14', '1') = 0.39243719389506415; terminals('14', '2') = 0.20236235996359453; terminals('14', '3') = 0.9585663566894795; 
terminals('15', '1') = 0.2879249610929293; terminals('15', '2') = 0.7169993042949322; terminals('15', '3') = 0.5565388591648559; 
terminals('16', '1') = 0.29844907847319235; terminals('16', '2') = 0.9715466518114396; terminals('16', '3') = 0.564527986328018; 
terminals('17', '1') = 0.5678521426137803; terminals('17', '2') = 0.6984129010928063; terminals('17', '3') = 0.9977499649690053; 
terminals('18', '1') = 0.35149686746073205; terminals('18', '2') = 0.7947798979207105; terminals('18', '3') = 0.6698208179596465; 
terminals('19', '1') = 0.923155842361265; terminals('19', '2') = 0.5947821583335888; terminals('19', '3') = 0.986710472270676; 
terminals('20', '1') = 0.8236527090991979; terminals('20', '2') = 0.5569209960708207; terminals('20', '3') = 0.9747035629531178; 
terminals('21', '1') = 0.047306491646707194; terminals('21', '2') = 0.4181543130644886; terminals('21', '3') = 0.09404480197943932; 
terminals('22', '1') = 0.46792238448315193; terminals('22', '2') = 0.859677223236407; terminals('22', '3') = 0.808441385232191; 
terminals('23', '1') = 0.4362130538850746; terminals('23', '2') = 0.6690872741198797; terminals('23', '3') = 0.3973819526337059; 
terminals('24', '1') = 0.38880752367186844; terminals('24', '2') = 0.7965284377471226; terminals('24', '3') = 0.892636658824226; 
terminals('25', '1') = 0.6785932394592058; terminals('25', '2') = 0.9880220330266033; terminals('25', '3') = 0.45048945977050614; 
terminals('26', '1') = 0.30721262884235645; terminals('26', '2') = 0.023272564007559393; terminals('26', '3') = 0.7924982577691287; 
terminals('27', '1') = 0.7421419121889032; terminals('27', '2') = 0.38929961651109257; terminals('27', '3') = 0.7094046520346149; 
terminals('28', '1') = 0.0841100966697178; terminals('28', '2') = 0.04147776024658867; terminals('28', '3') = 0.8093366357435317; 
terminals('29', '1') = 0.18498910948262437; terminals('29', '2') = 0.012279813449664223; terminals('29', '3') = 0.5391478354129597; 
terminals('30', '1') = 0.6337351185582484; terminals('30', '2') = 0.712947030968392; terminals('30', '3') = 0.20409105476971479; 
terminals('31', '1') = 0.896797125128223; terminals('31', '2') = 0.4600062514956177; terminals('31', '3') = 0.03396668915278578; 
terminals('32', '1') = 0.4074565488439488; terminals('32', '2') = 0.13766566103413447; terminals('32', '3') = 0.5074660008931239; 
terminals('33', '1') = 0.1388456375258238; terminals('33', '2') = 0.2229510937479885; terminals('33', '3') = 0.508488810037029; 
terminals('34', '1') = 0.7076875842683812; terminals('34', '2') = 0.7298137807984764; terminals('34', '3') = 0.8225337162533757; 
terminals('35', '1') = 0.7910420443729591; terminals('35', '2') = 0.8042594056284357; terminals('35', '3') = 0.34317870266044836; 
terminals('36', '1') = 0.994632960266418; terminals('36', '2') = 0.8032731137926904; terminals('36', '3') = 0.41358714863512014; 
terminals('37', '1') = 0.4239425267134701; terminals('37', '2') = 0.012448674358045086; terminals('37', '3') = 0.06264242189127311; 
terminals('38', '1') = 0.7115212128030396; terminals('38', '2') = 0.687971249853855; terminals('38', '3') = 0.31726225407490216; 
terminals('39', '1') = 0.8416093451857322; terminals('39', '2') = 0.4634440097001318; terminals('39', '3') = 0.7456304294924018; 
terminals('40', '1') = 0.3444473783971841; terminals('40', '2') = 0.1922597317476692; terminals('40', '3') = 0.11871519394384711; 
terminals('41', '1') = 0.13023837463920773; terminals('41', '2') = 0.3357887307116513; terminals('41', '3') = 0.5693645663597184; 
terminals('42', '1') = 0.7710965544229135; terminals('42', '2') = 0.45065984969006234; terminals('42', '3') = 0.5407941557502085; 
terminals('43', '1') = 0.5935999512816135; terminals('43', '2') = 0.738120017516367; terminals('43', '3') = 0.8459409208439707; 
terminals('44', '1') = 0.39535402926003294; terminals('44', '2') = 0.5066647274025488; terminals('44', '3') = 0.7630735440157272; 
terminals('45', '1') = 0.5828473275525011; terminals('45', '2') = 0.8969696225673292; terminals('45', '3') = 0.5548759344932418; 
terminals('46', '1') = 0.31246551233758124; terminals('46', '2') = 0.3886589993469566; terminals('46', '3') = 0.7375868873892084; 
terminals('47', '1') = 0.8655600533079936; terminals('47', '2') = 0.7076042644025518; terminals('47', '3') = 0.7888113554614383; 
terminals('48', '1') = 0.9745843948655464; terminals('48', '2') = 0.9413444887839983; terminals('48', '3') = 0.5359851461245125; 
terminals('49', '1') = 0.9220104514323112; terminals('49', '2') = 0.5535235494478246; terminals('49', '3') = 0.9742482015137603; 
terminals('50', '1') = 0.03742613781641768; terminals('50', '2') = 0.5310737423905237; terminals('50', '3') = 0.36341013438715075; 
terminals('51', '1') = 0.7193606995499586; terminals('51', '2') = 0.3726946165841275; terminals('51', '3') = 0.2881194690055324; 
terminals('52', '1') = 0.5298820251354379; terminals('52', '2') = 0.49259611958521055; terminals('52', '3') = 0.06872402039107417; 
terminals('53', '1') = 0.697397139233128; terminals('53', '2') = 0.0010719997434637252; terminals('53', '3') = 0.32945829096185153; 
terminals('54', '1') = 0.2456119036572023; terminals('54', '2') = 0.40642657619850164; terminals('54', '3') = 0.47854144613172134; 
terminals('55', '1') = 0.9990356862548115; terminals('55', '2') = 0.6160947549533934; terminals('55', '3') = 0.13419565689653135; 
terminals('56', '1') = 0.7237188854455073; terminals('56', '2') = 0.11930590663846607; terminals('56', '3') = 0.43654795224319476; 
terminals('57', '1') = 0.986566029903054; terminals('57', '2') = 0.9409445248098733; terminals('57', '3') = 0.8637245477184563; 
terminals('58', '1') = 0.901714228247394; terminals('58', '2') = 0.5569433651424864; terminals('58', '3') = 0.6468565139825363; 
terminals('59', '1') = 0.7674285178489421; terminals('59', '2') = 0.6295414768383469; terminals('59', '3') = 0.69430693913463; 
terminals('60', '1') = 0.9730141337498511; terminals('60', '2') = 0.5014587031628981; terminals('60', '3') = 0.04463944955106569; 
terminals('61', '1') = 0.5901730600994688; terminals('61', '2') = 0.6803444313819593; terminals('61', '3') = 0.8776429372034883; 
terminals('62', '1') = 0.583323216758678; terminals('62', '2') = 0.31824625741380674; terminals('62', '3') = 0.7865098639056863; 
terminals('63', '1') = 0.2632312815883139; terminals('63', '2') = 0.7291263058665957; terminals('63', '3') = 0.5042210692035723; 
terminals('64', '1') = 0.9289257686636531; terminals('64', '2') = 0.8530013858398827; terminals('64', '3') = 0.08860751738119732; 
terminals('65', '1') = 0.44569927692002864; terminals('65', '2') = 0.44358264997447017; terminals('65', '3') = 0.931506873151986; 
terminals('66', '1') = 0.09990818535358037; terminals('66', '2') = 0.4190879604588986; terminals('66', '3') = 0.5177235182099945; 
terminals('67', '1') = 0.3300119732973079; terminals('67', '2') = 0.8505583400201787; terminals('67', '3') = 0.8910829143745025; 
terminals('68', '1') = 0.9536880344409042; terminals('68', '2') = 0.5757435871653683; terminals('68', '3') = 0.7710140626718605; 
terminals('69', '1') = 0.46714820582440486; terminals('69', '2') = 0.0015728909770708066; terminals('69', '3') = 0.5436894439262802; 
terminals('70', '1') = 0.7669742897129646; terminals('70', '2') = 0.6658292286393216; terminals('70', '3') = 0.6845327622202909; 
terminals('71', '1') = 0.7549573654271922; terminals('71', '2') = 0.9856070448444654; terminals('71', '3') = 0.9700864767107075; 
terminals('72', '1') = 0.7128238349608957; terminals('72', '2') = 0.3883641067521254; terminals('72', '3') = 0.5658465803330451; 
terminals('73', '1') = 0.8266699958668426; terminals('73', '2') = 0.1344340495230898; terminals('73', '3') = 0.8762846439545012; 
terminals('74', '1') = 0.055488457984425144; terminals('74', '2') = 0.8564771801420243; terminals('74', '3') = 0.11892097391076073; 
terminals('75', '1') = 0.4763074696009886; terminals('75', '2') = 0.19188356275591645; terminals('75', '3') = 0.32493227567511185; 
terminals('76', '1') = 0.05858451057532599; terminals('76', '2') = 0.7789927160698497; terminals('76', '3') = 0.7466792634370469; 
terminals('77', '1') = 0.051302974007833346; terminals('77', '2') = 0.14918654091473915; terminals('77', '3') = 0.794135991763386; 
terminals('78', '1') = 0.7596659385154688; terminals('78', '2') = 0.7771016974349371; terminals('78', '3') = 0.6879241345138886; 
terminals('79', '1') = 0.6405990478947211; terminals('79', '2') = 0.3720037581870419; terminals('79', '3') = 0.733376773917053; 
terminals('80', '1') = 0.7933159387449608; terminals('80', '2') = 0.44846732105430076; terminals('80', '3') = 0.8266301828920791; 
terminals('81', '1') = 0.1915723674936538; terminals('81', '2') = 0.7479099414256689; terminals('81', '3') = 0.17122134835731162; 
terminals('82', '1') = 0.656717555721288; terminals('82', '2') = 0.3248745062412367; terminals('82', '3') = 0.882755737649713; 
terminals('83', '1') = 0.7252678074259101; terminals('83', '2') = 0.41278179764399614; terminals('83', '3') = 0.3409806076601929; 
terminals('84', '1') = 0.8191101672494425; terminals('84', '2') = 0.541552890365288; terminals('84', '3') = 0.824169914588694; 
terminals('85', '1') = 0.3079871090264199; terminals('85', '2') = 0.7817092905582828; terminals('85', '3') = 0.2316374212201665; 
Parameter bigM / 1.7320508075688772 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
