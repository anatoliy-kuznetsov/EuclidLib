Sets
i Steiner points / 1*48 /
j terminals / 1*50 /
k dimensions / 1*5 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.3875562951104732; terminals('1', '2') = 0.9330186408543529; terminals('1', '3') = 0.562146407898091; terminals('1', '4') = 0.06828434544205153; terminals('1', '5') = 0.039129157060772246; 
terminals('2', '1') = 0.24091781626678177; terminals('2', '2') = 0.16623538677997673; terminals('2', '3') = 0.374272465036501; terminals('2', '4') = 0.408966818926242; terminals('2', '5') = 0.9491220744096723; 
terminals('3', '1') = 0.46110799642576417; terminals('3', '2') = 0.5465610442541805; terminals('3', '3') = 0.3100053939363503; terminals('3', '4') = 0.8930209918047177; terminals('3', '5') = 0.8110438492002532; 
terminals('4', '1') = 0.15890591351073435; terminals('4', '2') = 0.8185843838314756; terminals('4', '3') = 0.4255449747798262; terminals('4', '4') = 0.18971045262009334; terminals('4', '5') = 0.47000904587147163; 
terminals('5', '1') = 0.21368159959326993; terminals('5', '2') = 0.5779239001843863; terminals('5', '3') = 0.8414555544986722; terminals('5', '4') = 0.4230008420593674; terminals('5', '5') = 0.45646662072852817; 
terminals('6', '1') = 0.6713135558415345; terminals('6', '2') = 0.3851331521479958; terminals('6', '3') = 0.5787742918433331; terminals('6', '4') = 0.3397278086386124; terminals('6', '5') = 0.21543911989753128; 
terminals('7', '1') = 0.9349330985634463; terminals('7', '2') = 0.4582540084111467; terminals('7', '3') = 0.9202171886613936; terminals('7', '4') = 0.7488198650763622; terminals('7', '5') = 0.35809619589496733; 
terminals('8', '1') = 0.7741816730215779; terminals('8', '2') = 0.24747338182046164; terminals('8', '3') = 0.8259591616298335; terminals('8', '4') = 0.850596759525343; terminals('8', '5') = 0.7957254800626432; 
terminals('9', '1') = 0.5118548160451059; terminals('9', '2') = 0.8586590765826484; terminals('9', '3') = 0.9040333450427299; terminals('9', '4') = 0.2370033002561276; terminals('9', '5') = 0.4737347610942271; 
terminals('10', '1') = 0.570456233000507; terminals('10', '2') = 0.503677403785491; terminals('10', '3') = 0.7914791866115298; terminals('10', '4') = 0.2666028786773571; terminals('10', '5') = 0.5196882918794326; 
terminals('11', '1') = 0.19407196147120864; terminals('11', '2') = 0.9210870782577825; terminals('11', '3') = 0.5696077945299985; terminals('11', '4') = 0.3749209623697247; terminals('11', '5') = 0.756350205260637; 
terminals('12', '1') = 0.2449235593193667; terminals('12', '2') = 0.7412339190326014; terminals('12', '3') = 0.06987564260071699; terminals('12', '4') = 0.12287179899447731; terminals('12', '5') = 0.14876797990328172; 
terminals('13', '1') = 0.8979805866344233; terminals('13', '2') = 0.7319084443498269; terminals('13', '3') = 0.9908345832447267; terminals('13', '4') = 0.11723461256288359; terminals('13', '5') = 0.021107141956515196; 
terminals('14', '1') = 0.6979826248556068; terminals('14', '2') = 0.19041190794037666; terminals('14', '3') = 0.909190115180055; terminals('14', '4') = 0.9898269534803196; terminals('14', '5') = 0.026427100295887684; 
terminals('15', '1') = 0.9757979336328032; terminals('15', '2') = 0.30655249713327526; terminals('15', '3') = 0.8222147265575847; terminals('15', '4') = 0.27465302906031164; terminals('15', '5') = 0.04309160600295314; 
terminals('16', '1') = 0.9006645915962306; terminals('16', '2') = 0.13465188733254707; terminals('16', '3') = 0.8017433480233876; terminals('16', '4') = 0.9239119603245699; terminals('16', '5') = 0.38504401788591225; 
terminals('17', '1') = 0.6360139460011341; terminals('17', '2') = 0.7899577180756273; terminals('17', '3') = 0.039632716419590874; terminals('17', '4') = 0.3621872023719651; terminals('17', '5') = 0.03538880484126383; 
terminals('18', '1') = 0.533816658508353; terminals('18', '2') = 0.6209249947026906; terminals('18', '3') = 0.2876844397714109; terminals('18', '4') = 0.01373214444738502; terminals('18', '5') = 0.36859395942978124; 
terminals('19', '1') = 0.8186253105710998; terminals('19', '2') = 0.8773811142092716; terminals('19', '3') = 0.6926786291379595; terminals('19', '4') = 0.07536780707000446; terminals('19', '5') = 0.030015653659281938; 
terminals('20', '1') = 0.25955129083150497; terminals('20', '2') = 0.4040743838932823; terminals('20', '3') = 0.43069180889254854; terminals('20', '4') = 0.2765634121798767; terminals('20', '5') = 0.9483771067525653; 
terminals('21', '1') = 0.41133081929982074; terminals('21', '2') = 0.47317893381092957; terminals('21', '3') = 0.3462874237780289; terminals('21', '4') = 0.6463576989223804; terminals('21', '5') = 0.43678402165992103; 
terminals('22', '1') = 0.4711142635778607; terminals('22', '2') = 0.7169682791008521; terminals('22', '3') = 0.9822690274938141; terminals('22', '4') = 0.8727673659299415; terminals('22', '5') = 0.18253953268135759; 
terminals('23', '1') = 0.1164244970382623; terminals('23', '2') = 0.6768814874788983; terminals('23', '3') = 0.9366011120091551; terminals('23', '4') = 0.7400260955011981; terminals('23', '5') = 0.4777369676637401; 
terminals('24', '1') = 0.11370474789455098; terminals('24', '2') = 0.8871809552721311; terminals('24', '3') = 0.22184352582246814; terminals('24', '4') = 0.06617894946755143; terminals('24', '5') = 0.4373818886306805; 
terminals('25', '1') = 0.08009667882563709; terminals('25', '2') = 0.434607897869844; terminals('25', '3') = 0.7359967517777332; terminals('25', '4') = 0.34148223695482005; terminals('25', '5') = 0.08579556057816329; 
terminals('26', '1') = 0.061295750027627105; terminals('26', '2') = 0.5673652357975401; terminals('26', '3') = 0.3274543647487249; terminals('26', '4') = 0.8921763181964708; terminals('26', '5') = 0.30116302158985286; 
terminals('27', '1') = 0.656819054276212; terminals('27', '2') = 0.05912756812047926; terminals('27', '3') = 0.7322213860749016; terminals('27', '4') = 0.014597734432438392; terminals('27', '5') = 0.9161835060208605; 
terminals('28', '1') = 0.35793777666749893; terminals('28', '2') = 0.8600436696767008; terminals('28', '3') = 0.03284279341146379; terminals('28', '4') = 0.41248247172366204; terminals('28', '5') = 0.2668269972034041; 
terminals('29', '1') = 0.04543152244666793; terminals('29', '2') = 0.33712091891802287; terminals('29', '3') = 0.8413020122862993; terminals('29', '4') = 0.22948584928680404; terminals('29', '5') = 0.4451288000391407; 
terminals('30', '1') = 0.034484872465413985; terminals('30', '2') = 0.38727525276137575; terminals('30', '3') = 0.7304359675707757; terminals('30', '4') = 0.01609630537240614; terminals('30', '5') = 0.0965758027554483; 
terminals('31', '1') = 0.926807954935802; terminals('31', '2') = 0.20706739698424326; terminals('31', '3') = 0.3733415835840722; terminals('31', '4') = 0.8840128426759072; terminals('31', '5') = 0.9747267989750326; 
terminals('32', '1') = 0.7062042123085374; terminals('32', '2') = 0.3408224356669314; terminals('32', '3') = 0.19027453101743352; terminals('32', '4') = 0.1920225208517945; terminals('32', '5') = 0.2535502942122395; 
terminals('33', '1') = 0.9983955243722825; terminals('33', '2') = 0.9497253041024195; terminals('33', '3') = 0.6308161534354492; terminals('33', '4') = 0.6369228256275805; terminals('33', '5') = 0.9794402790151073; 
terminals('34', '1') = 0.5063649243298969; terminals('34', '2') = 0.022637057905539604; terminals('34', '3') = 0.8971552120950502; terminals('34', '4') = 0.35370176832119793; terminals('34', '5') = 0.24305746450918453; 
terminals('35', '1') = 0.09291032700610391; terminals('35', '2') = 0.8606058961071116; terminals('35', '3') = 0.3600796898522586; terminals('35', '4') = 0.8877639472171982; terminals('35', '5') = 0.4708696470412803; 
terminals('36', '1') = 0.8098509204580512; terminals('36', '2') = 0.43812896848274174; terminals('36', '3') = 0.08097670436679705; terminals('36', '4') = 0.38240152256770166; terminals('36', '5') = 0.979881495279819; 
terminals('37', '1') = 0.027731760330307553; terminals('37', '2') = 0.4965649120893857; terminals('37', '3') = 0.03623749035626522; terminals('37', '4') = 0.24861861883360648; terminals('37', '5') = 0.19127935073319013; 
terminals('38', '1') = 0.05995605375252955; terminals('38', '2') = 0.9497636623581043; terminals('38', '3') = 0.8528580306954243; terminals('38', '4') = 0.638592198852282; terminals('38', '5') = 0.1200549227338904; 
terminals('39', '1') = 0.1167702207914234; terminals('39', '2') = 0.025889532720060116; terminals('39', '3') = 0.4607433618203982; terminals('39', '4') = 0.6699114078783563; terminals('39', '5') = 0.166521477224446; 
terminals('40', '1') = 0.48238318305252414; terminals('40', '2') = 0.5540538617616398; terminals('40', '3') = 0.7723099873200233; terminals('40', '4') = 0.019784811424884863; terminals('40', '5') = 0.4583316248321333; 
terminals('41', '1') = 0.9142208742349259; terminals('41', '2') = 0.4534374223718214; terminals('41', '3') = 0.9002528286123126; terminals('41', '4') = 0.4781017168616374; terminals('41', '5') = 0.5229972456700991; 
terminals('42', '1') = 0.8700864919510888; terminals('42', '2') = 0.43359687527786006; terminals('42', '3') = 0.4448648922969206; terminals('42', '4') = 0.94521677241998; terminals('42', '5') = 0.4381501405669741; 
terminals('43', '1') = 0.6416338237947428; terminals('43', '2') = 0.339928791170101; terminals('43', '3') = 0.9421143996100635; terminals('43', '4') = 0.12483056646823387; terminals('43', '5') = 0.4081023031205083; 
terminals('44', '1') = 0.8646336424291626; terminals('44', '2') = 0.4272393825727636; terminals('44', '3') = 0.1812521545404343; terminals('44', '4') = 0.908384113733725; terminals('44', '5') = 0.3318713351898226; 
terminals('45', '1') = 0.1121238058322489; terminals('45', '2') = 0.7508297398351014; terminals('45', '3') = 0.9445732992398143; terminals('45', '4') = 0.703195162648304; terminals('45', '5') = 0.2192089745539444; 
terminals('46', '1') = 0.8954178054335532; terminals('46', '2') = 0.780837088991169; terminals('46', '3') = 0.9748516745821113; terminals('46', '4') = 0.4986259293389391; terminals('46', '5') = 0.8889405015684829; 
terminals('47', '1') = 0.6471177106804326; terminals('47', '2') = 0.35620775107476554; terminals('47', '3') = 0.5011448089012559; terminals('47', '4') = 0.2488694702802684; terminals('47', '5') = 0.17080945179949647; 
terminals('48', '1') = 0.29669010779211913; terminals('48', '2') = 0.25378763546539485; terminals('48', '3') = 0.05914626257355826; terminals('48', '4') = 0.3351322688139584; terminals('48', '5') = 0.04527426061116424; 
terminals('49', '1') = 0.48614583536652556; terminals('49', '2') = 0.7049295228643461; terminals('49', '3') = 0.04333632991845382; terminals('49', '4') = 0.4424078299190728; terminals('49', '5') = 0.9829606068776199; 
terminals('50', '1') = 0.9701284024649148; terminals('50', '2') = 0.8060327152928329; terminals('50', '3') = 0.1708858666986861; terminals('50', '4') = 0.6408032073635666; terminals('50', '5') = 0.5137112199944673; 
Parameter bigM / 2.23606797749979 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
