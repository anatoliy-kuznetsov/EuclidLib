Sets
i Steiner points / 1*68 /
j terminals / 1*70 /
k dimensions / 1*5 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.8899424699165775; terminals('1', '2') = 0.8024948625247633; terminals('1', '3') = 0.4015425655691761; terminals('1', '4') = 0.6706891008699155; terminals('1', '5') = 0.6514092337708058; 
terminals('2', '1') = 0.9762954805597137; terminals('2', '2') = 0.7538950725754537; terminals('2', '3') = 0.17552372003027827; terminals('2', '4') = 0.5898674911914461; terminals('2', '5') = 0.7093027881487299; 
terminals('3', '1') = 0.9659343522178693; terminals('3', '2') = 0.48608889777788544; terminals('3', '3') = 0.2359912765811757; terminals('3', '4') = 0.7579239024937295; terminals('3', '5') = 0.2908596870616722; 
terminals('4', '1') = 0.3842014747342245; terminals('4', '2') = 0.8874670170192578; terminals('4', '3') = 0.922720028484063; terminals('4', '4') = 0.48176254791708595; terminals('4', '5') = 0.5256113893621408; 
terminals('5', '1') = 0.46524497232422024; terminals('5', '2') = 0.6803551802632319; terminals('5', '3') = 0.42901245307222735; terminals('5', '4') = 0.7208010006633142; terminals('5', '5') = 0.5432588411888611; 
terminals('6', '1') = 0.2852980614281929; terminals('6', '2') = 0.17264154661317077; terminals('6', '3') = 0.8986800212390001; terminals('6', '4') = 0.3024274066269538; terminals('6', '5') = 0.796151275411003; 
terminals('7', '1') = 0.3706346084565296; terminals('7', '2') = 0.6882584608515814; terminals('7', '3') = 0.8381691901647633; terminals('7', '4') = 0.9360705387283084; terminals('7', '5') = 0.18893271486628482; 
terminals('8', '1') = 0.18450715321821054; terminals('8', '2') = 0.7142956640169276; terminals('8', '3') = 0.9834127593167301; terminals('8', '4') = 0.05527679921735695; terminals('8', '5') = 0.6591636106133928; 
terminals('9', '1') = 0.9665421172362353; terminals('9', '2') = 0.5223862214192795; terminals('9', '3') = 0.3693467694495324; terminals('9', '4') = 0.012888527481043965; terminals('9', '5') = 0.4230514470319754; 
terminals('10', '1') = 0.7491606803406762; terminals('10', '2') = 0.38492839642373433; terminals('10', '3') = 0.26024402712770234; terminals('10', '4') = 0.720037425281249; terminals('10', '5') = 0.5151175704498797; 
terminals('11', '1') = 0.5964073285440824; terminals('11', '2') = 0.48215351030383125; terminals('11', '3') = 0.09310738506650285; terminals('11', '4') = 0.9656454620714846; terminals('11', '5') = 0.36372325249525794; 
terminals('12', '1') = 0.08457094494563644; terminals('12', '2') = 0.5025593818060426; terminals('12', '3') = 0.26216158488533226; terminals('12', '4') = 0.7948373516842757; terminals('12', '5') = 0.4113705719720049; 
terminals('13', '1') = 0.48330454548157475; terminals('13', '2') = 0.6976480957825876; terminals('13', '3') = 0.9896793825938606; terminals('13', '4') = 0.06646183773500247; terminals('13', '5') = 0.12598378227062734; 
terminals('14', '1') = 0.7926073065194407; terminals('14', '2') = 0.40521107142278956; terminals('14', '3') = 0.4920022375430123; terminals('14', '4') = 0.8472441041866435; terminals('14', '5') = 0.581150899188435; 
terminals('15', '1') = 0.6490710683657614; terminals('15', '2') = 0.5558570572689565; terminals('15', '3') = 0.1717608141721496; terminals('15', '4') = 0.7730635109007864; terminals('15', '5') = 0.991717208961756; 
terminals('16', '1') = 0.057732268173770085; terminals('16', '2') = 0.8778617756844155; terminals('16', '3') = 0.8738737373983008; terminals('16', '4') = 0.8869470039441969; terminals('16', '5') = 0.8243457406778237; 
terminals('17', '1') = 0.8719179773095026; terminals('17', '2') = 0.21839048217407409; terminals('17', '3') = 0.8311319733233742; terminals('17', '4') = 0.0067526260201815624; terminals('17', '5') = 0.5890763191305627; 
terminals('18', '1') = 0.052768888645847056; terminals('18', '2') = 0.18426598267148764; terminals('18', '3') = 0.8767714671228114; terminals('18', '4') = 0.25135538347180675; terminals('18', '5') = 0.8022489702761021; 
terminals('19', '1') = 0.1288849192061856; terminals('19', '2') = 0.8975538672505938; terminals('19', '3') = 0.2846196143115155; terminals('19', '4') = 0.03169721117868596; terminals('19', '5') = 0.07264070525108746; 
terminals('20', '1') = 0.26514197804765394; terminals('20', '2') = 0.07227401951226897; terminals('20', '3') = 0.2498790262306283; terminals('20', '4') = 0.4934430393697161; terminals('20', '5') = 0.49218202398861466; 
terminals('21', '1') = 0.7362699247237533; terminals('21', '2') = 0.6856084899508389; terminals('21', '3') = 0.2625502191594473; terminals('21', '4') = 0.8798262029292185; terminals('21', '5') = 0.02162183730933609; 
terminals('22', '1') = 0.554196498441462; terminals('22', '2') = 0.15282275548163216; terminals('22', '3') = 0.6021077532476834; terminals('22', '4') = 0.5255445371623053; terminals('22', '5') = 0.8658956757119876; 
terminals('23', '1') = 0.26319306927272756; terminals('23', '2') = 0.06251098582053072; terminals('23', '3') = 0.9673767134682351; terminals('23', '4') = 0.13279591366567733; terminals('23', '5') = 0.7806165035208742; 
terminals('24', '1') = 0.18212280201850461; terminals('24', '2') = 0.3427589886876774; terminals('24', '3') = 0.5839979347341597; terminals('24', '4') = 0.4435265441276742; terminals('24', '5') = 0.81544990398606; 
terminals('25', '1') = 0.288021009249538; terminals('25', '2') = 0.27156058414695394; terminals('25', '3') = 0.9034958489566685; terminals('25', '4') = 0.6217334826523773; terminals('25', '5') = 0.12003728426155569; 
terminals('26', '1') = 0.7577970636726369; terminals('26', '2') = 0.10189021003295184; terminals('26', '3') = 0.9730496640989714; terminals('26', '4') = 0.3201197655333129; terminals('26', '5') = 0.10495128421228472; 
terminals('27', '1') = 0.6810567639193075; terminals('27', '2') = 0.9265823499461581; terminals('27', '3') = 0.29076739309752164; terminals('27', '4') = 0.990961582441968; terminals('27', '5') = 0.6312238599050094; 
terminals('28', '1') = 0.9903657966225227; terminals('28', '2') = 0.33909906043493054; terminals('28', '3') = 0.7267641343556216; terminals('28', '4') = 0.036591875459322076; terminals('28', '5') = 0.45019280871647105; 
terminals('29', '1') = 0.7966494231669468; terminals('29', '2') = 0.12423119376447744; terminals('29', '3') = 0.9425212663080649; terminals('29', '4') = 0.7518149730668512; terminals('29', '5') = 0.6827756999063871; 
terminals('30', '1') = 0.5162982296735119; terminals('30', '2') = 0.7862525356064829; terminals('30', '3') = 0.6050744768295466; terminals('30', '4') = 0.1934824286154343; terminals('30', '5') = 0.11134042544741996; 
terminals('31', '1') = 0.29650121516826355; terminals('31', '2') = 0.8537072412895181; terminals('31', '3') = 0.23791536386038392; terminals('31', '4') = 0.20761147409223957; terminals('31', '5') = 0.6641640287363177; 
terminals('32', '1') = 0.8338910849381005; terminals('32', '2') = 0.2854678486470552; terminals('32', '3') = 0.5490315071380585; terminals('32', '4') = 0.20625109987025503; terminals('32', '5') = 0.32148859299167687; 
terminals('33', '1') = 0.6743811843186339; terminals('33', '2') = 0.7917388184764926; terminals('33', '3') = 0.8047357434268081; terminals('33', '4') = 0.9495731547151116; terminals('33', '5') = 0.043515313168336456; 
terminals('34', '1') = 0.43900644088751983; terminals('34', '2') = 0.7970559583969098; terminals('34', '3') = 0.4157737784193456; terminals('34', '4') = 0.9331269758467807; terminals('34', '5') = 0.4473059527411015; 
terminals('35', '1') = 0.8080058941799764; terminals('35', '2') = 0.7237656898008613; terminals('35', '3') = 0.823176262164356; terminals('35', '4') = 0.8157776561888471; terminals('35', '5') = 0.20204868348442506; 
terminals('36', '1') = 0.4258959008187936; terminals('36', '2') = 0.612136393589405; terminals('36', '3') = 0.6619539176522541; terminals('36', '4') = 0.7631930918319179; terminals('36', '5') = 0.8547776985492705; 
terminals('37', '1') = 0.9592960174272102; terminals('37', '2') = 0.46923939317107133; terminals('37', '3') = 0.2693914800327053; terminals('37', '4') = 0.38218092720366514; terminals('37', '5') = 0.5567026834086021; 
terminals('38', '1') = 0.1656631607805622; terminals('38', '2') = 0.6781409332118884; terminals('38', '3') = 0.5107523531683388; terminals('38', '4') = 0.7573671102956292; terminals('38', '5') = 0.5734370173534247; 
terminals('39', '1') = 0.44013712163644714; terminals('39', '2') = 0.8139679555463265; terminals('39', '3') = 0.27626996166716955; terminals('39', '4') = 0.05810674619526235; terminals('39', '5') = 0.42732296042216344; 
terminals('40', '1') = 0.8990023134092843; terminals('40', '2') = 0.398597442394649; terminals('40', '3') = 0.550164054781657; terminals('40', '4') = 0.41544034824634446; terminals('40', '5') = 0.561799892232595; 
terminals('41', '1') = 0.7503487699014928; terminals('41', '2') = 0.629181600789182; terminals('41', '3') = 0.16764017384899066; terminals('41', '4') = 0.8443378974258149; terminals('41', '5') = 0.7875571335923508; 
terminals('42', '1') = 0.21708230098357328; terminals('42', '2') = 0.8951296957346222; terminals('42', '3') = 0.6362732966540755; terminals('42', '4') = 0.13301488535606865; terminals('42', '5') = 0.46647628322570533; 
terminals('43', '1') = 0.6110699918166449; terminals('43', '2') = 0.2638489284373443; terminals('43', '3') = 0.3763010286585996; terminals('43', '4') = 0.34432448408752936; terminals('43', '5') = 0.41834544553380415; 
terminals('44', '1') = 0.27885052038822866; terminals('44', '2') = 0.4419289890887046; terminals('44', '3') = 0.08392723866940865; terminals('44', '4') = 0.3954414156902586; terminals('44', '5') = 0.9088012646668499; 
terminals('45', '1') = 0.8951101932040059; terminals('45', '2') = 0.024053073611582154; terminals('45', '3') = 0.12763790139979359; terminals('45', '4') = 0.04016747438716528; terminals('45', '5') = 0.2994409203075764; 
terminals('46', '1') = 0.5757241293879632; terminals('46', '2') = 0.8804823828573926; terminals('46', '3') = 0.7504004504865146; terminals('46', '4') = 0.32519215869951745; terminals('46', '5') = 0.23571215322090366; 
terminals('47', '1') = 0.8952304323083112; terminals('47', '2') = 0.31372889602718423; terminals('47', '3') = 0.35103543226953293; terminals('47', '4') = 0.5259235505361163; terminals('47', '5') = 0.31652796255412974; 
terminals('48', '1') = 0.9889251241794285; terminals('48', '2') = 0.9791431114686872; terminals('48', '3') = 0.33281069173484257; terminals('48', '4') = 0.19634165193847386; terminals('48', '5') = 0.9554107634281606; 
terminals('49', '1') = 0.5730809360547399; terminals('49', '2') = 0.8798126506858157; terminals('49', '3') = 0.801345652542891; terminals('49', '4') = 0.06975652143387812; terminals('49', '5') = 0.094124325492981; 
terminals('50', '1') = 0.7481271291334395; terminals('50', '2') = 0.36211445576334633; terminals('50', '3') = 0.14100358730333573; terminals('50', '4') = 0.7814872311408089; terminals('50', '5') = 0.15478848331194717; 
terminals('51', '1') = 0.22757649593976137; terminals('51', '2') = 0.2579340521936785; terminals('51', '3') = 0.2658706008500644; terminals('51', '4') = 0.29797815933192073; terminals('51', '5') = 0.6276415099358674; 
terminals('52', '1') = 0.2566405018712845; terminals('52', '2') = 0.8895124293544517; terminals('52', '3') = 0.1432541386264784; terminals('52', '4') = 0.06345739955026242; terminals('52', '5') = 0.3452879788973612; 
terminals('53', '1') = 0.20564543081344921; terminals('53', '2') = 0.9455105062210926; terminals('53', '3') = 0.9543444974953487; terminals('53', '4') = 0.8877809614144574; terminals('53', '5') = 0.5044038813936877; 
terminals('54', '1') = 0.8391856585708632; terminals('54', '2') = 0.4624524968231404; terminals('54', '3') = 0.38229512720772674; terminals('54', '4') = 0.8041217951267935; terminals('54', '5') = 0.4028294663793561; 
terminals('55', '1') = 0.36948305339240417; terminals('55', '2') = 0.6166285620355523; terminals('55', '3') = 0.08828060205540289; terminals('55', '4') = 0.49085870439184887; terminals('55', '5') = 0.6958469549004939; 
terminals('56', '1') = 0.9722490272201342; terminals('56', '2') = 0.22913541938415483; terminals('56', '3') = 0.26524229260348775; terminals('56', '4') = 0.17895859087855104; terminals('56', '5') = 0.6856765984083211; 
terminals('57', '1') = 0.4905908003658386; terminals('57', '2') = 0.10667296026304873; terminals('57', '3') = 0.8636520351887943; terminals('57', '4') = 0.4666405671640834; terminals('57', '5') = 0.22848291081468963; 
terminals('58', '1') = 0.9966076903396617; terminals('58', '2') = 0.5555823015176535; terminals('58', '3') = 0.4893133395467487; terminals('58', '4') = 0.3362768500514084; terminals('58', '5') = 0.06551594972279473; 
terminals('59', '1') = 0.061697810270079034; terminals('59', '2') = 0.10603326505339905; terminals('59', '3') = 0.8015281133801913; terminals('59', '4') = 0.9004282973144945; terminals('59', '5') = 0.7454673084658648; 
terminals('60', '1') = 0.3078754567486671; terminals('60', '2') = 0.06664231873103577; terminals('60', '3') = 0.5329033687638958; terminals('60', '4') = 0.78122952745787; terminals('60', '5') = 0.6242645399961481; 
terminals('61', '1') = 0.9574316567758687; terminals('61', '2') = 0.5551761726460039; terminals('61', '3') = 0.3001527812534651; terminals('61', '4') = 0.7752199327884844; terminals('61', '5') = 0.9988011207599947; 
terminals('62', '1') = 0.17586288879704992; terminals('62', '2') = 0.5730540601949865; terminals('62', '3') = 0.03154246614437095; terminals('62', '4') = 0.9699871684767091; terminals('62', '5') = 0.18407274965474063; 
terminals('63', '1') = 0.5345629472399411; terminals('63', '2') = 0.11204779767370432; terminals('63', '3') = 0.2586829753154324; terminals('63', '4') = 0.965469734665687; terminals('63', '5') = 0.5759545790871773; 
terminals('64', '1') = 0.5136421408989323; terminals('64', '2') = 0.7687460291843881; terminals('64', '3') = 0.3894689541898422; terminals('64', '4') = 0.9297378193137031; terminals('64', '5') = 0.6789812328483271; 
terminals('65', '1') = 0.41447875997609873; terminals('65', '2') = 0.08922499259085515; terminals('65', '3') = 0.09936994205081007; terminals('65', '4') = 0.7922480703801201; terminals('65', '5') = 0.21593836357834173; 
terminals('66', '1') = 0.7936697310507486; terminals('66', '2') = 0.8298975772021748; terminals('66', '3') = 0.8501373961638231; terminals('66', '4') = 0.8840433310607292; terminals('66', '5') = 0.5241708803809841; 
terminals('67', '1') = 0.7810572997964936; terminals('67', '2') = 0.6014621433282128; terminals('67', '3') = 0.16757137013679646; terminals('67', '4') = 0.7209301007194951; terminals('67', '5') = 0.5051294952128843; 
terminals('68', '1') = 0.37815575348616925; terminals('68', '2') = 0.9132320278733289; terminals('68', '3') = 0.20162709688368696; terminals('68', '4') = 0.796421383414577; terminals('68', '5') = 0.4558841575380447; 
terminals('69', '1') = 0.31056554518170887; terminals('69', '2') = 0.7661677644205545; terminals('69', '3') = 0.6259327901080282; terminals('69', '4') = 0.024454068915698568; terminals('69', '5') = 0.5976698133467321; 
terminals('70', '1') = 0.34641122020983106; terminals('70', '2') = 0.4676637690909835; terminals('70', '3') = 0.0305298235513648; terminals('70', '4') = 0.701735675824851; terminals('70', '5') = 0.9084428729482783; 
Parameter bigM / 2.23606797749979 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
