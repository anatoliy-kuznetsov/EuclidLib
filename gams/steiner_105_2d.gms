Sets
i Steiner points / 1*103 /
j terminals / 1*105 /
k dimensions / 1*2 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.3847045824459102; terminals('1', '2') = 0.6805682550489983; 
terminals('2', '1') = 0.7269918685761857; terminals('2', '2') = 0.4053525398096075; 
terminals('3', '1') = 0.1682046479705963; terminals('3', '2') = 0.0199988831283765; 
terminals('4', '1') = 0.29001600465900956; terminals('4', '2') = 0.039999698323921695; 
terminals('5', '1') = 0.1357270562392615; terminals('5', '2') = 0.5401798909786042; 
terminals('6', '1') = 0.4842189530564138; terminals('6', '2') = 0.8485354769616575; 
terminals('7', '1') = 0.12424876194529744; terminals('7', '2') = 0.07585510946950447; 
terminals('8', '1') = 0.13043279689305642; terminals('8', '2') = 0.412233583195874; 
terminals('9', '1') = 0.1390998686885414; terminals('9', '2') = 0.7756273059433145; 
terminals('10', '1') = 0.5826171045246289; terminals('10', '2') = 0.9987183516739916; 
terminals('11', '1') = 0.28250935373779185; terminals('11', '2') = 0.9559560437434661; 
terminals('12', '1') = 0.3312828763395286; terminals('12', '2') = 0.7801268838564624; 
terminals('13', '1') = 0.8413043772956155; terminals('13', '2') = 0.29445011199587634; 
terminals('14', '1') = 0.31710920120199304; terminals('14', '2') = 0.005953495606139447; 
terminals('15', '1') = 0.6453668841385135; terminals('15', '2') = 0.5045296420422819; 
terminals('16', '1') = 0.6412437724122224; terminals('16', '2') = 0.012473842534352575; 
terminals('17', '1') = 0.019332902485338477; terminals('17', '2') = 0.7388211206294722; 
terminals('18', '1') = 0.28543547911885414; terminals('18', '2') = 0.9851597140447849; 
terminals('19', '1') = 0.6746887593502168; terminals('19', '2') = 0.1732722044848689; 
terminals('20', '1') = 0.7989675502655422; terminals('20', '2') = 0.7754017682854297; 
terminals('21', '1') = 0.5437956224791338; terminals('21', '2') = 0.9581854787881908; 
terminals('22', '1') = 0.9015252009588345; terminals('22', '2') = 0.7829431146089928; 
terminals('23', '1') = 0.8293327544948182; terminals('23', '2') = 0.7022210272251054; 
terminals('24', '1') = 0.5499052712725032; terminals('24', '2') = 0.3527972282181293; 
terminals('25', '1') = 0.5294986303655231; terminals('25', '2') = 0.3951106157420585; 
terminals('26', '1') = 0.32123217394410475; terminals('26', '2') = 0.7074439220930255; 
terminals('27', '1') = 0.8354894342131834; terminals('27', '2') = 0.14546940838697708; 
terminals('28', '1') = 0.09299626987825782; terminals('28', '2') = 0.6011661308347673; 
terminals('29', '1') = 0.5693345896700868; terminals('29', '2') = 0.11862713129245639; 
terminals('30', '1') = 0.8008430921702054; terminals('30', '2') = 0.15393050965334942; 
terminals('31', '1') = 0.988155180710635; terminals('31', '2') = 0.7140673728320497; 
terminals('32', '1') = 0.997500893137658; terminals('32', '2') = 0.6058664725723569; 
terminals('33', '1') = 0.6210720517868974; terminals('33', '2') = 0.48207811087629726; 
terminals('34', '1') = 0.9132612632113875; terminals('34', '2') = 0.7747602808341192; 
terminals('35', '1') = 0.017122460834671394; terminals('35', '2') = 0.43240223501137; 
terminals('36', '1') = 0.6402915869616463; terminals('36', '2') = 0.8718894575428645; 
terminals('37', '1') = 0.5365762741642065; terminals('37', '2') = 0.28998785263667604; 
terminals('38', '1') = 0.764553178459817; terminals('38', '2') = 0.15014363891905214; 
terminals('39', '1') = 0.026436082031605412; terminals('39', '2') = 0.8262506406995137; 
terminals('40', '1') = 0.1588970565377157; terminals('40', '2') = 0.15928571666387548; 
terminals('41', '1') = 0.21971486858922873; terminals('41', '2') = 0.6497932578114732; 
terminals('42', '1') = 0.4323996686284395; terminals('42', '2') = 0.6182801465744696; 
terminals('43', '1') = 0.8403146374289012; terminals('43', '2') = 0.0182058803641576; 
terminals('44', '1') = 0.0020250440661099267; terminals('44', '2') = 0.7195522078574499; 
terminals('45', '1') = 0.7312600746873552; terminals('45', '2') = 0.9280039045834543; 
terminals('46', '1') = 0.014188187739198721; terminals('46', '2') = 0.7448951051154459; 
terminals('47', '1') = 0.8689208672549621; terminals('47', '2') = 0.9534592844589633; 
terminals('48', '1') = 0.3142229819378193; terminals('48', '2') = 0.021736326282401186; 
terminals('49', '1') = 0.5839749466699251; terminals('49', '2') = 0.7900356384015088; 
terminals('50', '1') = 0.13974308613979847; terminals('50', '2') = 0.8687443176219797; 
terminals('51', '1') = 0.12381548807967202; terminals('51', '2') = 0.9676207652259275; 
terminals('52', '1') = 0.744542813633882; terminals('52', '2') = 0.8940266779355035; 
terminals('53', '1') = 0.4584139915365276; terminals('53', '2') = 0.10204123609382143; 
terminals('54', '1') = 0.8374147729564034; terminals('54', '2') = 0.2960163319941661; 
terminals('55', '1') = 0.6166468905508974; terminals('55', '2') = 0.8236444550460442; 
terminals('56', '1') = 0.1053300126859289; terminals('56', '2') = 0.9672519516820259; 
terminals('57', '1') = 0.46049262830382054; terminals('57', '2') = 0.4137816037829689; 
terminals('58', '1') = 0.9503222617709589; terminals('58', '2') = 0.3619927334391886; 
terminals('59', '1') = 0.5812914075048666; terminals('59', '2') = 0.414552642788076; 
terminals('60', '1') = 0.4401515659349491; terminals('60', '2') = 0.415782161966851; 
terminals('61', '1') = 0.0728071333248359; terminals('61', '2') = 0.02198497448365433; 
terminals('62', '1') = 0.19622669691795813; terminals('62', '2') = 0.6640042873471546; 
terminals('63', '1') = 0.752275249890074; terminals('63', '2') = 0.9153512774213787; 
terminals('64', '1') = 0.656706859191364; terminals('64', '2') = 0.4586876899517828; 
terminals('65', '1') = 0.6987592207185098; terminals('65', '2') = 0.17678900600893532; 
terminals('66', '1') = 0.4129744377665242; terminals('66', '2') = 0.22359051976512134; 
terminals('67', '1') = 0.6801599306082426; terminals('67', '2') = 0.9098271422801992; 
terminals('68', '1') = 0.6290883941431942; terminals('68', '2') = 0.49633963815413484; 
terminals('69', '1') = 0.940238286508863; terminals('69', '2') = 0.05278945630529164; 
terminals('70', '1') = 0.6217254818885245; terminals('70', '2') = 0.8921451923193854; 
terminals('71', '1') = 0.6372346914691054; terminals('71', '2') = 0.2554150724227804; 
terminals('72', '1') = 0.5719749514631802; terminals('72', '2') = 0.3677086195221144; 
terminals('73', '1') = 0.9689431910622901; terminals('73', '2') = 0.012968553152904794; 
terminals('74', '1') = 0.11140901625867095; terminals('74', '2') = 0.3568012906435343; 
terminals('75', '1') = 0.12860814979435198; terminals('75', '2') = 0.4324939609979809; 
terminals('76', '1') = 0.7839542975717665; terminals('76', '2') = 0.2053693584625782; 
terminals('77', '1') = 0.8219029400741282; terminals('77', '2') = 0.0015871629194836867; 
terminals('78', '1') = 0.3795565311138105; terminals('78', '2') = 0.647111262831084; 
terminals('79', '1') = 0.7686506035697326; terminals('79', '2') = 0.4479107881347705; 
terminals('80', '1') = 0.4083654736127553; terminals('80', '2') = 0.5732030247502792; 
terminals('81', '1') = 0.9778107819595079; terminals('81', '2') = 0.5212397613706763; 
terminals('82', '1') = 0.31565050898464886; terminals('82', '2') = 0.4294329047494764; 
terminals('83', '1') = 0.24456063418155682; terminals('83', '2') = 0.9096564670868528; 
terminals('84', '1') = 0.1530412789421518; terminals('84', '2') = 0.42003917129315127; 
terminals('85', '1') = 0.6649017166699437; terminals('85', '2') = 0.6373003269422042; 
terminals('86', '1') = 0.532050637724023; terminals('86', '2') = 0.9174231828206909; 
terminals('87', '1') = 0.3088420884791997; terminals('87', '2') = 0.7003240399114659; 
terminals('88', '1') = 0.8635518549170379; terminals('88', '2') = 0.10312184959936921; 
terminals('89', '1') = 0.3868259793903299; terminals('89', '2') = 0.6888130563327407; 
terminals('90', '1') = 0.13119553176423704; terminals('90', '2') = 0.22792137455859895; 
terminals('91', '1') = 0.4868251578571461; terminals('91', '2') = 0.8756783231151992; 
terminals('92', '1') = 0.8683692386140882; terminals('92', '2') = 0.012359817507944904; 
terminals('93', '1') = 0.09214306981348741; terminals('93', '2') = 0.5331577447117092; 
terminals('94', '1') = 0.10877313005910383; terminals('94', '2') = 0.12175390916537066; 
terminals('95', '1') = 0.6615097744175465; terminals('95', '2') = 0.49104359072740955; 
terminals('96', '1') = 0.8019099145663434; terminals('96', '2') = 0.04973062446100707; 
terminals('97', '1') = 0.927068221335294; terminals('97', '2') = 0.945131581634693; 
terminals('98', '1') = 0.502122851548299; terminals('98', '2') = 0.5101607724469848; 
terminals('99', '1') = 0.10507472890709635; terminals('99', '2') = 0.4172056098917697; 
terminals('100', '1') = 0.728849223148569; terminals('100', '2') = 0.2699456626078329; 
terminals('101', '1') = 0.06496770480414371; terminals('101', '2') = 0.3667800072873515; 
terminals('102', '1') = 0.2060955507668889; terminals('102', '2') = 0.2291720425481949; 
terminals('103', '1') = 0.36933662489552865; terminals('103', '2') = 0.05019838393314813; 
terminals('104', '1') = 0.7102156833991087; terminals('104', '2') = 0.8369928359221078; 
terminals('105', '1') = 0.7601616281314424; terminals('105', '2') = 0.8650822292869035; 
Parameter bigM / 1.4142135623730951 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
