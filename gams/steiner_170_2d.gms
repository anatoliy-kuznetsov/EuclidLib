Sets
i Steiner points / 1*168 /
j terminals / 1*170 /
k dimensions / 1*2 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.39999664258269163; terminals('1', '2') = 0.09490477284834242; 
terminals('2', '1') = 0.5281413410493955; terminals('2', '2') = 0.7996239553555052; 
terminals('3', '1') = 0.11878937904923925; terminals('3', '2') = 0.27595072372581875; 
terminals('4', '1') = 0.31343907281152705; terminals('4', '2') = 0.7000168973265884; 
terminals('5', '1') = 0.9768196757703907; terminals('5', '2') = 0.2546953581315933; 
terminals('6', '1') = 0.1548504275246546; terminals('6', '2') = 0.9706226546711856; 
terminals('7', '1') = 0.8092068368809393; terminals('7', '2') = 0.27535185418350383; 
terminals('8', '1') = 0.5539765805839169; terminals('8', '2') = 0.03473565747298002; 
terminals('9', '1') = 0.043565214905644134; terminals('9', '2') = 0.4886670881811682; 
terminals('10', '1') = 0.1329335882863616; terminals('10', '2') = 0.2565120624572673; 
terminals('11', '1') = 0.4803747918278132; terminals('11', '2') = 0.30138128445329215; 
terminals('12', '1') = 0.15905082135605297; terminals('12', '2') = 0.427372841660852; 
terminals('13', '1') = 0.6548314212130102; terminals('13', '2') = 0.14921009508626892; 
terminals('14', '1') = 0.5427277726646136; terminals('14', '2') = 0.19479198861413516; 
terminals('15', '1') = 0.0585193171859647; terminals('15', '2') = 0.8966070953176247; 
terminals('16', '1') = 0.7492427837732151; terminals('16', '2') = 0.008245278806008782; 
terminals('17', '1') = 0.20357986156505392; terminals('17', '2') = 0.15355041940676795; 
terminals('18', '1') = 0.5217691009341212; terminals('18', '2') = 0.10407883059553946; 
terminals('19', '1') = 0.47345129402188446; terminals('19', '2') = 0.8281775336520892; 
terminals('20', '1') = 0.9702234192226815; terminals('20', '2') = 0.8680821614034065; 
terminals('21', '1') = 0.3428493581261487; terminals('21', '2') = 0.07007253043813477; 
terminals('22', '1') = 0.14996034166139816; terminals('22', '2') = 0.4551810342278608; 
terminals('23', '1') = 0.9544015594012983; terminals('23', '2') = 0.9697513926102298; 
terminals('24', '1') = 0.9158007989505914; terminals('24', '2') = 0.8512114276351962; 
terminals('25', '1') = 0.37180614509141496; terminals('25', '2') = 0.9567913891598508; 
terminals('26', '1') = 0.7982140550123433; terminals('26', '2') = 0.05503931542947449; 
terminals('27', '1') = 0.7009795359743459; terminals('27', '2') = 0.49521140815024345; 
terminals('28', '1') = 0.7828871344750191; terminals('28', '2') = 0.39709921513337265; 
terminals('29', '1') = 0.11652486803563933; terminals('29', '2') = 0.13579631696785588; 
terminals('30', '1') = 0.4104667394003767; terminals('30', '2') = 0.41638133479586126; 
terminals('31', '1') = 0.33558350557217353; terminals('31', '2') = 0.4028715879075162; 
terminals('32', '1') = 0.9623140737003414; terminals('32', '2') = 0.5328215453371601; 
terminals('33', '1') = 0.9085683455325125; terminals('33', '2') = 0.25880455843911987; 
terminals('34', '1') = 0.32526317353930967; terminals('34', '2') = 0.29382040201002757; 
terminals('35', '1') = 0.7658767106058897; terminals('35', '2') = 0.38805594962186407; 
terminals('36', '1') = 0.023821704349532347; terminals('36', '2') = 0.9820232926427556; 
terminals('37', '1') = 0.4295989339621361; terminals('37', '2') = 0.0414028472465412; 
terminals('38', '1') = 0.45674985805716306; terminals('38', '2') = 0.11816020793800508; 
terminals('39', '1') = 0.21995652419205058; terminals('39', '2') = 0.3411185145861739; 
terminals('40', '1') = 0.26213994303281796; terminals('40', '2') = 0.5291821567168556; 
terminals('41', '1') = 0.9443295987755668; terminals('41', '2') = 0.15424667428196415; 
terminals('42', '1') = 0.11555767378972426; terminals('42', '2') = 0.15721952995991173; 
terminals('43', '1') = 0.6405893792159775; terminals('43', '2') = 0.0259963845944039; 
terminals('44', '1') = 0.10277721773457016; terminals('44', '2') = 0.404075116361975; 
terminals('45', '1') = 0.6470240670350036; terminals('45', '2') = 0.4818584251093112; 
terminals('46', '1') = 0.990412625392323; terminals('46', '2') = 0.7433003182131754; 
terminals('47', '1') = 0.5119024961069742; terminals('47', '2') = 0.5780394173427705; 
terminals('48', '1') = 0.4135755068376856; terminals('48', '2') = 0.5057625229089364; 
terminals('49', '1') = 0.02658866245717495; terminals('49', '2') = 0.17143956250677717; 
terminals('50', '1') = 0.5213397580450113; terminals('50', '2') = 0.07208045172087518; 
terminals('51', '1') = 0.2551693032772412; terminals('51', '2') = 0.9548091190200483; 
terminals('52', '1') = 0.2431094300122093; terminals('52', '2') = 0.16086165279951403; 
terminals('53', '1') = 0.24961487633240687; terminals('53', '2') = 0.6401429071080107; 
terminals('54', '1') = 0.618233693491612; terminals('54', '2') = 0.36456268678994097; 
terminals('55', '1') = 0.3780932088750063; terminals('55', '2') = 0.23340141226724143; 
terminals('56', '1') = 0.22968844661347765; terminals('56', '2') = 0.8771953584364012; 
terminals('57', '1') = 0.630469647768397; terminals('57', '2') = 0.46888981748664715; 
terminals('58', '1') = 0.722994637684923; terminals('58', '2') = 0.7136676338568892; 
terminals('59', '1') = 0.2770353856792529; terminals('59', '2') = 0.15535077741672665; 
terminals('60', '1') = 0.6707053700422049; terminals('60', '2') = 0.7891428675633687; 
terminals('61', '1') = 0.041686510050085834; terminals('61', '2') = 0.9295108876554868; 
terminals('62', '1') = 0.8834787800691201; terminals('62', '2') = 0.679607399884091; 
terminals('63', '1') = 0.8403865548313451; terminals('63', '2') = 0.3784173865176258; 
terminals('64', '1') = 0.0017381464619654619; terminals('64', '2') = 0.8577282259452356; 
terminals('65', '1') = 0.5499219481420106; terminals('65', '2') = 0.49813874893759; 
terminals('66', '1') = 0.10618859152461801; terminals('66', '2') = 0.7764788844279077; 
terminals('67', '1') = 0.962368900743395; terminals('67', '2') = 0.8585174094338405; 
terminals('68', '1') = 0.8143100835564091; terminals('68', '2') = 0.9388486720759701; 
terminals('69', '1') = 0.8551404663669099; terminals('69', '2') = 0.0329367418201294; 
terminals('70', '1') = 0.6532890139255149; terminals('70', '2') = 0.23733528514692337; 
terminals('71', '1') = 0.6949372758703926; terminals('71', '2') = 0.19808524620301415; 
terminals('72', '1') = 0.5464512964197892; terminals('72', '2') = 0.8316169581072359; 
terminals('73', '1') = 0.14528188912357398; terminals('73', '2') = 0.23609287844633553; 
terminals('74', '1') = 0.5425136626144018; terminals('74', '2') = 0.6921360324645341; 
terminals('75', '1') = 0.815310059922701; terminals('75', '2') = 0.9207539031391244; 
terminals('76', '1') = 0.8840043069378296; terminals('76', '2') = 0.9683305502617999; 
terminals('77', '1') = 0.7127281732926745; terminals('77', '2') = 0.8637993980082077; 
terminals('78', '1') = 0.907294586326544; terminals('78', '2') = 0.11397399242786943; 
terminals('79', '1') = 0.8943115322392535; terminals('79', '2') = 0.2201968982084258; 
terminals('80', '1') = 0.23659042387686702; terminals('80', '2') = 0.3655308568660377; 
terminals('81', '1') = 0.5229988858635674; terminals('81', '2') = 0.941260285838254; 
terminals('82', '1') = 0.4553585872305531; terminals('82', '2') = 0.34562826591498863; 
terminals('83', '1') = 0.2709568173432637; terminals('83', '2') = 0.29637188251885294; 
terminals('84', '1') = 0.2272798641981858; terminals('84', '2') = 0.001530783735105734; 
terminals('85', '1') = 0.5848202711705882; terminals('85', '2') = 0.21893772620686736; 
terminals('86', '1') = 0.10546422457535376; terminals('86', '2') = 0.5580539508722667; 
terminals('87', '1') = 0.1717187418710474; terminals('87', '2') = 0.01867354086188533; 
terminals('88', '1') = 0.9573476259049418; terminals('88', '2') = 0.7023023124412516; 
terminals('89', '1') = 0.3732356785649281; terminals('89', '2') = 0.8734776325083391; 
terminals('90', '1') = 0.8858588887977497; terminals('90', '2') = 0.9143389456045045; 
terminals('91', '1') = 0.17104447346429452; terminals('91', '2') = 0.21316274708093375; 
terminals('92', '1') = 0.1351968760881116; terminals('92', '2') = 0.011911533264389318; 
terminals('93', '1') = 0.06595705808291996; terminals('93', '2') = 0.6686351715349034; 
terminals('94', '1') = 0.4432909856537999; terminals('94', '2') = 0.5316756823151113; 
terminals('95', '1') = 0.8710612554799219; terminals('95', '2') = 0.31710950452244746; 
terminals('96', '1') = 0.45078237303056834; terminals('96', '2') = 0.9050020958280452; 
terminals('97', '1') = 0.3751997286523484; terminals('97', '2') = 0.05579294042825933; 
terminals('98', '1') = 0.6272172487445739; terminals('98', '2') = 0.055666275698005974; 
terminals('99', '1') = 0.45653992645469754; terminals('99', '2') = 0.846584473163096; 
terminals('100', '1') = 0.27479887420909277; terminals('100', '2') = 0.48349241161683276; 
terminals('101', '1') = 0.8385836352879893; terminals('101', '2') = 0.08223916269528297; 
terminals('102', '1') = 0.7453151777330498; terminals('102', '2') = 0.6988420668728064; 
terminals('103', '1') = 0.8565926039523171; terminals('103', '2') = 0.9487856044716578; 
terminals('104', '1') = 0.7201895141585022; terminals('104', '2') = 0.01726798030026655; 
terminals('105', '1') = 0.6536126954891539; terminals('105', '2') = 0.40670033873030664; 
terminals('106', '1') = 0.8199104813120188; terminals('106', '2') = 0.12544688233883083; 
terminals('107', '1') = 0.4244865785806109; terminals('107', '2') = 0.34532993722826644; 
terminals('108', '1') = 0.9378854159703642; terminals('108', '2') = 0.9237196443691107; 
terminals('109', '1') = 0.3126041535064885; terminals('109', '2') = 0.6591947652598716; 
terminals('110', '1') = 0.8819150879962219; terminals('110', '2') = 0.2561978015231702; 
terminals('111', '1') = 0.4044460061147075; terminals('111', '2') = 0.3698122641719803; 
terminals('112', '1') = 0.0018150968207519824; terminals('112', '2') = 0.3555236918216478; 
terminals('113', '1') = 0.7661613984382817; terminals('113', '2') = 0.9701268190926593; 
terminals('114', '1') = 0.2589890134389996; terminals('114', '2') = 0.3078632325374834; 
terminals('115', '1') = 0.8311946300718682; terminals('115', '2') = 0.782653813077865; 
terminals('116', '1') = 0.04284568153806323; terminals('116', '2') = 0.26826504411150065; 
terminals('117', '1') = 0.3515589899574525; terminals('117', '2') = 0.073400606614343; 
terminals('118', '1') = 0.18799586952785696; terminals('118', '2') = 0.5019417972909179; 
terminals('119', '1') = 0.3485284869600612; terminals('119', '2') = 0.6331869453369675; 
terminals('120', '1') = 0.9095283673937818; terminals('120', '2') = 0.8834427463874308; 
terminals('121', '1') = 0.8116091686071776; terminals('121', '2') = 0.17772958515341253; 
terminals('122', '1') = 0.512156897242395; terminals('122', '2') = 0.8426954243989089; 
terminals('123', '1') = 0.01957458922549893; terminals('123', '2') = 0.5905189269410391; 
terminals('124', '1') = 0.7728021989561948; terminals('124', '2') = 0.10576683110210006; 
terminals('125', '1') = 0.979641297255294; terminals('125', '2') = 0.3188422118100759; 
terminals('126', '1') = 0.5777967757525818; terminals('126', '2') = 0.6988963043799434; 
terminals('127', '1') = 0.6625388526453373; terminals('127', '2') = 0.6605376833700201; 
terminals('128', '1') = 0.8340631437062179; terminals('128', '2') = 0.6921234253909231; 
terminals('129', '1') = 0.031488951775941576; terminals('129', '2') = 0.6882938028513574; 
terminals('130', '1') = 0.04784645450846714; terminals('130', '2') = 0.2725612192451127; 
terminals('131', '1') = 0.1952707540017835; terminals('131', '2') = 0.1652489224661724; 
terminals('132', '1') = 0.572925774689762; terminals('132', '2') = 0.11280186553671945; 
terminals('133', '1') = 0.048957274011130814; terminals('133', '2') = 0.7537699589834133; 
terminals('134', '1') = 0.3301883953325122; terminals('134', '2') = 0.5772792930630559; 
terminals('135', '1') = 0.7270796226918523; terminals('135', '2') = 0.5532063629015462; 
terminals('136', '1') = 0.4565418959761054; terminals('136', '2') = 0.4142204086812611; 
terminals('137', '1') = 0.7466424672329305; terminals('137', '2') = 0.48743695839474843; 
terminals('138', '1') = 0.7268749659300249; terminals('138', '2') = 0.3886703877954686; 
terminals('139', '1') = 0.5342662407965464; terminals('139', '2') = 0.47052778109051496; 
terminals('140', '1') = 0.21772371838213778; terminals('140', '2') = 0.6632824049554953; 
terminals('141', '1') = 0.27657067940800684; terminals('141', '2') = 0.37059687878107994; 
terminals('142', '1') = 0.7015746916649475; terminals('142', '2') = 0.10111009432041018; 
terminals('143', '1') = 0.09885188749122398; terminals('143', '2') = 0.4135073531492147; 
terminals('144', '1') = 0.09446241698109648; terminals('144', '2') = 0.43412469044353674; 
terminals('145', '1') = 0.2621338613817319; terminals('145', '2') = 0.40275935453059697; 
terminals('146', '1') = 0.6823673225688546; terminals('146', '2') = 0.5489725303973205; 
terminals('147', '1') = 0.8007013115100711; terminals('147', '2') = 0.5057888165913202; 
terminals('148', '1') = 0.9434291358149223; terminals('148', '2') = 0.8038201231683506; 
terminals('149', '1') = 0.7931330287916325; terminals('149', '2') = 0.23339491301636683; 
terminals('150', '1') = 0.39447829020173353; terminals('150', '2') = 0.9830773014071554; 
terminals('151', '1') = 0.39531541324926456; terminals('151', '2') = 0.34064897184475007; 
terminals('152', '1') = 0.15410318714034144; terminals('152', '2') = 0.6443215544867699; 
terminals('153', '1') = 0.7843725487480704; terminals('153', '2') = 0.548424861490247; 
terminals('154', '1') = 0.21680508015497346; terminals('154', '2') = 0.0672909277201762; 
terminals('155', '1') = 0.09725688974221536; terminals('155', '2') = 0.3451822316302533; 
terminals('156', '1') = 0.17977551906628597; terminals('156', '2') = 0.996793365967094; 
terminals('157', '1') = 0.8541981658537128; terminals('157', '2') = 0.7152241683736098; 
terminals('158', '1') = 0.9025737450350173; terminals('158', '2') = 0.7363443325490701; 
terminals('159', '1') = 0.718257641058851; terminals('159', '2') = 0.576840685212093; 
terminals('160', '1') = 0.381941575780543; terminals('160', '2') = 0.9282176074451702; 
terminals('161', '1') = 0.8146360238636418; terminals('161', '2') = 0.32959111776780536; 
terminals('162', '1') = 0.5683166829896454; terminals('162', '2') = 0.5422953531718487; 
terminals('163', '1') = 0.32993691006109127; terminals('163', '2') = 0.08322613234431842; 
terminals('164', '1') = 0.08693691622908661; terminals('164', '2') = 0.06024041798521418; 
terminals('165', '1') = 0.794703796670599; terminals('165', '2') = 0.017130261220399623; 
terminals('166', '1') = 0.37911772633805274; terminals('166', '2') = 0.7230169253308827; 
terminals('167', '1') = 0.7823785543208851; terminals('167', '2') = 0.2567880416854017; 
terminals('168', '1') = 0.38535986681613443; terminals('168', '2') = 0.31165606807346946; 
terminals('169', '1') = 0.30273314786347116; terminals('169', '2') = 0.30659677914588024; 
terminals('170', '1') = 0.08381816409560017; terminals('170', '2') = 0.6529224553617776; 
Parameter bigM / 1.4142135623730951 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
