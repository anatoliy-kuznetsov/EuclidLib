Sets
i Steiner points / 1*33 /
j terminals / 1*35 /
k dimensions / 1*5 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.4439593943554271; terminals('1', '2') = 0.0518166476817119; terminals('1', '3') = 0.5734151578625523; terminals('1', '4') = 0.8009321144930233; terminals('1', '5') = 0.5028683036201065; 
terminals('2', '1') = 0.9905541185839895; terminals('2', '2') = 0.5947992941100786; terminals('2', '3') = 0.0742563567950949; terminals('2', '4') = 0.512373282119978; terminals('2', '5') = 0.48516742480230635; 
terminals('3', '1') = 0.7744456233928628; terminals('3', '2') = 0.27441875455458087; terminals('3', '3') = 0.7432058871038095; terminals('3', '4') = 0.18112629553852821; terminals('3', '5') = 0.854192620749264; 
terminals('4', '1') = 0.5465892909507779; terminals('4', '2') = 0.3030731393821148; terminals('4', '3') = 0.49027634370145656; terminals('4', '4') = 0.5579665114502772; terminals('4', '5') = 0.4415411200788173; 
terminals('5', '1') = 0.7589690934896303; terminals('5', '2') = 0.6033305913749418; terminals('5', '3') = 0.46597215045183704; terminals('5', '4') = 0.6007608126646549; terminals('5', '5') = 0.4722016371120977; 
terminals('6', '1') = 0.9310724572819769; terminals('6', '2') = 0.10913398512757388; terminals('6', '3') = 0.568914547890314; terminals('6', '4') = 0.03904818533808474; terminals('6', '5') = 0.3463626372084979; 
terminals('7', '1') = 0.03529108821782645; terminals('7', '2') = 0.1934842643487561; terminals('7', '3') = 0.732802663140079; terminals('7', '4') = 0.7888933027650449; terminals('7', '5') = 0.38631921552546467; 
terminals('8', '1') = 0.7342285086729784; terminals('8', '2') = 0.3169431802095928; terminals('8', '3') = 0.46276579103969995; terminals('8', '4') = 0.8241717809133003; terminals('8', '5') = 0.9240701448761935; 
terminals('9', '1') = 0.7842414385299904; terminals('9', '2') = 0.44792842830921875; terminals('9', '3') = 0.27877454476519925; terminals('9', '4') = 0.14674528094786832; terminals('9', '5') = 0.9647157142141463; 
terminals('10', '1') = 0.2124424395825294; terminals('10', '2') = 0.5012225707836954; terminals('10', '3') = 0.6394731150252693; terminals('10', '4') = 0.8132465235805582; terminals('10', '5') = 0.3920787365191297; 
terminals('11', '1') = 0.04263119484777256; terminals('11', '2') = 0.12854721393767665; terminals('11', '3') = 0.6248970075135694; terminals('11', '4') = 0.4374036281020287; terminals('11', '5') = 0.3093163603651674; 
terminals('12', '1') = 0.3459916767403731; terminals('12', '2') = 0.7646827099640454; terminals('12', '3') = 0.712088104901704; terminals('12', '4') = 0.5258558245964339; terminals('12', '5') = 0.05030019611990211; 
terminals('13', '1') = 0.4587850543851698; terminals('13', '2') = 0.52699538305653; terminals('13', '3') = 0.06042883461726922; terminals('13', '4') = 0.16867581508274765; terminals('13', '5') = 0.26126764673414693; 
terminals('14', '1') = 0.199755173675074; terminals('14', '2') = 0.6057287197557367; terminals('14', '3') = 0.6714149095901796; terminals('14', '4') = 0.42102479556668526; terminals('14', '5') = 0.259839300439883; 
terminals('15', '1') = 0.7099885165710115; terminals('15', '2') = 0.8470602158660715; terminals('15', '3') = 0.7015883166728174; terminals('15', '4') = 0.22757241214248525; terminals('15', '5') = 0.5664231076791302; 
terminals('16', '1') = 0.1915563673624745; terminals('16', '2') = 0.614026804935607; terminals('16', '3') = 0.6800880832301075; terminals('16', '4') = 0.04203212775450116; terminals('16', '5') = 0.25653327122691316; 
terminals('17', '1') = 0.7463334422941102; terminals('17', '2') = 0.758147216593005; terminals('17', '3') = 0.7378808285112479; terminals('17', '4') = 0.20429701936529465; terminals('17', '5') = 0.30482923169083875; 
terminals('18', '1') = 0.3401525235421389; terminals('18', '2') = 0.4261904158131965; terminals('18', '3') = 0.16245587035889664; terminals('18', '4') = 0.8268342287799648; terminals('18', '5') = 0.6089000574201565; 
terminals('19', '1') = 0.5917842829424735; terminals('19', '2') = 0.00219118807109675; terminals('19', '3') = 0.7819656498377002; terminals('19', '4') = 0.033410282814647196; terminals('19', '5') = 0.8760483807622496; 
terminals('20', '1') = 0.9311607479514828; terminals('20', '2') = 0.6586084220269107; terminals('20', '3') = 0.5236293967278228; terminals('20', '4') = 0.08320977302340771; terminals('20', '5') = 0.8401393506758171; 
terminals('21', '1') = 0.9979472290209521; terminals('21', '2') = 0.7707334345443212; terminals('21', '3') = 0.5446810096773985; terminals('21', '4') = 0.8761178765059107; terminals('21', '5') = 0.13505959080621865; 
terminals('22', '1') = 0.2805685864639046; terminals('22', '2') = 0.5760525705205601; terminals('22', '3') = 0.1594989392943137; terminals('22', '4') = 0.018739602670324262; terminals('22', '5') = 0.5776675294902307; 
terminals('23', '1') = 0.7144376360638399; terminals('23', '2') = 0.7454414189730381; terminals('23', '3') = 0.6123283984110595; terminals('23', '4') = 0.6875899989040011; terminals('23', '5') = 0.31449602117547915; 
terminals('24', '1') = 0.8471855855985048; terminals('24', '2') = 0.45561864864378043; terminals('24', '3') = 0.06203771714062978; terminals('24', '4') = 0.7588173374031941; terminals('24', '5') = 0.9389724591833865; 
terminals('25', '1') = 0.44699248478704556; terminals('25', '2') = 0.8314023877169783; terminals('25', '3') = 0.9116577086875807; terminals('25', '4') = 0.2653349215484284; terminals('25', '5') = 0.5540972304206971; 
terminals('26', '1') = 0.8077815122099584; terminals('26', '2') = 0.3171370447460986; terminals('26', '3') = 0.7315918296201928; terminals('26', '4') = 0.5577824712696594; terminals('26', '5') = 0.033034686806425184; 
terminals('27', '1') = 0.6356514275025035; terminals('27', '2') = 0.9254117617303362; terminals('27', '3') = 0.744452619806895; terminals('27', '4') = 0.3120069537230281; terminals('27', '5') = 0.5325307427338776; 
terminals('28', '1') = 0.5509827175657424; terminals('28', '2') = 0.7135964050271819; terminals('28', '3') = 0.10245524558610153; terminals('28', '4') = 0.5161559769593902; terminals('28', '5') = 0.8994914609831506; 
terminals('29', '1') = 0.7465261026516519; terminals('29', '2') = 0.6386038593511377; terminals('29', '3') = 0.2820151644308786; terminals('29', '4') = 0.38748991496864915; terminals('29', '5') = 0.6642080382757831; 
terminals('30', '1') = 0.1553390204073667; terminals('30', '2') = 0.13454757013042407; terminals('30', '3') = 0.35298598482739296; terminals('30', '4') = 0.7699984117303215; terminals('30', '5') = 0.1255391340336497; 
terminals('31', '1') = 0.798323912801965; terminals('31', '2') = 0.33220215532324515; terminals('31', '3') = 0.94233009157568; terminals('31', '4') = 0.6519944316723181; terminals('31', '5') = 0.3113445887324868; 
terminals('32', '1') = 0.45460110320181557; terminals('32', '2') = 0.7135098031570053; terminals('32', '3') = 0.17411160228463496; terminals('32', '4') = 0.6664609858483732; terminals('32', '5') = 0.5229499859694803; 
terminals('33', '1') = 0.20696994370245103; terminals('33', '2') = 0.027345184567223346; terminals('33', '3') = 0.15400810278599375; terminals('33', '4') = 0.34605581320236967; terminals('33', '5') = 0.5735725913297424; 
terminals('34', '1') = 0.07732947159381731; terminals('34', '2') = 0.6609347012960304; terminals('34', '3') = 0.4059396939259996; terminals('34', '4') = 0.7571706088816887; terminals('34', '5') = 0.39784169022134097; 
terminals('35', '1') = 0.5558094166754509; terminals('35', '2') = 0.8426458506815123; terminals('35', '3') = 0.48806061435468084; terminals('35', '4') = 0.9209229939352234; terminals('35', '5') = 0.8191929515289442; 
Parameter bigM / 2.23606797749979 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
