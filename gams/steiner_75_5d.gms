Sets
i Steiner points / 1*73 /
j terminals / 1*75 /
k dimensions / 1*5 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.2337128845243409; terminals('1', '2') = 0.2494830168798874; terminals('1', '3') = 0.4374435408309275; terminals('1', '4') = 0.776951878994274; terminals('1', '5') = 0.2655309228551588; 
terminals('2', '1') = 0.5198003374988266; terminals('2', '2') = 0.9751916913943709; terminals('2', '3') = 0.6158368720060988; terminals('2', '4') = 0.8806927385164256; terminals('2', '5') = 0.3879318499565081; 
terminals('3', '1') = 0.671777305885989; terminals('3', '2') = 0.7109462706203792; terminals('3', '3') = 0.846370780303582; terminals('3', '4') = 0.40042110560623745; terminals('3', '5') = 0.08461946994419656; 
terminals('4', '1') = 0.4596905074425989; terminals('4', '2') = 0.29896930089990037; terminals('4', '3') = 0.10749368431397488; terminals('4', '4') = 0.49164033438287424; terminals('4', '5') = 0.22139389872665127; 
terminals('5', '1') = 0.7202296113451966; terminals('5', '2') = 0.32984790973020806; terminals('5', '3') = 0.5313171381952846; terminals('5', '4') = 0.7901870620177621; terminals('5', '5') = 0.3915087055918688; 
terminals('6', '1') = 0.41795714670700823; terminals('6', '2') = 0.06079526620924813; terminals('6', '3') = 0.12723117928606575; terminals('6', '4') = 0.1395744654328378; terminals('6', '5') = 0.7197672010035228; 
terminals('7', '1') = 0.9206443160502645; terminals('7', '2') = 0.08961786082901946; terminals('7', '3') = 0.3948479272750681; terminals('7', '4') = 0.8028348294655349; terminals('7', '5') = 0.17656103927967137; 
terminals('8', '1') = 0.28249394388578686; terminals('8', '2') = 0.49938890267085334; terminals('8', '3') = 0.10961122863276618; terminals('8', '4') = 0.19710144460343093; terminals('8', '5') = 0.41891513595577734; 
terminals('9', '1') = 0.01812743449486731; terminals('9', '2') = 0.05793296818426996; terminals('9', '3') = 0.9148703925206588; terminals('9', '4') = 0.8278452572648055; terminals('9', '5') = 0.9150433671859041; 
terminals('10', '1') = 0.5984990100018075; terminals('10', '2') = 0.23598455747230762; terminals('10', '3') = 0.7575142133254135; terminals('10', '4') = 0.49846709310912574; terminals('10', '5') = 0.8735282435458449; 
terminals('11', '1') = 0.9426722613093684; terminals('11', '2') = 0.23946720136787536; terminals('11', '3') = 0.27012700123924427; terminals('11', '4') = 0.8508770309159327; terminals('11', '5') = 0.42749718487290755; 
terminals('12', '1') = 0.8308821095759504; terminals('12', '2') = 0.1400386466065744; terminals('12', '3') = 0.9381582086907002; terminals('12', '4') = 0.5362935553129833; terminals('12', '5') = 0.20358783862911944; 
terminals('13', '1') = 0.31635787727190334; terminals('13', '2') = 0.37801143170878115; terminals('13', '3') = 0.056773687596044176; terminals('13', '4') = 0.7478692095049628; terminals('13', '5') = 0.3584178222066461; 
terminals('14', '1') = 0.5956838823447893; terminals('14', '2') = 0.5472690233121417; terminals('14', '3') = 0.8272025572371529; terminals('14', '4') = 0.19491954167617886; terminals('14', '5') = 0.8383157013272367; 
terminals('15', '1') = 0.6773445942128684; terminals('15', '2') = 0.7291315967715905; terminals('15', '3') = 0.5792431815880833; terminals('15', '4') = 0.23802162891467726; terminals('15', '5') = 0.26766031051582007; 
terminals('16', '1') = 0.41888221185367613; terminals('16', '2') = 0.5563309626473071; terminals('16', '3') = 0.29851887427619306; terminals('16', '4') = 0.24997365252955628; terminals('16', '5') = 0.8944548760735401; 
terminals('17', '1') = 0.9734922473062249; terminals('17', '2') = 0.3922964491235216; terminals('17', '3') = 0.10442880477098859; terminals('17', '4') = 0.5475467519715685; terminals('17', '5') = 0.2829547892466461; 
terminals('18', '1') = 0.023920412951918935; terminals('18', '2') = 0.78158686879325; terminals('18', '3') = 0.27357821906948676; terminals('18', '4') = 0.08329524301132063; terminals('18', '5') = 0.5304526474207065; 
terminals('19', '1') = 0.19615789720511267; terminals('19', '2') = 0.8062675132583397; terminals('19', '3') = 0.6674944440847498; terminals('19', '4') = 0.4159955385030585; terminals('19', '5') = 0.7615850043812412; 
terminals('20', '1') = 0.7618470404534957; terminals('20', '2') = 0.8028484930596643; terminals('20', '3') = 0.26340463234638667; terminals('20', '4') = 0.5216026431240695; terminals('20', '5') = 0.8347807020127398; 
terminals('21', '1') = 0.44011613846185205; terminals('21', '2') = 0.2992291480494087; terminals('21', '3') = 0.6019312295218678; terminals('21', '4') = 0.02931843937459011; terminals('21', '5') = 0.45919700015470766; 
terminals('22', '1') = 0.533322388424485; terminals('22', '2') = 0.7795727036973491; terminals('22', '3') = 0.49393006483794766; terminals('22', '4') = 0.7131852477974817; terminals('22', '5') = 0.09131125828927156; 
terminals('23', '1') = 0.004543767441810842; terminals('23', '2') = 0.09601272822174312; terminals('23', '3') = 0.4284115148148001; terminals('23', '4') = 0.37495887536042627; terminals('23', '5') = 0.12789120833961176; 
terminals('24', '1') = 0.6270309587591839; terminals('24', '2') = 0.7956031743572247; terminals('24', '3') = 0.5237602527279192; terminals('24', '4') = 0.0025160872719774963; terminals('24', '5') = 0.9728914814285822; 
terminals('25', '1') = 0.09555170519133327; terminals('25', '2') = 0.1690086845595271; terminals('25', '3') = 0.9137361177583642; terminals('25', '4') = 0.8303445004559571; terminals('25', '5') = 0.30910707467722276; 
terminals('26', '1') = 0.3642783183997801; terminals('26', '2') = 0.9502975663248703; terminals('26', '3') = 0.6700600340517588; terminals('26', '4') = 0.8438607709814873; terminals('26', '5') = 0.39431337535492816; 
terminals('27', '1') = 0.5149277357599015; terminals('27', '2') = 0.38717013794238864; terminals('27', '3') = 0.3113978463258914; terminals('27', '4') = 0.7454472898044259; terminals('27', '5') = 0.3796829006864485; 
terminals('28', '1') = 0.5325541334555921; terminals('28', '2') = 0.9685167756419112; terminals('28', '3') = 0.7222328380955434; terminals('28', '4') = 0.828206121348923; terminals('28', '5') = 0.39077280033932194; 
terminals('29', '1') = 0.5362697240940195; terminals('29', '2') = 0.11303330328997019; terminals('29', '3') = 0.750331240415788; terminals('29', '4') = 0.4328649167955724; terminals('29', '5') = 0.575275365989066; 
terminals('30', '1') = 0.4208628122826964; terminals('30', '2') = 0.2744908474231298; terminals('30', '3') = 0.836805237774382; terminals('30', '4') = 0.6389464994482648; terminals('30', '5') = 0.509091540913767; 
terminals('31', '1') = 0.9135254806980974; terminals('31', '2') = 0.011030343141505972; terminals('31', '3') = 0.549095355878987; terminals('31', '4') = 0.5699535061668554; terminals('31', '5') = 0.6177954028025379; 
terminals('32', '1') = 0.45413484720185315; terminals('32', '2') = 0.6442129608513837; terminals('32', '3') = 0.22675346263308493; terminals('32', '4') = 0.3669075257472916; terminals('32', '5') = 0.11054055018108744; 
terminals('33', '1') = 0.577107177591132; terminals('33', '2') = 0.46099346270591557; terminals('33', '3') = 0.9308856684045408; terminals('33', '4') = 0.9379876465175343; terminals('33', '5') = 0.7904751307023604; 
terminals('34', '1') = 0.2524511881904884; terminals('34', '2') = 0.5853469211367942; terminals('34', '3') = 0.6504835454435617; terminals('34', '4') = 0.42949538684140576; terminals('34', '5') = 0.10257990924108606; 
terminals('35', '1') = 0.23581814392480138; terminals('35', '2') = 0.4413091067998023; terminals('35', '3') = 0.7620515444427862; terminals('35', '4') = 0.8138565197795364; terminals('35', '5') = 0.6138217856363661; 
terminals('36', '1') = 0.22905995664055745; terminals('36', '2') = 0.2169596491397774; terminals('36', '3') = 0.09779591212176553; terminals('36', '4') = 0.5202963362234717; terminals('36', '5') = 0.47007376355752695; 
terminals('37', '1') = 0.8600214580131949; terminals('37', '2') = 0.14540566198159888; terminals('37', '3') = 0.5405611746654403; terminals('37', '4') = 0.23476113621444095; terminals('37', '5') = 0.4994249513781821; 
terminals('38', '1') = 0.10916301785513194; terminals('38', '2') = 0.7012079127307455; terminals('38', '3') = 0.4159631378666976; terminals('38', '4') = 0.7312576610421746; terminals('38', '5') = 0.6961066063105291; 
terminals('39', '1') = 0.4761449882086324; terminals('39', '2') = 0.34978079992860545; terminals('39', '3') = 0.15234117692960736; terminals('39', '4') = 0.8963527591063171; terminals('39', '5') = 0.7888196561274959; 
terminals('40', '1') = 0.6446417741140665; terminals('40', '2') = 0.7927343619118571; terminals('40', '3') = 0.5829470448464693; terminals('40', '4') = 0.83392690544359; terminals('40', '5') = 0.7308669983486256; 
terminals('41', '1') = 0.33852570465414156; terminals('41', '2') = 0.5844346407225413; terminals('41', '3') = 0.7567131729775775; terminals('41', '4') = 0.3169625644538746; terminals('41', '5') = 0.049696317343618235; 
terminals('42', '1') = 0.970434237616385; terminals('42', '2') = 0.6256466346155354; terminals('42', '3') = 0.789350460073072; terminals('42', '4') = 0.26230219824605416; terminals('42', '5') = 0.719409158771381; 
terminals('43', '1') = 0.264062665564489; terminals('43', '2') = 0.6891649561889799; terminals('43', '3') = 0.2546602103714668; terminals('43', '4') = 0.9911819835467892; terminals('43', '5') = 0.21455948745345033; 
terminals('44', '1') = 0.9035661276594622; terminals('44', '2') = 0.394536809523821; terminals('44', '3') = 0.04690498236514995; terminals('44', '4') = 0.4605595779070014; terminals('44', '5') = 0.9216090129479815; 
terminals('45', '1') = 0.47022613323357876; terminals('45', '2') = 0.3347019740102819; terminals('45', '3') = 0.7474111348708835; terminals('45', '4') = 0.20541597083234997; terminals('45', '5') = 0.594988732604215; 
terminals('46', '1') = 0.32839206936686716; terminals('46', '2') = 0.08893700386459569; terminals('46', '3') = 0.29450849489261033; terminals('46', '4') = 0.9219755808491664; terminals('46', '5') = 0.6526007478343587; 
terminals('47', '1') = 0.4853441212177092; terminals('47', '2') = 0.8829213473208892; terminals('47', '3') = 0.7565419607387306; terminals('47', '4') = 0.5664942085629959; terminals('47', '5') = 0.7522286905575457; 
terminals('48', '1') = 0.9652499801471018; terminals('48', '2') = 0.7752101431294517; terminals('48', '3') = 0.9818737406053494; terminals('48', '4') = 0.034679911549653664; terminals('48', '5') = 0.0005354151742665847; 
terminals('49', '1') = 0.89358746514474; terminals('49', '2') = 0.09545389370947888; terminals('49', '3') = 0.21861753205436818; terminals('49', '4') = 0.5773659849080304; terminals('49', '5') = 0.07581675746723326; 
terminals('50', '1') = 0.257630237112638; terminals('50', '2') = 0.6860936769860491; terminals('50', '3') = 0.4252554129760673; terminals('50', '4') = 0.3870677767636359; terminals('50', '5') = 0.16149744333207872; 
terminals('51', '1') = 0.3864817183757395; terminals('51', '2') = 0.6466982366604898; terminals('51', '3') = 0.6053720582049624; terminals('51', '4') = 0.3561433931761425; terminals('51', '5') = 0.48259291434770146; 
terminals('52', '1') = 0.5419115233198046; terminals('52', '2') = 0.24810875846123792; terminals('52', '3') = 0.65526123992613; terminals('52', '4') = 0.11440043479655537; terminals('52', '5') = 0.5983675245393492; 
terminals('53', '1') = 0.4046757778077389; terminals('53', '2') = 0.39051538417287646; terminals('53', '3') = 0.9264288661444383; terminals('53', '4') = 0.31006338152837387; terminals('53', '5') = 0.4593852770226231; 
terminals('54', '1') = 0.7924765235843646; terminals('54', '2') = 0.4880784063006828; terminals('54', '3') = 0.23497156045581424; terminals('54', '4') = 0.15327106659167955; terminals('54', '5') = 0.08539377284744842; 
terminals('55', '1') = 0.6906791033056465; terminals('55', '2') = 0.8463962521134563; terminals('55', '3') = 0.03399992646564198; terminals('55', '4') = 0.14924493685089812; terminals('55', '5') = 0.9884128786041264; 
terminals('56', '1') = 0.5277632343582029; terminals('56', '2') = 0.568694679686055; terminals('56', '3') = 0.6479766607670696; terminals('56', '4') = 0.792107531160052; terminals('56', '5') = 0.6662146254219713; 
terminals('57', '1') = 0.2114097815345023; terminals('57', '2') = 0.15587412513054466; terminals('57', '3') = 0.49165727801756864; terminals('57', '4') = 0.26295292518137114; terminals('57', '5') = 0.022718372663519393; 
terminals('58', '1') = 0.6532260833150734; terminals('58', '2') = 0.09603130525952275; terminals('58', '3') = 0.07518808192135129; terminals('58', '4') = 0.7675644354603843; terminals('58', '5') = 0.9164229341448606; 
terminals('59', '1') = 0.7633841103126381; terminals('59', '2') = 0.5197875835220755; terminals('59', '3') = 0.2686643226768839; terminals('59', '4') = 0.19391739409961872; terminals('59', '5') = 0.4010929321252934; 
terminals('60', '1') = 0.5987420140089923; terminals('60', '2') = 0.03651875684778494; terminals('60', '3') = 0.43477100974771565; terminals('60', '4') = 0.7491428351741467; terminals('60', '5') = 0.1235786550434097; 
terminals('61', '1') = 0.2322833674920357; terminals('61', '2') = 0.16770603037695286; terminals('61', '3') = 0.04371656186531292; terminals('61', '4') = 0.41876643031091276; terminals('61', '5') = 0.0626613694911563; 
terminals('62', '1') = 0.6253512974013641; terminals('62', '2') = 0.5396966142081321; terminals('62', '3') = 0.43155865839149943; terminals('62', '4') = 0.8832924818170497; terminals('62', '5') = 0.1488247661397929; 
terminals('63', '1') = 0.18741117620753212; terminals('63', '2') = 0.597456968961753; terminals('63', '3') = 0.8160225058026644; terminals('63', '4') = 0.3612203151969632; terminals('63', '5') = 0.4223201638390729; 
terminals('64', '1') = 0.3892919350803744; terminals('64', '2') = 0.15275238779269318; terminals('64', '3') = 0.6019204485578199; terminals('64', '4') = 0.27066945515202645; terminals('64', '5') = 0.6632956921784982; 
terminals('65', '1') = 0.5836345592972506; terminals('65', '2') = 0.8782573170069614; terminals('65', '3') = 0.25121993741690773; terminals('65', '4') = 0.5573426494869248; terminals('65', '5') = 0.23078248103329024; 
terminals('66', '1') = 0.15635599559953284; terminals('66', '2') = 0.581511727331948; terminals('66', '3') = 0.052190351929046974; terminals('66', '4') = 0.9741778123933893; terminals('66', '5') = 0.8330421441038685; 
terminals('67', '1') = 0.6947655701614852; terminals('67', '2') = 0.8723412856938871; terminals('67', '3') = 0.9677351276702828; terminals('67', '4') = 0.1393211770623971; terminals('67', '5') = 0.2831481801795629; 
terminals('68', '1') = 0.7663822495084277; terminals('68', '2') = 0.4208252307091864; terminals('68', '3') = 0.6322439657856167; terminals('68', '4') = 0.6015734156455432; terminals('68', '5') = 0.8682779580930273; 
terminals('69', '1') = 0.38045689112528847; terminals('69', '2') = 0.6235211674869459; terminals('69', '3') = 0.692739246589577; terminals('69', '4') = 0.06491044397915513; terminals('69', '5') = 0.7747721669709958; 
terminals('70', '1') = 0.9833937616664635; terminals('70', '2') = 0.24849006274536478; terminals('70', '3') = 0.1550499469558554; terminals('70', '4') = 0.233685803252908; terminals('70', '5') = 0.507465719240958; 
terminals('71', '1') = 0.7661680382043098; terminals('71', '2') = 0.33275067085139964; terminals('71', '3') = 0.6193783233025477; terminals('71', '4') = 0.4917401628937037; terminals('71', '5') = 0.7993037353223338; 
terminals('72', '1') = 0.13806585294358986; terminals('72', '2') = 0.24612112301880074; terminals('72', '3') = 0.8572121661037709; terminals('72', '4') = 0.591569282991971; terminals('72', '5') = 0.1588545392483568; 
terminals('73', '1') = 0.21339945095817026; terminals('73', '2') = 0.6167599627179152; terminals('73', '3') = 0.09833857901497878; terminals('73', '4') = 0.4135100373299635; terminals('73', '5') = 0.5826327788846649; 
terminals('74', '1') = 0.6740185964427144; terminals('74', '2') = 0.26119977028258046; terminals('74', '3') = 0.5133890699525158; terminals('74', '4') = 0.39714219910331805; terminals('74', '5') = 0.8388100448844741; 
terminals('75', '1') = 0.4142321819878133; terminals('75', '2') = 0.8068343101788525; terminals('75', '3') = 0.14967304821851946; terminals('75', '4') = 0.7180995655086355; terminals('75', '5') = 0.00232370684306904; 
Parameter bigM / 2.23606797749979 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
