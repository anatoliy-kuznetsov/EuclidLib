Sets
i Steiner points / 1*128 /
j terminals / 1*130 /
k dimensions / 1*3 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.5673817886832788; terminals('1', '2') = 0.08865270721685536; terminals('1', '3') = 0.5092378852401632; 
terminals('2', '1') = 0.9823600540961589; terminals('2', '2') = 0.9457614095775193; terminals('2', '3') = 0.5129138563113126; 
terminals('3', '1') = 0.013597832746759964; terminals('3', '2') = 0.758440444724367; terminals('3', '3') = 0.6336708387311173; 
terminals('4', '1') = 0.6172362560516091; terminals('4', '2') = 0.6857548470133066; terminals('4', '3') = 0.21566365916320274; 
terminals('5', '1') = 0.04873012946267363; terminals('5', '2') = 0.08779899572069871; terminals('5', '3') = 0.30322011610583954; 
terminals('6', '1') = 0.6868023413828622; terminals('6', '2') = 0.48029398841404336; terminals('6', '3') = 0.31102707377188954; 
terminals('7', '1') = 0.1710725014639678; terminals('7', '2') = 0.07141000049905277; terminals('7', '3') = 0.6516311175918723; 
terminals('8', '1') = 0.43845373923211883; terminals('8', '2') = 0.19872882346396226; terminals('8', '3') = 0.9559778743641403; 
terminals('9', '1') = 0.8358897413617169; terminals('9', '2') = 0.6498847840962475; terminals('9', '3') = 0.6556780898670546; 
terminals('10', '1') = 0.37802639713285446; terminals('10', '2') = 0.22292887367336234; terminals('10', '3') = 0.6118782438588479; 
terminals('11', '1') = 0.8871305285318652; terminals('11', '2') = 0.8028468538517483; terminals('11', '3') = 0.9108580417418051; 
terminals('12', '1') = 0.6260247401680246; terminals('12', '2') = 0.04208369265480394; terminals('12', '3') = 0.8829987261865047; 
terminals('13', '1') = 0.7830748567432378; terminals('13', '2') = 0.24270607151807932; terminals('13', '3') = 0.4142519032244303; 
terminals('14', '1') = 0.5282692907719713; terminals('14', '2') = 0.6655643788373583; terminals('14', '3') = 0.07084413012983148; 
terminals('15', '1') = 0.18226975994004913; terminals('15', '2') = 0.29831213532696166; terminals('15', '3') = 0.8510332139198249; 
terminals('16', '1') = 0.9388506551627444; terminals('16', '2') = 0.42035881379806783; terminals('16', '3') = 0.8635556544311337; 
terminals('17', '1') = 0.38729129694421127; terminals('17', '2') = 0.40312816019100994; terminals('17', '3') = 0.5500111662606114; 
terminals('18', '1') = 0.37030469292888923; terminals('18', '2') = 0.38725435104381833; terminals('18', '3') = 0.16265924364243467; 
terminals('19', '1') = 0.7930379691954876; terminals('19', '2') = 0.45555248426397577; terminals('19', '3') = 0.9498428362961735; 
terminals('20', '1') = 0.3540302000969565; terminals('20', '2') = 0.43973848985795416; terminals('20', '3') = 0.1793708568736888; 
terminals('21', '1') = 0.7688218790220265; terminals('21', '2') = 0.37765892534335865; terminals('21', '3') = 0.7188138717431981; 
terminals('22', '1') = 0.18850374791070246; terminals('22', '2') = 0.7994486793856352; terminals('22', '3') = 0.6436808654311025; 
terminals('23', '1') = 0.4054452061625322; terminals('23', '2') = 0.44402378003779774; terminals('23', '3') = 0.8200424559244482; 
terminals('24', '1') = 0.8803686181993963; terminals('24', '2') = 0.5665677736751212; terminals('24', '3') = 0.3036418506979017; 
terminals('25', '1') = 0.6015971231560663; terminals('25', '2') = 0.8731938918085592; terminals('25', '3') = 0.8978129865881614; 
terminals('26', '1') = 0.6967510755475466; terminals('26', '2') = 0.9052800248057704; terminals('26', '3') = 0.33485092083932455; 
terminals('27', '1') = 0.23914865107238947; terminals('27', '2') = 0.07250501189585212; terminals('27', '3') = 0.5396707222041012; 
terminals('28', '1') = 0.2839879090284696; terminals('28', '2') = 0.37423472280486747; terminals('28', '3') = 0.4842733351401137; 
terminals('29', '1') = 0.4120071978077826; terminals('29', '2') = 0.12033912814705261; terminals('29', '3') = 0.4592369089394127; 
terminals('30', '1') = 0.011857179263296103; terminals('30', '2') = 0.18603108115088085; terminals('30', '3') = 0.09315678041833275; 
terminals('31', '1') = 0.08364462171676135; terminals('31', '2') = 0.15128487193869944; terminals('31', '3') = 0.20210194536749015; 
terminals('32', '1') = 0.3478605309817864; terminals('32', '2') = 0.05094035323751833; terminals('32', '3') = 0.3040444832073619; 
terminals('33', '1') = 0.3806909487178449; terminals('33', '2') = 0.4431524987072748; terminals('33', '3') = 0.6870377627058775; 
terminals('34', '1') = 0.37072646437360124; terminals('34', '2') = 0.07133069354818877; terminals('34', '3') = 0.06296144442835361; 
terminals('35', '1') = 0.9006055652728165; terminals('35', '2') = 0.15303029447212613; terminals('35', '3') = 0.287350619734014; 
terminals('36', '1') = 0.8092156282894067; terminals('36', '2') = 0.507280024931654; terminals('36', '3') = 0.9657907380980305; 
terminals('37', '1') = 0.45832441691651005; terminals('37', '2') = 0.6884124886736482; terminals('37', '3') = 0.10773285166408364; 
terminals('38', '1') = 0.495901894704044; terminals('38', '2') = 0.3066407489650803; terminals('38', '3') = 0.46089298266304; 
terminals('39', '1') = 0.6326515341056312; terminals('39', '2') = 0.3611706639370377; terminals('39', '3') = 0.42812619172886957; 
terminals('40', '1') = 0.7341941508741082; terminals('40', '2') = 0.8333015383268629; terminals('40', '3') = 0.9103125578282812; 
terminals('41', '1') = 0.72063555210718; terminals('41', '2') = 0.2037711745653833; terminals('41', '3') = 0.36644666439179896; 
terminals('42', '1') = 0.38940785999593364; terminals('42', '2') = 0.5441514193346569; terminals('42', '3') = 0.44851525672118786; 
terminals('43', '1') = 0.797662861188163; terminals('43', '2') = 0.07316326756551439; terminals('43', '3') = 0.3649239583839293; 
terminals('44', '1') = 0.08164873350050594; terminals('44', '2') = 0.021703230225201375; terminals('44', '3') = 0.7705194562878022; 
terminals('45', '1') = 0.8549832968463179; terminals('45', '2') = 0.4068593515760256; terminals('45', '3') = 0.4606528080869967; 
terminals('46', '1') = 0.2781195626923354; terminals('46', '2') = 0.9636110209615435; terminals('46', '3') = 0.9392923796850366; 
terminals('47', '1') = 0.4223276704033213; terminals('47', '2') = 0.28040306361322187; terminals('47', '3') = 0.026698520780986223; 
terminals('48', '1') = 0.6037717837539794; terminals('48', '2') = 0.25653597346846024; terminals('48', '3') = 0.5248168617573157; 
terminals('49', '1') = 0.2840328339999135; terminals('49', '2') = 0.465228400438658; terminals('49', '3') = 0.5524528792493762; 
terminals('50', '1') = 0.9761920762109925; terminals('50', '2') = 0.18982751344372562; terminals('50', '3') = 0.1213222089002064; 
terminals('51', '1') = 0.2684173399733295; terminals('51', '2') = 0.9944970489751268; terminals('51', '3') = 0.8144373068531747; 
terminals('52', '1') = 0.9627684909972327; terminals('52', '2') = 0.20866594745942701; terminals('52', '3') = 0.079870597130145; 
terminals('53', '1') = 0.8354281886023762; terminals('53', '2') = 0.5286952248060334; terminals('53', '3') = 0.810888417155725; 
terminals('54', '1') = 0.2141171831119708; terminals('54', '2') = 0.08000396398038401; terminals('54', '3') = 0.563972535432945; 
terminals('55', '1') = 0.8487116574737226; terminals('55', '2') = 0.18724813353275183; terminals('55', '3') = 0.8874730914057622; 
terminals('56', '1') = 0.3628363548048037; terminals('56', '2') = 0.9112918195502567; terminals('56', '3') = 0.12513599991871283; 
terminals('57', '1') = 0.9725005705745596; terminals('57', '2') = 0.9340539827704892; terminals('57', '3') = 0.33681992947542205; 
terminals('58', '1') = 0.938907223642071; terminals('58', '2') = 0.6646850666334717; terminals('58', '3') = 0.5573306457548838; 
terminals('59', '1') = 0.7902461703855096; terminals('59', '2') = 0.660258807701124; terminals('59', '3') = 0.8569387871324224; 
terminals('60', '1') = 0.18178484387229077; terminals('60', '2') = 0.10111459426393188; terminals('60', '3') = 0.7791918960371995; 
terminals('61', '1') = 0.1366666682390596; terminals('61', '2') = 0.0892588837716548; terminals('61', '3') = 0.687415916024598; 
terminals('62', '1') = 0.891200256049714; terminals('62', '2') = 0.43103179502773314; terminals('62', '3') = 0.972754653264748; 
terminals('63', '1') = 0.9823353859907017; terminals('63', '2') = 0.24791973721225813; terminals('63', '3') = 0.1257861140667369; 
terminals('64', '1') = 0.6309214778059655; terminals('64', '2') = 0.06387318499564754; terminals('64', '3') = 0.6036049298492577; 
terminals('65', '1') = 0.6108890074360254; terminals('65', '2') = 0.6397035086666109; terminals('65', '3') = 0.263221540605877; 
terminals('66', '1') = 0.08764498389070419; terminals('66', '2') = 0.7835560344902189; terminals('66', '3') = 0.16052937368010312; 
terminals('67', '1') = 0.35295391924791797; terminals('67', '2') = 0.22596764665261648; terminals('67', '3') = 0.3456855284167625; 
terminals('68', '1') = 0.24959971057774377; terminals('68', '2') = 0.8615416340317504; terminals('68', '3') = 0.7885139857664251; 
terminals('69', '1') = 0.39368326215136384; terminals('69', '2') = 0.8890417890237001; terminals('69', '3') = 0.564192778124782; 
terminals('70', '1') = 0.5224744612678061; terminals('70', '2') = 0.021687690060921083; terminals('70', '3') = 0.9808240113947496; 
terminals('71', '1') = 0.2220293930916606; terminals('71', '2') = 0.23211929278912014; terminals('71', '3') = 0.3180762252361826; 
terminals('72', '1') = 0.7033183181805236; terminals('72', '2') = 0.9327743440942114; terminals('72', '3') = 0.19217989536196367; 
terminals('73', '1') = 0.8602544636758896; terminals('73', '2') = 0.8229131999247746; terminals('73', '3') = 0.8422635116431589; 
terminals('74', '1') = 0.5383189000105364; terminals('74', '2') = 0.3749831645914886; terminals('74', '3') = 0.026651218770693874; 
terminals('75', '1') = 0.6565963673667133; terminals('75', '2') = 0.3677933823819458; terminals('75', '3') = 0.9697303630386255; 
terminals('76', '1') = 0.14572542270456557; terminals('76', '2') = 0.14997508758208633; terminals('76', '3') = 0.10789763693417576; 
terminals('77', '1') = 0.4991119077819025; terminals('77', '2') = 0.46206409863712417; terminals('77', '3') = 0.8767623675196486; 
terminals('78', '1') = 0.398003554758935; terminals('78', '2') = 0.8371696053302671; terminals('78', '3') = 0.7970338407426096; 
terminals('79', '1') = 0.13385893080099565; terminals('79', '2') = 0.25568444136089796; terminals('79', '3') = 0.3665092326807413; 
terminals('80', '1') = 0.3709123466691937; terminals('80', '2') = 0.3363201963624822; terminals('80', '3') = 0.09004252059454321; 
terminals('81', '1') = 0.8609391448649991; terminals('81', '2') = 0.04232406800631927; terminals('81', '3') = 0.10746776033659677; 
terminals('82', '1') = 0.19596446929238653; terminals('82', '2') = 0.7578139579214721; terminals('82', '3') = 0.24080161132240074; 
terminals('83', '1') = 0.16435533418833326; terminals('83', '2') = 0.8242639525116371; terminals('83', '3') = 0.24887507079523674; 
terminals('84', '1') = 0.36681476456927486; terminals('84', '2') = 0.0489723645915926; terminals('84', '3') = 0.3120373004950109; 
terminals('85', '1') = 0.3366771946851561; terminals('85', '2') = 0.30608795737943695; terminals('85', '3') = 0.9513147205669621; 
terminals('86', '1') = 0.12119890531819721; terminals('86', '2') = 0.1025287460783153; terminals('86', '3') = 0.26551432038640654; 
terminals('87', '1') = 0.3025112130066965; terminals('87', '2') = 0.7745120742645546; terminals('87', '3') = 0.4226333112407581; 
terminals('88', '1') = 0.7178962743242524; terminals('88', '2') = 0.25451991435303445; terminals('88', '3') = 0.047880349748145035; 
terminals('89', '1') = 0.7931927420436344; terminals('89', '2') = 0.713665514719741; terminals('89', '3') = 0.4393398860498009; 
terminals('90', '1') = 0.25289005334742753; terminals('90', '2') = 0.565164894219761; terminals('90', '3') = 0.29072630024917834; 
terminals('91', '1') = 0.07341737362123557; terminals('91', '2') = 0.5071651819548905; terminals('91', '3') = 0.9028175431550037; 
terminals('92', '1') = 0.11801936468187979; terminals('92', '2') = 0.6948389661026511; terminals('92', '3') = 0.15702698722934927; 
terminals('93', '1') = 0.9071453694166854; terminals('93', '2') = 0.985929755525902; terminals('93', '3') = 0.6437371489661249; 
terminals('94', '1') = 0.40490098885801284; terminals('94', '2') = 0.32049653797850974; terminals('94', '3') = 0.49058642204845515; 
terminals('95', '1') = 0.13983090336933002; terminals('95', '2') = 0.10951925789354844; terminals('95', '3') = 0.2139401976247597; 
terminals('96', '1') = 0.04116005740924833; terminals('96', '2') = 0.5804373035340333; terminals('96', '3') = 0.22918416306574574; 
terminals('97', '1') = 0.418037087854092; terminals('97', '2') = 0.1904450806225667; terminals('97', '3') = 0.0985101439890046; 
terminals('98', '1') = 0.7069488239946805; terminals('98', '2') = 0.1589245550317; terminals('98', '3') = 0.151723227499864; 
terminals('99', '1') = 0.7327205524091881; terminals('99', '2') = 0.6391129830786209; terminals('99', '3') = 0.6698369444730682; 
terminals('100', '1') = 0.013608013239446826; terminals('100', '2') = 0.627346710196692; terminals('100', '3') = 0.9750653129290355; 
terminals('101', '1') = 0.3946595438547651; terminals('101', '2') = 0.5880123457963863; terminals('101', '3') = 0.4928666065051185; 
terminals('102', '1') = 0.11433484734960575; terminals('102', '2') = 0.2702308751613052; terminals('102', '3') = 0.5460297496457109; 
terminals('103', '1') = 0.8439058436508652; terminals('103', '2') = 0.7307736460267674; terminals('103', '3') = 0.23136053956762936; 
terminals('104', '1') = 0.7091045836881454; terminals('104', '2') = 0.38745044105007653; terminals('104', '3') = 0.3659473465460277; 
terminals('105', '1') = 0.2687774295260139; terminals('105', '2') = 0.37175373946977497; terminals('105', '3') = 0.4224164689409199; 
terminals('106', '1') = 0.3895027056701972; terminals('106', '2') = 0.39617114480483695; terminals('106', '3') = 0.4753031198899532; 
terminals('107', '1') = 0.16790724953603864; terminals('107', '2') = 0.15287389502804516; terminals('107', '3') = 0.48601681173200506; 
terminals('108', '1') = 0.0653237900864363; terminals('108', '2') = 0.0653498502698201; terminals('108', '3') = 0.5762314930754928; 
terminals('109', '1') = 0.9030716094971811; terminals('109', '2') = 0.2917531012606791; terminals('109', '3') = 0.5510844212866016; 
terminals('110', '1') = 0.5101860487793228; terminals('110', '2') = 0.37344489074492504; terminals('110', '3') = 0.8827728019164418; 
terminals('111', '1') = 0.31967844347856145; terminals('111', '2') = 0.4369764646723533; terminals('111', '3') = 0.16827863401346255; 
terminals('112', '1') = 0.7714689573550457; terminals('112', '2') = 0.7407573619832649; terminals('112', '3') = 0.7420313994289734; 
terminals('113', '1') = 0.15930467759735256; terminals('113', '2') = 0.8198214606752725; terminals('113', '3') = 0.6477239504270832; 
terminals('114', '1') = 0.7540343003483644; terminals('114', '2') = 0.10710580323554597; terminals('114', '3') = 0.49436957916240953; 
terminals('115', '1') = 0.7025087569864283; terminals('115', '2') = 0.9706586466381036; terminals('115', '3') = 0.792025967117854; 
terminals('116', '1') = 0.33136339726204767; terminals('116', '2') = 0.3438659468362866; terminals('116', '3') = 0.10225301324911817; 
terminals('117', '1') = 0.3011125368064973; terminals('117', '2') = 0.9010672258307144; terminals('117', '3') = 0.9289189938880839; 
terminals('118', '1') = 0.8783096745909977; terminals('118', '2') = 0.7115066197740143; terminals('118', '3') = 0.056017925485543074; 
terminals('119', '1') = 0.17469297120874117; terminals('119', '2') = 0.3822991247986568; terminals('119', '3') = 0.8082507500708933; 
terminals('120', '1') = 0.5119360408928817; terminals('120', '2') = 0.010600657366469757; terminals('120', '3') = 0.23397574532995213; 
terminals('121', '1') = 0.17328381728045772; terminals('121', '2') = 0.3212318661458258; terminals('121', '3') = 0.9050672241747163; 
terminals('122', '1') = 0.45170757636715486; terminals('122', '2') = 0.6020679213379653; terminals('122', '3') = 0.06420460870624067; 
terminals('123', '1') = 0.046122363797727384; terminals('123', '2') = 0.5681516020738226; terminals('123', '3') = 0.6685356072353301; 
terminals('124', '1') = 0.22640696054183018; terminals('124', '2') = 0.755184509558266; terminals('124', '3') = 0.10261933690515623; 
terminals('125', '1') = 0.880648392808994; terminals('125', '2') = 0.37982469234214833; terminals('125', '3') = 0.9115646456923265; 
terminals('126', '1') = 0.9316398231315293; terminals('126', '2') = 0.9424271707561801; terminals('126', '3') = 0.27326001766653774; 
terminals('127', '1') = 0.10327091532724597; terminals('127', '2') = 0.4360021802674542; terminals('127', '3') = 0.025241311680855527; 
terminals('128', '1') = 0.16885806519489133; terminals('128', '2') = 0.330542562350738; terminals('128', '3') = 0.8668169046381375; 
terminals('129', '1') = 0.46654221229163995; terminals('129', '2') = 0.6107578433493551; terminals('129', '3') = 0.8311386893147085; 
terminals('130', '1') = 0.7688191594645897; terminals('130', '2') = 0.6333779189083035; terminals('130', '3') = 0.06674244925641137; 
Parameter bigM / 1.7320508075688772 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
