Sets
i Steiner points / 1*103 /
j terminals / 1*105 /
k dimensions / 1*3 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.4099643207455651; terminals('1', '2') = 0.4139076645369567; terminals('1', '3') = 0.015261436804436368; 
terminals('2', '1') = 0.584121448121368; terminals('2', '2') = 0.04993914126450816; terminals('2', '3') = 0.1556114907674906; 
terminals('3', '1') = 0.2510773028740406; terminals('3', '2') = 0.675682695644701; terminals('3', '3') = 0.09474903721149441; 
terminals('4', '1') = 0.024963646394519978; terminals('4', '2') = 0.08888077365192337; terminals('4', '3') = 0.19749623691477236; 
terminals('5', '1') = 0.501030541849512; terminals('5', '2') = 0.9167201502698068; terminals('5', '3') = 0.09745006875207085; 
terminals('6', '1') = 0.6496652833564169; terminals('6', '2') = 0.7947003663552753; terminals('6', '3') = 0.3921666001449263; 
terminals('7', '1') = 0.40997875000646644; terminals('7', '2') = 0.03707094099800623; terminals('7', '3') = 0.45586772286286836; 
terminals('8', '1') = 0.6447702446551822; terminals('8', '2') = 0.7339423911872702; terminals('8', '3') = 0.041981265658233013; 
terminals('9', '1') = 0.8444044455868904; terminals('9', '2') = 0.5485504137998224; terminals('9', '3') = 0.12207300213528982; 
terminals('10', '1') = 0.22519840246158185; terminals('10', '2') = 0.011480308335362732; terminals('10', '3') = 0.2874765632080193; 
terminals('11', '1') = 0.14330947844648811; terminals('11', '2') = 0.09887526442514294; terminals('11', '3') = 0.6643153427821787; 
terminals('12', '1') = 0.020926272013205183; terminals('12', '2') = 0.3458919329502814; terminals('12', '3') = 0.9933442138354333; 
terminals('13', '1') = 0.8244641233680186; terminals('13', '2') = 0.28564762952216627; terminals('13', '3') = 0.008686101051478379; 
terminals('14', '1') = 0.7898926095971002; terminals('14', '2') = 0.8028858637903322; terminals('14', '3') = 0.5585467513572586; 
terminals('15', '1') = 0.7636960550279961; terminals('15', '2') = 0.4674368412971308; terminals('15', '3') = 0.7513731388967108; 
terminals('16', '1') = 0.46612041283805894; terminals('16', '2') = 0.07323849344632227; terminals('16', '3') = 0.7597531993542349; 
terminals('17', '1') = 0.014437504724517769; terminals('17', '2') = 0.4267213483329265; terminals('17', '3') = 0.18995073589995126; 
terminals('18', '1') = 0.1570259325407639; terminals('18', '2') = 0.6599361824313335; terminals('18', '3') = 0.7937855137888343; 
terminals('19', '1') = 0.3544112161170593; terminals('19', '2') = 0.3430317694400814; terminals('19', '3') = 0.8280073426674722; 
terminals('20', '1') = 0.10603519355639734; terminals('20', '2') = 0.39118895136074594; terminals('20', '3') = 0.8609673303589414; 
terminals('21', '1') = 0.6055012091508833; terminals('21', '2') = 0.9645891121479484; terminals('21', '3') = 0.2260703426171914; 
terminals('22', '1') = 0.05928479539289622; terminals('22', '2') = 0.9201729321436667; terminals('22', '3') = 0.8868747942884769; 
terminals('23', '1') = 0.009262424062111974; terminals('23', '2') = 0.8541760387400935; terminals('23', '3') = 0.3386142555742584; 
terminals('24', '1') = 0.721501550336811; terminals('24', '2') = 0.6051983383171339; terminals('24', '3') = 0.48431643303362426; 
terminals('25', '1') = 0.14377493179753897; terminals('25', '2') = 0.3400374113385495; terminals('25', '3') = 0.03488347026688665; 
terminals('26', '1') = 0.8417149832321598; terminals('26', '2') = 0.771517665722654; terminals('26', '3') = 0.675508657733928; 
terminals('27', '1') = 0.3146717658953423; terminals('27', '2') = 0.9184406563078129; terminals('27', '3') = 0.36963984975713515; 
terminals('28', '1') = 0.12546453533525914; terminals('28', '2') = 0.16202226134326536; terminals('28', '3') = 0.1573983348100373; 
terminals('29', '1') = 0.9988775425594483; terminals('29', '2') = 0.4251721634932033; terminals('29', '3') = 0.47058954259448904; 
terminals('30', '1') = 0.0716391542463245; terminals('30', '2') = 0.8216068718828863; terminals('30', '3') = 0.8524345772244766; 
terminals('31', '1') = 0.2646524630490247; terminals('31', '2') = 0.3929862725554384; terminals('31', '3') = 0.030979484268890745; 
terminals('32', '1') = 0.47198581385565364; terminals('32', '2') = 0.25750609006832514; terminals('32', '3') = 0.5019060486052089; 
terminals('33', '1') = 0.8806998138027764; terminals('33', '2') = 0.4825759949785312; terminals('33', '3') = 0.31926494280971396; 
terminals('34', '1') = 0.40532720234695463; terminals('34', '2') = 0.6196070317553483; terminals('34', '3') = 0.9703926026044772; 
terminals('35', '1') = 0.22959235456660598; terminals('35', '2') = 0.5066014109746103; terminals('35', '3') = 0.10678194915281947; 
terminals('36', '1') = 0.6715848337850273; terminals('36', '2') = 0.8039139150734841; terminals('36', '3') = 0.6100473269390586; 
terminals('37', '1') = 0.9350326169463044; terminals('37', '2') = 0.48799765276080376; terminals('37', '3') = 0.5136841946380959; 
terminals('38', '1') = 0.41272233676537806; terminals('38', '2') = 0.19390427160918; terminals('38', '3') = 0.2639098602828247; 
terminals('39', '1') = 0.013963576449774195; terminals('39', '2') = 0.4188495293993073; terminals('39', '3') = 0.6488066951593617; 
terminals('40', '1') = 0.27066493769491595; terminals('40', '2') = 0.2230956783482595; terminals('40', '3') = 0.4180903413968746; 
terminals('41', '1') = 0.4301038780267944; terminals('41', '2') = 0.9241839546685625; terminals('41', '3') = 0.057529085451446305; 
terminals('42', '1') = 0.2922526895766001; terminals('42', '2') = 0.4833389559607527; terminals('42', '3') = 0.2083170498060377; 
terminals('43', '1') = 0.3397325330214701; terminals('43', '2') = 0.7039669698973865; terminals('43', '3') = 0.08628951641621607; 
terminals('44', '1') = 0.0035946241205172536; terminals('44', '2') = 0.9734543303320524; terminals('44', '3') = 0.8244876523664412; 
terminals('45', '1') = 0.8943496770790388; terminals('45', '2') = 0.1620578295519045; terminals('45', '3') = 0.72521886084509; 
terminals('46', '1') = 0.1971299981839727; terminals('46', '2') = 0.32371106985655507; terminals('46', '3') = 0.720685791617847; 
terminals('47', '1') = 0.2146879365229255; terminals('47', '2') = 0.6584011192189714; terminals('47', '3') = 0.934292869889555; 
terminals('48', '1') = 0.8875088728280186; terminals('48', '2') = 0.33896544696051334; terminals('48', '3') = 0.12245657908898977; 
terminals('49', '1') = 0.8847447730266425; terminals('49', '2') = 0.17367256067587167; terminals('49', '3') = 0.11436194274577238; 
terminals('50', '1') = 0.8639623573896644; terminals('50', '2') = 0.24539318995207415; terminals('50', '3') = 0.07461734896541894; 
terminals('51', '1') = 0.2778297381300283; terminals('51', '2') = 0.1980328008888249; terminals('51', '3') = 0.8425919500193958; 
terminals('52', '1') = 0.5580812956477446; terminals('52', '2') = 0.995462931804964; terminals('52', '3') = 0.8262620088309451; 
terminals('53', '1') = 0.7890550166687313; terminals('53', '2') = 0.20263273045119756; terminals('53', '3') = 0.14216128827630636; 
terminals('54', '1') = 0.353617132049291; terminals('54', '2') = 0.42976371283164716; terminals('54', '3') = 0.026334996098281382; 
terminals('55', '1') = 0.1379201467239255; terminals('55', '2') = 0.36466870052232636; terminals('55', '3') = 0.1033753834242992; 
terminals('56', '1') = 0.8424598947360259; terminals('56', '2') = 0.20884518298650523; terminals('56', '3') = 0.0418548260366961; 
terminals('57', '1') = 0.6579927549021394; terminals('57', '2') = 0.11576904987382608; terminals('57', '3') = 0.6275368567557502; 
terminals('58', '1') = 0.08309199280096324; terminals('58', '2') = 0.18043134047291598; terminals('58', '3') = 0.433770760893037; 
terminals('59', '1') = 0.2379382497781386; terminals('59', '2') = 0.667917553709581; terminals('59', '3') = 0.5099988739260196; 
terminals('60', '1') = 0.14627253518239325; terminals('60', '2') = 0.4099582435171787; terminals('60', '3') = 0.026667886419665665; 
terminals('61', '1') = 0.8694883085708537; terminals('61', '2') = 0.059794237412003515; terminals('61', '3') = 0.19737624415030763; 
terminals('62', '1') = 0.37803326994191; terminals('62', '2') = 0.8716317274637382; terminals('62', '3') = 0.5712674252482745; 
terminals('63', '1') = 0.6817612042601433; terminals('63', '2') = 0.13875263597046006; terminals('63', '3') = 0.5107628919659647; 
terminals('64', '1') = 0.7947372749604221; terminals('64', '2') = 0.2664677863695891; terminals('64', '3') = 0.4575065052833681; 
terminals('65', '1') = 0.5365860866983987; terminals('65', '2') = 0.7723488686845005; terminals('65', '3') = 0.17954968254356618; 
terminals('66', '1') = 0.9705372890225207; terminals('66', '2') = 0.4663388395719823; terminals('66', '3') = 0.6387126800508606; 
terminals('67', '1') = 0.34903610101531923; terminals('67', '2') = 0.5769665478590327; terminals('67', '3') = 0.8097591099721857; 
terminals('68', '1') = 0.44336071360424933; terminals('68', '2') = 0.33510369513999516; terminals('68', '3') = 0.4518719580294468; 
terminals('69', '1') = 0.07454242955991419; terminals('69', '2') = 0.037362450270605696; terminals('69', '3') = 0.6933633923751588; 
terminals('70', '1') = 0.7318628693205405; terminals('70', '2') = 0.5452860810157873; terminals('70', '3') = 0.5340596610725818; 
terminals('71', '1') = 0.9278687154743063; terminals('71', '2') = 0.027224958101634722; terminals('71', '3') = 0.003714681636969086; 
terminals('72', '1') = 0.756126403491944; terminals('72', '2') = 0.8831291261206844; terminals('72', '3') = 0.8362380643253878; 
terminals('73', '1') = 0.41456434166874934; terminals('73', '2') = 0.18784440729984253; terminals('73', '3') = 0.3931041208498086; 
terminals('74', '1') = 0.18618824298733205; terminals('74', '2') = 0.781519105755495; terminals('74', '3') = 0.896036311828021; 
terminals('75', '1') = 0.783366001106419; terminals('75', '2') = 0.4358931061698528; terminals('75', '3') = 0.29152595782365187; 
terminals('76', '1') = 0.23785256239721797; terminals('76', '2') = 0.8062643189833972; terminals('76', '3') = 0.23963067071770328; 
terminals('77', '1') = 0.9935815630313618; terminals('77', '2') = 0.6225819274296315; terminals('77', '3') = 0.27752580171080077; 
terminals('78', '1') = 0.07427292851082634; terminals('78', '2') = 0.35505359721297014; terminals('78', '3') = 0.6614014422098611; 
terminals('79', '1') = 0.4484018472103911; terminals('79', '2') = 0.6495445950237938; terminals('79', '3') = 0.614160424867544; 
terminals('80', '1') = 0.32408799273232514; terminals('80', '2') = 0.4580722957033724; terminals('80', '3') = 0.24415162128172618; 
terminals('81', '1') = 0.7734756658378116; terminals('81', '2') = 0.30878069406633013; terminals('81', '3') = 0.41150038438676795; 
terminals('82', '1') = 0.2664092724667131; terminals('82', '2') = 0.48774320961169704; terminals('82', '3') = 0.9025650875648172; 
terminals('83', '1') = 0.7279302346429056; terminals('83', '2') = 0.5968300504704068; terminals('83', '3') = 0.6414838280798081; 
terminals('84', '1') = 0.06806845922946114; terminals('84', '2') = 0.005237072063318804; terminals('84', '3') = 0.686047904084002; 
terminals('85', '1') = 0.8042187300421939; terminals('85', '2') = 0.7486103806021185; terminals('85', '3') = 0.18270875051026747; 
terminals('86', '1') = 0.27096960012682636; terminals('86', '2') = 0.46220800496042225; terminals('86', '3') = 0.5001306643082006; 
terminals('87', '1') = 0.03743540593511441; terminals('87', '2') = 0.8658953000377115; terminals('87', '3') = 0.268083794781919; 
terminals('88', '1') = 0.22312502063999762; terminals('88', '2') = 0.6764708741712568; terminals('88', '3') = 0.7859764425429325; 
terminals('89', '1') = 0.6129001191079219; terminals('89', '2') = 0.905221976379222; terminals('89', '3') = 0.05099511636587939; 
terminals('90', '1') = 0.6499931357351285; terminals('90', '2') = 0.34357959519722825; terminals('90', '3') = 0.0064213029960530355; 
terminals('91', '1') = 0.9209942072140298; terminals('91', '2') = 0.051908313990966515; terminals('91', '3') = 0.6462120790652132; 
terminals('92', '1') = 0.7700954557045856; terminals('92', '2') = 0.6735049006046687; terminals('92', '3') = 0.425890973303204; 
terminals('93', '1') = 0.2564935751862454; terminals('93', '2') = 0.9680846683989781; terminals('93', '3') = 0.5025616486408909; 
terminals('94', '1') = 0.8957419361696505; terminals('94', '2') = 0.3242218415634609; terminals('94', '3') = 0.6445791926317075; 
terminals('95', '1') = 0.7545835793310753; terminals('95', '2') = 0.36169258954200956; terminals('95', '3') = 0.6505416752325107; 
terminals('96', '1') = 0.42990640570887106; terminals('96', '2') = 0.837659028367405; terminals('96', '3') = 0.7931315053484098; 
terminals('97', '1') = 0.7204567876163184; terminals('97', '2') = 0.42858641649328355; terminals('97', '3') = 0.5326892539026361; 
terminals('98', '1') = 0.5330098091059104; terminals('98', '2') = 0.3486731178167889; terminals('98', '3') = 0.4523439770644121; 
terminals('99', '1') = 0.17231767283810528; terminals('99', '2') = 0.19650893538928405; terminals('99', '3') = 0.9231826357043336; 
terminals('100', '1') = 0.0410411863971919; terminals('100', '2') = 0.2624698466489752; terminals('100', '3') = 0.9090327904112879; 
terminals('101', '1') = 0.7640748773463171; terminals('101', '2') = 0.33418276992066076; terminals('101', '3') = 0.5202993240297564; 
terminals('102', '1') = 0.6529767875289471; terminals('102', '2') = 0.32732230594050993; terminals('102', '3') = 0.32630520738996793; 
terminals('103', '1') = 0.7433587465137194; terminals('103', '2') = 0.9725019051290282; terminals('103', '3') = 0.31501970314381034; 
terminals('104', '1') = 0.19793068101128586; terminals('104', '2') = 0.013762060935493925; terminals('104', '3') = 0.18475634713153088; 
terminals('105', '1') = 0.6247019459747487; terminals('105', '2') = 0.43866452371237585; terminals('105', '3') = 0.1710116561819658; 
Parameter bigM / 1.7320508075688772 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
