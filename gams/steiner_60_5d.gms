Sets
i Steiner points / 1*58 /
j terminals / 1*60 /
k dimensions / 1*5 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.597695785436328; terminals('1', '2') = 0.34470985805607846; terminals('1', '3') = 0.0014948955961350263; terminals('1', '4') = 0.34644230104244766; terminals('1', '5') = 0.8231592394186235; 
terminals('2', '1') = 0.4234487978528678; terminals('2', '2') = 0.5798322570749889; terminals('2', '3') = 0.1617117533235204; terminals('2', '4') = 0.4276568914332569; terminals('2', '5') = 0.3681985778442377; 
terminals('3', '1') = 0.13856011354634767; terminals('3', '2') = 0.24634144355453158; terminals('3', '3') = 0.09431701076677956; terminals('3', '4') = 0.868607875688253; terminals('3', '5') = 0.502801602882417; 
terminals('4', '1') = 0.515209361287574; terminals('4', '2') = 0.7720427963713802; terminals('4', '3') = 0.6903486778264591; terminals('4', '4') = 0.29679493077185015; terminals('4', '5') = 0.8863766315621865; 
terminals('5', '1') = 0.5567402099933806; terminals('5', '2') = 0.9570424743646248; terminals('5', '3') = 0.27456842046514995; terminals('5', '4') = 0.3504006640542493; terminals('5', '5') = 0.06634976569444284; 
terminals('6', '1') = 0.8043441927958421; terminals('6', '2') = 0.624213086094751; terminals('6', '3') = 0.8090645433915804; terminals('6', '4') = 0.37610726283322515; terminals('6', '5') = 0.9190484715554607; 
terminals('7', '1') = 0.7514536440678731; terminals('7', '2') = 0.8142098625941552; terminals('7', '3') = 0.034550127304391554; terminals('7', '4') = 0.8230522436861117; terminals('7', '5') = 0.9543020952324273; 
terminals('8', '1') = 0.7318317628070753; terminals('8', '2') = 0.44425555358804625; terminals('8', '3') = 0.6181460313483801; terminals('8', '4') = 0.27113307027164457; terminals('8', '5') = 0.1964170909116787; 
terminals('9', '1') = 0.8925822888928249; terminals('9', '2') = 0.6413312455688978; terminals('9', '3') = 0.8759989022824013; terminals('9', '4') = 0.23811107617387905; terminals('9', '5') = 0.40902962675743715; 
terminals('10', '1') = 0.8208718842244949; terminals('10', '2') = 0.140632896053851; terminals('10', '3') = 0.5210392052492984; terminals('10', '4') = 0.45431348255525883; terminals('10', '5') = 0.23960463978184365; 
terminals('11', '1') = 0.7528747140438925; terminals('11', '2') = 0.6583989161122579; terminals('11', '3') = 0.4018100287879508; terminals('11', '4') = 0.763285413342082; terminals('11', '5') = 0.9773434757860888; 
terminals('12', '1') = 0.08979170636811717; terminals('12', '2') = 0.9964554833281549; terminals('12', '3') = 0.2679787104896667; terminals('12', '4') = 0.43122236171110684; terminals('12', '5') = 0.2087415352082047; 
terminals('13', '1') = 0.05240804896669082; terminals('13', '2') = 0.5653338534469133; terminals('13', '3') = 0.11871018639478648; terminals('13', '4') = 0.5974473734813828; terminals('13', '5') = 0.9355894950951215; 
terminals('14', '1') = 0.814300865147692; terminals('14', '2') = 0.1762007467936424; terminals('14', '3') = 0.19446569634469646; terminals('14', '4') = 0.8600414496110657; terminals('14', '5') = 0.5171982956816455; 
terminals('15', '1') = 0.9940427955350924; terminals('15', '2') = 0.3625180989248916; terminals('15', '3') = 0.5756247624804108; terminals('15', '4') = 0.40145873782017305; terminals('15', '5') = 0.08788719383446764; 
terminals('16', '1') = 0.4933373919628634; terminals('16', '2') = 0.5132903667477089; terminals('16', '3') = 0.37994787111326633; terminals('16', '4') = 0.9926117456668142; terminals('16', '5') = 0.7078894465773453; 
terminals('17', '1') = 0.18630759749605708; terminals('17', '2') = 0.005110029565635554; terminals('17', '3') = 0.09009681037413297; terminals('17', '4') = 0.15136177871731227; terminals('17', '5') = 0.12171006866964296; 
terminals('18', '1') = 0.059350822048968355; terminals('18', '2') = 0.7797343541831645; terminals('18', '3') = 0.3087414938822328; terminals('18', '4') = 0.36103676660415374; terminals('18', '5') = 0.39526562292142553; 
terminals('19', '1') = 0.44739154283058846; terminals('19', '2') = 0.34158322078993375; terminals('19', '3') = 0.520084797499494; terminals('19', '4') = 0.5734046279213453; terminals('19', '5') = 0.2929306302849558; 
terminals('20', '1') = 0.5038577216539759; terminals('20', '2') = 0.15463420706036968; terminals('20', '3') = 0.2061202858270046; terminals('20', '4') = 0.329122408789823; terminals('20', '5') = 0.33851490148706775; 
terminals('21', '1') = 0.3088247786420585; terminals('21', '2') = 0.5118022204736253; terminals('21', '3') = 0.6919029525952217; terminals('21', '4') = 0.5794065426383467; terminals('21', '5') = 0.12216395635330601; 
terminals('22', '1') = 0.007712319099515752; terminals('22', '2') = 0.1887925180867277; terminals('22', '3') = 0.1814898386124142; terminals('22', '4') = 0.7958765353562254; terminals('22', '5') = 0.825028685262716; 
terminals('23', '1') = 0.18838633420621476; terminals('23', '2') = 0.8038238131053906; terminals('23', '3') = 0.8670083486657468; terminals('23', '4') = 0.6493552569520836; terminals('23', '5') = 0.5667793294208547; 
terminals('24', '1') = 0.3372438083958599; terminals('24', '2') = 0.6163641429982302; terminals('24', '3') = 0.2634115754696088; terminals('24', '4') = 0.3501100608337441; terminals('24', '5') = 0.6773912577357261; 
terminals('25', '1') = 0.24951216307422686; terminals('25', '2') = 0.9207056971592346; terminals('25', '3') = 0.31771762922360336; terminals('25', '4') = 0.1076117675812649; terminals('25', '5') = 0.6084945336489838; 
terminals('26', '1') = 0.27122771189203077; terminals('26', '2') = 0.4179885186392982; terminals('26', '3') = 0.552297855392181; terminals('26', '4') = 0.1965845289487057; terminals('26', '5') = 0.1936926111390328; 
terminals('27', '1') = 0.6733420356542161; terminals('27', '2') = 0.9157586153755746; terminals('27', '3') = 0.0920105994549244; terminals('27', '4') = 0.10355481522167032; terminals('27', '5') = 0.12166667837656642; 
terminals('28', '1') = 0.10313149832812141; terminals('28', '2') = 0.05046336445000943; terminals('28', '3') = 0.6249430336359172; terminals('28', '4') = 0.5083793566445037; terminals('28', '5') = 0.2757277402490018; 
terminals('29', '1') = 0.36936228207449384; terminals('29', '2') = 0.4162270507111955; terminals('29', '3') = 0.3358390112334739; terminals('29', '4') = 0.7528003667624256; terminals('29', '5') = 0.10521164844804232; 
terminals('30', '1') = 0.3666098739089433; terminals('30', '2') = 0.46050423630427306; terminals('30', '3') = 0.1150352709284993; terminals('30', '4') = 0.43102224992080296; terminals('30', '5') = 0.199583130723065; 
terminals('31', '1') = 0.6946438679891902; terminals('31', '2') = 0.09651100553147474; terminals('31', '3') = 0.20212452221551314; terminals('31', '4') = 0.13621223865255927; terminals('31', '5') = 0.07687838689373772; 
terminals('32', '1') = 0.5849820467903301; terminals('32', '2') = 0.2137019534817548; terminals('32', '3') = 0.8347123073610441; terminals('32', '4') = 0.4950002221727162; terminals('32', '5') = 0.015683627130405497; 
terminals('33', '1') = 0.33245978327624015; terminals('33', '2') = 0.9733363599553658; terminals('33', '3') = 0.7893169627227343; terminals('33', '4') = 0.9188065617877832; terminals('33', '5') = 0.14610557636988042; 
terminals('34', '1') = 0.120777454045913; terminals('34', '2') = 0.12976250805371692; terminals('34', '3') = 0.6992440865622285; terminals('34', '4') = 0.8789431663103869; terminals('34', '5') = 0.09429210615326666; 
terminals('35', '1') = 0.08422892356931566; terminals('35', '2') = 0.5058369060788419; terminals('35', '3') = 0.2808975736794236; terminals('35', '4') = 0.39132372045650876; terminals('35', '5') = 0.42041025277604693; 
terminals('36', '1') = 0.9645191167669127; terminals('36', '2') = 0.24272899491962663; terminals('36', '3') = 0.7385130849027715; terminals('36', '4') = 0.19706696259282463; terminals('36', '5') = 0.5504743108052043; 
terminals('37', '1') = 0.47854835985386945; terminals('37', '2') = 0.04116648477297902; terminals('37', '3') = 0.9448899171944772; terminals('37', '4') = 0.6757469776966195; terminals('37', '5') = 0.5755985153080424; 
terminals('38', '1') = 0.9515012058355757; terminals('38', '2') = 0.6292529617078676; terminals('38', '3') = 0.08888188811843878; terminals('38', '4') = 0.3383049090834165; terminals('38', '5') = 0.2200004025371579; 
terminals('39', '1') = 0.989003099780171; terminals('39', '2') = 0.9206621280429614; terminals('39', '3') = 0.7190408108278755; terminals('39', '4') = 0.8289492161190546; terminals('39', '5') = 0.49348383021401787; 
terminals('40', '1') = 0.07422103581368578; terminals('40', '2') = 0.9807890235032546; terminals('40', '3') = 0.8002319605004442; terminals('40', '4') = 0.9176126261964174; terminals('40', '5') = 0.7596680384666387; 
terminals('41', '1') = 0.39934804695826154; terminals('41', '2') = 0.5982621507853706; terminals('41', '3') = 0.10789131040356037; terminals('41', '4') = 0.9489862633105849; terminals('41', '5') = 0.8425382576770594; 
terminals('42', '1') = 0.22556113037444636; terminals('42', '2') = 0.6008142947485328; terminals('42', '3') = 0.2327306816179534; terminals('42', '4') = 0.40063224093101435; terminals('42', '5') = 0.6346616461595865; 
terminals('43', '1') = 0.30295764401149416; terminals('43', '2') = 0.4687874427629085; terminals('43', '3') = 0.9328262433289826; terminals('43', '4') = 0.8879502503676585; terminals('43', '5') = 0.7808313195045674; 
terminals('44', '1') = 0.8590704998739436; terminals('44', '2') = 0.26857423382143364; terminals('44', '3') = 0.5936915172720184; terminals('44', '4') = 0.6087282828910563; terminals('44', '5') = 0.9455637767971785; 
terminals('45', '1') = 0.040082551678211176; terminals('45', '2') = 0.7426356149858612; terminals('45', '3') = 0.6496777789819248; terminals('45', '4') = 0.5390483648431735; terminals('45', '5') = 0.4737524838264593; 
terminals('46', '1') = 0.5852924686853002; terminals('46', '2') = 0.7921299562929092; terminals('46', '3') = 0.4358883509865745; terminals('46', '4') = 0.6876733186225046; terminals('46', '5') = 0.3386128294678612; 
terminals('47', '1') = 0.9121849896554373; terminals('47', '2') = 0.6138801578324856; terminals('47', '3') = 0.8749892229132721; terminals('47', '4') = 0.33455598288719224; terminals('47', '5') = 0.8871116426964045; 
terminals('48', '1') = 0.46507297818099813; terminals('48', '2') = 0.9607003836215556; terminals('48', '3') = 0.808280822929898; terminals('48', '4') = 0.11698181600312996; terminals('48', '5') = 0.4740323538896819; 
terminals('49', '1') = 0.40133398105792484; terminals('49', '2') = 0.24098524420440803; terminals('49', '3') = 0.29783536729825244; terminals('49', '4') = 0.05698826634171805; terminals('49', '5') = 0.9829546378271825; 
terminals('50', '1') = 0.15425785665958947; terminals('50', '2') = 0.8843863434021694; terminals('50', '3') = 0.7293479197052644; terminals('50', '4') = 0.2929214764471929; terminals('50', '5') = 0.2984705693960532; 
terminals('51', '1') = 0.8367712110941293; terminals('51', '2') = 0.4127655879789436; terminals('51', '3') = 0.14384964451667337; terminals('51', '4') = 0.4529106543263479; terminals('51', '5') = 0.613380729734017; 
terminals('52', '1') = 0.00017669745584614205; terminals('52', '2') = 0.6267080714537627; terminals('52', '3') = 0.1640743241630518; terminals('52', '4') = 0.5453958138476077; terminals('52', '5') = 0.7883040338764614; 
terminals('53', '1') = 0.7970353302472426; terminals('53', '2') = 0.25280919680463254; terminals('53', '3') = 0.8074383771905411; terminals('53', '4') = 0.4197086193481486; terminals('53', '5') = 0.3996644973772976; 
terminals('54', '1') = 0.5448756795845553; terminals('54', '2') = 0.36750154708313687; terminals('54', '3') = 0.49580559307368177; terminals('54', '4') = 0.9421383236727287; terminals('54', '5') = 0.795017926246254; 
terminals('55', '1') = 0.324085722983516; terminals('55', '2') = 0.07382492496536497; terminals('55', '3') = 0.7558368597763796; terminals('55', '4') = 0.028299575078949424; terminals('55', '5') = 0.5562210480970813; 
terminals('56', '1') = 0.6028072017869184; terminals('56', '2') = 0.9401402413867695; terminals('56', '3') = 0.705904864262011; terminals('56', '4') = 0.7870086511934399; terminals('56', '5') = 0.5431613797763526; 
terminals('57', '1') = 0.45165980408959605; terminals('57', '2') = 0.45875130829081523; terminals('57', '3') = 0.9644086214259043; terminals('57', '4') = 0.020201800170993822; terminals('57', '5') = 0.6949802025996252; 
terminals('58', '1') = 0.19915223180897146; terminals('58', '2') = 0.43666694183631904; terminals('58', '3') = 0.48007858919335444; terminals('58', '4') = 0.12306365807901687; terminals('58', '5') = 0.1257266768702906; 
terminals('59', '1') = 0.6447044427389538; terminals('59', '2') = 0.9715671691258342; terminals('59', '3') = 0.11923054533538191; terminals('59', '4') = 0.2547884636234794; terminals('59', '5') = 0.5529030685693919; 
terminals('60', '1') = 0.4256249820591753; terminals('60', '2') = 0.18046765824613453; terminals('60', '3') = 0.6854413426093217; terminals('60', '4') = 0.6177652506681348; terminals('60', '5') = 0.3656319294336231; 
Parameter bigM / 2.23606797749979 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
