Sets
i Steiner points / 1*113 /
j terminals / 1*115 /
k dimensions / 1*2 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.7049957376854643; terminals('1', '2') = 0.3019379066328314; 
terminals('2', '1') = 0.9392214396962638; terminals('2', '2') = 0.8852855911634174; 
terminals('3', '1') = 0.5370248557384224; terminals('3', '2') = 0.6594688254210057; 
terminals('4', '1') = 0.7659074815143688; terminals('4', '2') = 0.48708361858493376; 
terminals('5', '1') = 0.908087699720106; terminals('5', '2') = 0.873669404396974; 
terminals('6', '1') = 0.8728997216231232; terminals('6', '2') = 0.6227367259738712; 
terminals('7', '1') = 0.7625539023829796; terminals('7', '2') = 0.9858813778313371; 
terminals('8', '1') = 0.001048619675279805; terminals('8', '2') = 0.6861343585655213; 
terminals('9', '1') = 0.8250939711031317; terminals('9', '2') = 0.02370278025929573; 
terminals('10', '1') = 0.7726391827379931; terminals('10', '2') = 0.3111830190836872; 
terminals('11', '1') = 0.9175374893431733; terminals('11', '2') = 0.12746636328749095; 
terminals('12', '1') = 0.47665499825931523; terminals('12', '2') = 0.5641669808830506; 
terminals('13', '1') = 0.5737717185401939; terminals('13', '2') = 0.28647197283285153; 
terminals('14', '1') = 0.03900264961823374; terminals('14', '2') = 0.9693362419679844; 
terminals('15', '1') = 0.31488882664494555; terminals('15', '2') = 0.7186450547525113; 
terminals('16', '1') = 0.5065914535775219; terminals('16', '2') = 0.30116879184811274; 
terminals('17', '1') = 0.22556380367561457; terminals('17', '2') = 0.4545091345719039; 
terminals('18', '1') = 0.9119293624046447; terminals('18', '2') = 0.6338542670305406; 
terminals('19', '1') = 0.4111708137816521; terminals('19', '2') = 0.43980768791647795; 
terminals('20', '1') = 0.8213316256374865; terminals('20', '2') = 0.8496743539204696; 
terminals('21', '1') = 0.0009004642348374725; terminals('21', '2') = 0.28054792296404996; 
terminals('22', '1') = 0.6765524027493269; terminals('22', '2') = 0.145769266843625; 
terminals('23', '1') = 0.42437292587296294; terminals('23', '2') = 0.8157620743047401; 
terminals('24', '1') = 0.8186711668310548; terminals('24', '2') = 0.8247844135047488; 
terminals('25', '1') = 0.11077641343222622; terminals('25', '2') = 0.18660305937883626; 
terminals('26', '1') = 0.5373075832023134; terminals('26', '2') = 0.15559942865728116; 
terminals('27', '1') = 0.8963063779801194; terminals('27', '2') = 0.10357755589799678; 
terminals('28', '1') = 0.2867966107596225; terminals('28', '2') = 0.9221361035563954; 
terminals('29', '1') = 0.0459571714550433; terminals('29', '2') = 0.39525356750402674; 
terminals('30', '1') = 0.6174203124302381; terminals('30', '2') = 0.5532239827341003; 
terminals('31', '1') = 0.9721682841352863; terminals('31', '2') = 0.5361380002452649; 
terminals('32', '1') = 0.8144270978377642; terminals('32', '2') = 0.2879000794327373; 
terminals('33', '1') = 0.1421324299065958; terminals('33', '2') = 0.36151571256124004; 
terminals('34', '1') = 0.6086710194939878; terminals('34', '2') = 0.6141324259186126; 
terminals('35', '1') = 0.5049653109762963; terminals('35', '2') = 0.31550862601596175; 
terminals('36', '1') = 0.8957888280044546; terminals('36', '2') = 0.18858031545202303; 
terminals('37', '1') = 0.46687516188601164; terminals('37', '2') = 0.26285283901784395; 
terminals('38', '1') = 0.17923114987188282; terminals('38', '2') = 0.12340389040458832; 
terminals('39', '1') = 0.7935630317561815; terminals('39', '2') = 0.10952762112038317; 
terminals('40', '1') = 0.6866865163030147; terminals('40', '2') = 0.15006811329321834; 
terminals('41', '1') = 0.8941134658358385; terminals('41', '2') = 0.8765491078060003; 
terminals('42', '1') = 0.5349103340812331; terminals('42', '2') = 0.7620793643114481; 
terminals('43', '1') = 0.6958220385837135; terminals('43', '2') = 0.9236805595895501; 
terminals('44', '1') = 0.8000323303264815; terminals('44', '2') = 0.7033288583351802; 
terminals('45', '1') = 0.3075418778190794; terminals('45', '2') = 0.8880567051151887; 
terminals('46', '1') = 0.6919053273153278; terminals('46', '2') = 0.30178370510423536; 
terminals('47', '1') = 0.3543712857120881; terminals('47', '2') = 0.8130425261528943; 
terminals('48', '1') = 0.48645051119727145; terminals('48', '2') = 0.8833305626708107; 
terminals('49', '1') = 0.20907926946725353; terminals('49', '2') = 0.7762938205277023; 
terminals('50', '1') = 0.41462865453933284; terminals('50', '2') = 0.39200566789059876; 
terminals('51', '1') = 0.40791116048449605; terminals('51', '2') = 0.49021573377056693; 
terminals('52', '1') = 0.695657035098389; terminals('52', '2') = 0.10294166505041913; 
terminals('53', '1') = 0.6772565776108271; terminals('53', '2') = 0.3961854071089185; 
terminals('54', '1') = 0.9257749277697688; terminals('54', '2') = 0.5694330196515569; 
terminals('55', '1') = 0.8008967809128145; terminals('55', '2') = 0.1704540860986774; 
terminals('56', '1') = 0.12112901018067534; terminals('56', '2') = 0.62382259740705; 
terminals('57', '1') = 0.6060938710445888; terminals('57', '2') = 0.07812138594010587; 
terminals('58', '1') = 0.042613730559549645; terminals('58', '2') = 0.6298896197586644; 
terminals('59', '1') = 0.14933314983353718; terminals('59', '2') = 0.9419117028944233; 
terminals('60', '1') = 0.09180817373274874; terminals('60', '2') = 0.9583951452299798; 
terminals('61', '1') = 0.9171157043313053; terminals('61', '2') = 0.9751854994662659; 
terminals('62', '1') = 0.4120947776665612; terminals('62', '2') = 0.4278208245200803; 
terminals('63', '1') = 0.5310657947505546; terminals('63', '2') = 0.7167863521853415; 
terminals('64', '1') = 0.7341852805055681; terminals('64', '2') = 0.39391046754196457; 
terminals('65', '1') = 0.30062831536817913; terminals('65', '2') = 0.6833260391375365; 
terminals('66', '1') = 0.07029157387196161; terminals('66', '2') = 0.7810072146342389; 
terminals('67', '1') = 0.736116531429118; terminals('67', '2') = 0.37493810869289856; 
terminals('68', '1') = 0.48455315972444135; terminals('68', '2') = 0.755062182087996; 
terminals('69', '1') = 0.3175249473829954; terminals('69', '2') = 0.6024925011818505; 
terminals('70', '1') = 0.8904120755934981; terminals('70', '2') = 0.5224669426808538; 
terminals('71', '1') = 0.8942048622819694; terminals('71', '2') = 0.07522347567414689; 
terminals('72', '1') = 0.43714456412209024; terminals('72', '2') = 0.4542393592287759; 
terminals('73', '1') = 0.12673786943987397; terminals('73', '2') = 0.3968520729904279; 
terminals('74', '1') = 0.858045786873679; terminals('74', '2') = 0.5354505544787818; 
terminals('75', '1') = 0.17374755041029055; terminals('75', '2') = 0.7176034481352542; 
terminals('76', '1') = 0.8832925727385477; terminals('76', '2') = 0.42811330382319623; 
terminals('77', '1') = 0.3700443932676628; terminals('77', '2') = 0.7885701033939421; 
terminals('78', '1') = 0.6438446071988793; terminals('78', '2') = 0.21317457784937355; 
terminals('79', '1') = 0.20214577677223322; terminals('79', '2') = 0.434277766793873; 
terminals('80', '1') = 0.19143136645749614; terminals('80', '2') = 0.18997369280066279; 
terminals('81', '1') = 0.9980030140320612; terminals('81', '2') = 0.867905969253516; 
terminals('82', '1') = 0.9846693043941829; terminals('82', '2') = 0.18591959819167336; 
terminals('83', '1') = 0.49268937835301296; terminals('83', '2') = 0.5231545784768733; 
terminals('84', '1') = 0.02057157895425099; terminals('84', '2') = 0.34435586922249006; 
terminals('85', '1') = 0.1343025875379128; terminals('85', '2') = 0.7044371118161672; 
terminals('86', '1') = 0.24508713603628085; terminals('86', '2') = 0.21592924570413563; 
terminals('87', '1') = 0.16859450586205504; terminals('87', '2') = 0.975215564842566; 
terminals('88', '1') = 0.130626903235324; terminals('88', '2') = 0.4757444319712921; 
terminals('89', '1') = 0.5171973665034179; terminals('89', '2') = 0.9313314016755362; 
terminals('90', '1') = 0.5109555103127302; terminals('90', '2') = 0.16351135233000635; 
terminals('91', '1') = 0.9235741266467273; terminals('91', '2') = 0.336572159579976; 
terminals('92', '1') = 0.7348575484318023; terminals('92', '2') = 0.9828707318369733; 
terminals('93', '1') = 0.5561887323853006; terminals('93', '2') = 0.2862719520717809; 
terminals('94', '1') = 0.6431244513643606; terminals('94', '2') = 0.027326113330337187; 
terminals('95', '1') = 0.4609777910627183; terminals('95', '2') = 0.6303967536359513; 
terminals('96', '1') = 0.8566143670168748; terminals('96', '2') = 0.03506682283455054; 
terminals('97', '1') = 0.9826327784817496; terminals('97', '2') = 0.19229292836316247; 
terminals('98', '1') = 0.024468453855256866; terminals('98', '2') = 0.5622270625926371; 
terminals('99', '1') = 0.844197847509112; terminals('99', '2') = 0.5136051188366192; 
terminals('100', '1') = 0.5137429968150957; terminals('100', '2') = 0.2693257644518644; 
terminals('101', '1') = 0.642775123699864; terminals('101', '2') = 0.660301520904269; 
terminals('102', '1') = 0.5600096942306342; terminals('102', '2') = 0.9533729031212158; 
terminals('103', '1') = 0.15075141431408667; terminals('103', '2') = 0.05317148670784888; 
terminals('104', '1') = 0.5116186450903304; terminals('104', '2') = 0.6453472191696182; 
terminals('105', '1') = 0.05509404542543106; terminals('105', '2') = 0.38314312889203817; 
terminals('106', '1') = 0.012320123042143138; terminals('106', '2') = 0.4577341223895899; 
terminals('107', '1') = 0.27150593932134726; terminals('107', '2') = 0.2548129057162887; 
terminals('108', '1') = 0.8544179903930239; terminals('108', '2') = 0.6618753753210993; 
terminals('109', '1') = 0.8191870966935599; terminals('109', '2') = 0.9215956505735355; 
terminals('110', '1') = 0.02466723944456095; terminals('110', '2') = 0.1117861613227975; 
terminals('111', '1') = 0.08921470359726169; terminals('111', '2') = 0.16532268522797433; 
terminals('112', '1') = 0.3264842637579761; terminals('112', '2') = 0.815888708980503; 
terminals('113', '1') = 0.34742849388715713; terminals('113', '2') = 0.7065832798672946; 
terminals('114', '1') = 0.966204762934649; terminals('114', '2') = 0.32763712823568525; 
terminals('115', '1') = 0.9203531892797068; terminals('115', '2') = 0.7371868257782855; 
Parameter bigM / 1.4142135623730951 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
