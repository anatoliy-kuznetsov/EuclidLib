Sets
i clusters / 1*3 /
j data points / 1*100 /
k dimensions / 1*4 /;
Parameters data(j,k);
data('1', '1') = 0.24964211601093333; data('1', '2') = 0.3419590073492983; data('1', '3') = 0.7844078180262489; data('1', '4') = 0.8980095182941011; 
data('2', '1') = 0.9906481936698904; data('2', '2') = 0.7326615728808904; data('2', '3') = 0.47742971889426833; data('2', '4') = 0.9882689530295113; 
data('3', '1') = 0.878674436758325; data('3', '2') = 0.8431219933716559; data('3', '3') = 0.7444675322325479; data('3', '4') = 0.8947995704886033; 
data('4', '1') = 0.39792123548266745; data('4', '2') = 0.6943903328975947; data('4', '3') = 0.9638520040807107; data('4', '4') = 0.6532203052778046; 
data('5', '1') = 0.879929692712279; data('5', '2') = 0.9142412852129281; data('5', '3') = 0.14924380524780467; data('5', '4') = 0.15875028215543574; 
data('6', '1') = 0.7558521689801087; data('6', '2') = 0.96937066026867; data('6', '3') = 0.5839777272740031; data('6', '4') = 0.7969501600511153; 
data('7', '1') = 0.7347051533854345; data('7', '2') = 0.4635465370161904; data('7', '3') = 0.8127541278993364; data('7', '4') = 0.7589024492589898; 
data('8', '1') = 0.9688344853141951; data('8', '2') = 0.7464932815830481; data('8', '3') = 0.003186774181423324; data('8', '4') = 0.6772369828565289; 
data('9', '1') = 0.793653083717306; data('9', '2') = 0.7282246749807411; data('9', '3') = 0.29096822481565987; data('9', '4') = 0.35061900722179007; 
data('10', '1') = 0.3650927737246753; data('10', '2') = 0.8743012218695156; data('10', '3') = 0.6610116252637358; data('10', '4') = 0.9720383560062695; 
data('11', '1') = 0.11857317643292264; data('11', '2') = 0.5098381463134666; data('11', '3') = 0.8563940821071722; data('11', '4') = 0.41396821296440467; 
data('12', '1') = 0.9450588067897289; data('12', '2') = 0.5581578220274473; data('12', '3') = 0.5424289764585019; data('12', '4') = 0.6928432540969558; 
data('13', '1') = 0.4821759178166901; data('13', '2') = 0.7629902918678263; data('13', '3') = 0.5641475698152943; data('13', '4') = 0.746729687941132; 
data('14', '1') = 0.1051561315969578; data('14', '2') = 0.16782602220716114; data('14', '3') = 0.07646679656792221; data('14', '4') = 0.695001715764455; 
data('15', '1') = 0.9182186207603192; data('15', '2') = 0.735881375421758; data('15', '3') = 0.7213080103672908; data('15', '4') = 0.516683896129738; 
data('16', '1') = 0.7050551882909638; data('16', '2') = 0.3867088356880074; data('16', '3') = 0.45777136543270736; data('16', '4') = 0.9392949719785977; 
data('17', '1') = 0.6458967297664209; data('17', '2') = 0.3677351639713521; data('17', '3') = 0.33278259039968205; data('17', '4') = 0.3245964507574538; 
data('18', '1') = 0.47958996099068096; data('18', '2') = 0.13675416326859657; data('18', '3') = 0.5053244185597753; data('18', '4') = 0.0713446376543656; 
data('19', '1') = 0.15374285136226773; data('19', '2') = 0.3564271741066143; data('19', '3') = 0.7338285906513359; data('19', '4') = 0.37327140983569274; 
data('20', '1') = 0.5979369666516147; data('20', '2') = 0.6198492487129784; data('20', '3') = 0.10349032792098445; data('20', '4') = 0.10017095265374099; 
data('21', '1') = 0.3529369856530412; data('21', '2') = 0.8764108434001858; data('21', '3') = 0.25901225657379046; data('21', '4') = 0.9352790003379323; 
data('22', '1') = 0.2748015475947406; data('22', '2') = 0.7176302625191807; data('22', '3') = 0.2438746811226472; data('22', '4') = 0.6040784578069498; 
data('23', '1') = 0.17938272542204714; data('23', '2') = 0.38283303612264885; data('23', '3') = 0.6940327920024909; data('23', '4') = 0.9252059090045701; 
data('24', '1') = 0.445419775127494; data('24', '2') = 0.21848522689855698; data('24', '3') = 0.9249830911190758; data('24', '4') = 0.041725076906418246; 
data('25', '1') = 0.2690096255269243; data('25', '2') = 0.8663058377192763; data('25', '3') = 0.6606299559632439; data('25', '4') = 0.8792065077623004; 
data('26', '1') = 0.8453599730102289; data('26', '2') = 0.3842106658773424; data('26', '3') = 0.8604514302271566; data('26', '4') = 0.3525936990974051; 
data('27', '1') = 0.32857756535672134; data('27', '2') = 0.7334509183341946; data('27', '3') = 0.8983960670015203; data('27', '4') = 0.38626315586131477; 
data('28', '1') = 0.387610966379205; data('28', '2') = 0.5564208703602945; data('28', '3') = 0.3715036453977122; data('28', '4') = 0.48133382594817853; 
data('29', '1') = 0.7772976052252489; data('29', '2') = 0.2985490119048263; data('29', '3') = 0.9388694952604955; data('29', '4') = 0.4705205737979742; 
data('30', '1') = 0.967667304325787; data('30', '2') = 0.6681893257652537; data('30', '3') = 0.39836925905485454; data('30', '4') = 0.2128045679697267; 
data('31', '1') = 0.1003844026114612; data('31', '2') = 0.06988208009742414; data('31', '3') = 0.5660724747791598; data('31', '4') = 0.49681482967935164; 
data('32', '1') = 0.5025696134250661; data('32', '2') = 0.4406022649004441; data('32', '3') = 0.9640458629916471; data('32', '4') = 0.6755819991424467; 
data('33', '1') = 0.6079930270271675; data('33', '2') = 0.8229436440461317; data('33', '3') = 0.1720414683789765; data('33', '4') = 0.9570171659063009; 
data('34', '1') = 0.6143003449233442; data('34', '2') = 0.46797578776836557; data('34', '3') = 0.11380625741060058; data('34', '4') = 0.850797580547296; 
data('35', '1') = 0.827981638726401; data('35', '2') = 0.07954042483888257; data('35', '3') = 0.01680442249315217; data('35', '4') = 0.8358542825777697; 
data('36', '1') = 0.638728212928766; data('36', '2') = 0.1890580846177755; data('36', '3') = 0.4323301757323722; data('36', '4') = 0.612343913248689; 
data('37', '1') = 0.8665054187135142; data('37', '2') = 0.6845050451824157; data('37', '3') = 0.23423526491011515; data('37', '4') = 0.2210767325507148; 
data('38', '1') = 0.5491987365123153; data('38', '2') = 0.007751236999143818; data('38', '3') = 0.5969443488095496; data('38', '4') = 0.9802131870885314; 
data('39', '1') = 0.1121271337845755; data('39', '2') = 0.8154235467169008; data('39', '3') = 0.6071728332788353; data('39', '4') = 0.8775136969944712; 
data('40', '1') = 0.5732876192647763; data('40', '2') = 0.7273747273409799; data('40', '3') = 0.5517332762204428; data('40', '4') = 0.1351426714674251; 
data('41', '1') = 0.8086647204865384; data('41', '2') = 0.6407098237305914; data('41', '3') = 0.6210964128069524; data('41', '4') = 0.44992259520975386; 
data('42', '1') = 0.46738864751588893; data('42', '2') = 0.16919548510060445; data('42', '3') = 0.0023482587891267004; data('42', '4') = 0.14987671627442534; 
data('43', '1') = 0.28827211638077554; data('43', '2') = 0.5861014268422324; data('43', '3') = 0.5277416670647886; data('43', '4') = 0.8409977485363904; 
data('44', '1') = 0.4413949832799582; data('44', '2') = 0.49466756080627283; data('44', '3') = 0.3465268094301722; data('44', '4') = 0.5530665936223486; 
data('45', '1') = 0.9615961584090456; data('45', '2') = 0.856521243388868; data('45', '3') = 0.9427784481260063; data('45', '4') = 0.4046172659095718; 
data('46', '1') = 0.756523124185882; data('46', '2') = 0.5648078817661226; data('46', '3') = 0.232985268912974; data('46', '4') = 0.21179575968397046; 
data('47', '1') = 0.4961560863504364; data('47', '2') = 0.7110422459604598; data('47', '3') = 0.5448790506605838; data('47', '4') = 0.17594685300047463; 
data('48', '1') = 0.6299940584033505; data('48', '2') = 0.5292194115870585; data('48', '3') = 0.8939464290699873; data('48', '4') = 0.9197280302796716; 
data('49', '1') = 0.07389307370742115; data('49', '2') = 0.005735723177950569; data('49', '3') = 0.4794008583889052; data('49', '4') = 0.004539115586572273; 
data('50', '1') = 0.9996037605202052; data('50', '2') = 0.9276346907826053; data('50', '3') = 0.4785901017911528; data('50', '4') = 0.6501272785240141; 
data('51', '1') = 0.38815804383589003; data('51', '2') = 0.18294181500662587; data('51', '3') = 0.5947457416300388; data('51', '4') = 0.2560278530547; 
data('52', '1') = 0.7881170540431139; data('52', '2') = 0.7027070006950007; data('52', '3') = 0.53074558377132; data('52', '4') = 0.8168388416742828; 
data('53', '1') = 0.4453214297783231; data('53', '2') = 0.21574727014066197; data('53', '3') = 0.6007833969220481; data('53', '4') = 0.9855946507995996; 
data('54', '1') = 0.6485865176090697; data('54', '2') = 0.44908734974576303; data('54', '3') = 0.4781220270372615; data('54', '4') = 0.4293696203168158; 
data('55', '1') = 0.22720169504325616; data('55', '2') = 0.8587616013434994; data('55', '3') = 0.7324051963668973; data('55', '4') = 0.5094120193360402; 
data('56', '1') = 0.9823009891805424; data('56', '2') = 0.5232149021549913; data('56', '3') = 0.412031878202064; data('56', '4') = 0.6575192294028848; 
data('57', '1') = 0.3162742657914933; data('57', '2') = 0.01183887321919197; data('57', '3') = 0.28279267276958464; data('57', '4') = 0.7381955824555471; 
data('58', '1') = 0.10049965060750066; data('58', '2') = 0.6649212606311474; data('58', '3') = 0.7422570709815918; data('58', '4') = 0.9244921780023644; 
data('59', '1') = 0.25620601386823527; data('59', '2') = 0.6329104710864797; data('59', '3') = 0.8978869916685618; data('59', '4') = 0.2752974173020497; 
data('60', '1') = 0.9394985975398661; data('60', '2') = 0.7001974279314537; data('60', '3') = 0.014560287694930452; data('60', '4') = 0.9488908278115937; 
data('61', '1') = 0.7245223730309341; data('61', '2') = 0.6320884186727698; data('61', '3') = 0.07010777947378477; data('61', '4') = 0.8256332058949165; 
data('62', '1') = 0.46210092310001927; data('62', '2') = 0.9571118885702112; data('62', '3') = 0.8776417657745464; data('62', '4') = 0.794260774279357; 
data('63', '1') = 0.7164262383633992; data('63', '2') = 0.0023356372774379075; data('63', '3') = 0.49018974871693954; data('63', '4') = 0.6534816823658436; 
data('64', '1') = 0.8471452706051823; data('64', '2') = 0.5501371232455964; data('64', '3') = 0.03173681195462197; data('64', '4') = 0.6406988269865684; 
data('65', '1') = 0.1027082358959257; data('65', '2') = 0.6191886965358735; data('65', '3') = 0.0396474941987105; data('65', '4') = 0.5076488596145615; 
data('66', '1') = 0.8046269662709552; data('66', '2') = 0.3066096892409601; data('66', '3') = 0.3302085960044877; data('66', '4') = 0.08614880449239493; 
data('67', '1') = 0.3749077784219944; data('67', '2') = 0.5535904781787949; data('67', '3') = 0.6638815042064388; data('67', '4') = 0.6241565292654414; 
data('68', '1') = 0.13070697404601161; data('68', '2') = 0.8389058296424665; data('68', '3') = 0.4279566452841579; data('68', '4') = 0.7044875205084992; 
data('69', '1') = 0.984007187389949; data('69', '2') = 0.27224118643893513; data('69', '3') = 0.8166665195844222; data('69', '4') = 0.23429061330082435; 
data('70', '1') = 0.13371995393465497; data('70', '2') = 0.09101629875551842; data('70', '3') = 0.6358860889565332; data('70', '4') = 0.7203605872479781; 
data('71', '1') = 0.21301210615938804; data('71', '2') = 0.374067813581458; data('71', '3') = 0.4204551504954064; data('71', '4') = 0.8226407438351983; 
data('72', '1') = 0.024944005840480177; data('72', '2') = 0.3591318497945377; data('72', '3') = 0.07212577811712384; data('72', '4') = 0.23722064628808992; 
data('73', '1') = 0.9215935724830766; data('73', '2') = 0.48518992578278497; data('73', '3') = 0.49296247697911844; data('73', '4') = 0.6647712305347205; 
data('74', '1') = 0.3648502461028271; data('74', '2') = 0.06393967071399731; data('74', '3') = 0.13444584514873015; data('74', '4') = 0.7247538070080324; 
data('75', '1') = 0.5599549291170659; data('75', '2') = 0.7878758722959883; data('75', '3') = 0.4050992214348107; data('75', '4') = 0.33365852278703323; 
data('76', '1') = 0.22619084434070347; data('76', '2') = 0.8363993872365526; data('76', '3') = 0.5414171155333297; data('76', '4') = 0.26081102137714807; 
data('77', '1') = 0.4106059415435207; data('77', '2') = 0.2449826470166595; data('77', '3') = 0.7918909973693952; data('77', '4') = 0.8322990701344364; 
data('78', '1') = 0.4423186620384577; data('78', '2') = 0.3434911833537476; data('78', '3') = 0.4922586310817758; data('78', '4') = 0.4156203194295037; 
data('79', '1') = 0.4100966305674565; data('79', '2') = 0.40889085523935376; data('79', '3') = 0.29657851165390214; data('79', '4') = 0.5620151372110709; 
data('80', '1') = 0.49476425027721505; data('80', '2') = 0.1515747996525948; data('80', '3') = 0.5813822079576554; data('80', '4') = 0.8550780240593364; 
data('81', '1') = 0.9607123393236836; data('81', '2') = 0.2115894693522845; data('81', '3') = 0.5058202141411953; data('81', '4') = 0.36558409447327245; 
data('82', '1') = 0.4144372056522482; data('82', '2') = 0.6814567356756777; data('82', '3') = 0.5162762586199142; data('82', '4') = 0.18355480250892797; 
data('83', '1') = 0.10369368475566454; data('83', '2') = 0.3542475605882546; data('83', '3') = 0.5761475235592133; data('83', '4') = 0.10899138754717175; 
data('84', '1') = 0.9592221109557761; data('84', '2') = 0.08308007601483602; data('84', '3') = 0.12971405470244857; data('84', '4') = 0.7934713349037354; 
data('85', '1') = 0.16672769537617993; data('85', '2') = 0.4620486792178481; data('85', '3') = 0.12578399113689387; data('85', '4') = 0.38539713316318536; 
data('86', '1') = 0.5517536105490606; data('86', '2') = 0.2010712157545369; data('86', '3') = 0.740004258537079; data('86', '4') = 0.6120574660554547; 
data('87', '1') = 0.09216614481398766; data('87', '2') = 0.6715974069959548; data('87', '3') = 0.9909036902685812; data('87', '4') = 0.2910896406615172; 
data('88', '1') = 0.061660797878906215; data('88', '2') = 0.8463868571925466; data('88', '3') = 0.051301503700685314; data('88', '4') = 0.9114049336321431; 
data('89', '1') = 0.05679190664862688; data('89', '2') = 0.013741958992455783; data('89', '3') = 0.3782041975972922; data('89', '4') = 0.9200396511054753; 
data('90', '1') = 0.8710324703596881; data('90', '2') = 0.3075614026818573; data('90', '3') = 0.32159528070353627; data('90', '4') = 0.1311590448424651; 
data('91', '1') = 0.8511091944819653; data('91', '2') = 0.6096768636784669; data('91', '3') = 0.6976827163899586; data('91', '4') = 0.09357395143425906; 
data('92', '1') = 0.44112774234868934; data('92', '2') = 0.7819875023204081; data('92', '3') = 0.19576206280698216; data('92', '4') = 0.8498406151847044; 
data('93', '1') = 0.6525856858316694; data('93', '2') = 0.2898780968579091; data('93', '3') = 0.5478678762416052; data('93', '4') = 0.19829736411561016; 
data('94', '1') = 0.5169426153592779; data('94', '2') = 0.2849003652622095; data('94', '3') = 0.7711713988613669; data('94', '4') = 0.20962041020553912; 
data('95', '1') = 0.17885218632005317; data('95', '2') = 0.30706440274562585; data('95', '3') = 0.32500469655501785; data('95', '4') = 0.11632561501008132; 
data('96', '1') = 0.7029414942629278; data('96', '2') = 0.3203281757770885; data('96', '3') = 0.29477293143107486; data('96', '4') = 0.16701429916821842; 
data('97', '1') = 0.8638995245388986; data('97', '2') = 0.8885001879695033; data('97', '3') = 0.1769918520067385; data('97', '4') = 0.23867597402221452; 
data('98', '1') = 0.725480288484516; data('98', '2') = 0.6818807481769296; data('98', '3') = 0.5330537870428049; data('98', '4') = 0.09268399911119718; 
data('99', '1') = 0.13324778009309624; data('99', '2') = 0.7980330434465137; data('99', '3') = 0.8193288420633215; data('99', '4') = 0.6273035394858574; 
data('100', '1') = 0.6796346159434266; data('100', '2') = 0.17745837578198675; data('100', '3') = 0.724534591197156; data('100', '4') = 0.35264486204409173; 
Positive Variables cluster_centers(i,k), is_assigned(i,j);
cluster_centers.up(i,k) = 1;
is_assigned.up(i,j) = 1;
Variable objective;
Equations objective_definition, assignment(j);
objective_definition.. objective =e= sum(i, sum(j, is_assigned(i,j) * sum(k, power(cluster_centers(i,k) - data(j,k), 2))));
assignment(j).. sum(i, is_assigned(i,j)) =e= 1;
Model m / all /;
Solve m using nlp minimizing objective;
