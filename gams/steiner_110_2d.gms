Sets
i Steiner points / 1*108 /
j terminals / 1*110 /
k dimensions / 1*2 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.7475060803007401; terminals('1', '2') = 0.23300613999610398; 
terminals('2', '1') = 0.24985872547884214; terminals('2', '2') = 0.2763238900926782; 
terminals('3', '1') = 0.40201081644272296; terminals('3', '2') = 0.49029436125311054; 
terminals('4', '1') = 0.709928664014787; terminals('4', '2') = 0.23575903835015144; 
terminals('5', '1') = 0.8969249365025329; terminals('5', '2') = 0.39354244145394157; 
terminals('6', '1') = 0.385540601538504; terminals('6', '2') = 0.19348386693087805; 
terminals('7', '1') = 0.5845332582547536; terminals('7', '2') = 0.6641505217325049; 
terminals('8', '1') = 0.2067089457797393; terminals('8', '2') = 0.7040845430283342; 
terminals('9', '1') = 0.5276059531263005; terminals('9', '2') = 0.3018808514413377; 
terminals('10', '1') = 0.31744094246663845; terminals('10', '2') = 0.08471242980079463; 
terminals('11', '1') = 0.7678811340193507; terminals('11', '2') = 0.9978727252718022; 
terminals('12', '1') = 0.7177770860452104; terminals('12', '2') = 0.22853386976312995; 
terminals('13', '1') = 0.323727359121901; terminals('13', '2') = 0.7456078180999617; 
terminals('14', '1') = 0.08280114641946701; terminals('14', '2') = 0.5836357313391501; 
terminals('15', '1') = 0.6531698817583061; terminals('15', '2') = 0.5284741012036316; 
terminals('16', '1') = 0.18239361814126875; terminals('16', '2') = 0.1035433700941194; 
terminals('17', '1') = 0.006696409837158135; terminals('17', '2') = 0.8877775450526977; 
terminals('18', '1') = 0.821114015333776; terminals('18', '2') = 0.39745928331583635; 
terminals('19', '1') = 0.37336236173300064; terminals('19', '2') = 0.6118050291314198; 
terminals('20', '1') = 0.4900376459747553; terminals('20', '2') = 0.2779743777984649; 
terminals('21', '1') = 0.635505349657341; terminals('21', '2') = 0.37812764681185795; 
terminals('22', '1') = 0.7581548226438041; terminals('22', '2') = 0.5961296415684542; 
terminals('23', '1') = 0.2743416015419967; terminals('23', '2') = 0.5168706819339789; 
terminals('24', '1') = 0.5866987927805751; terminals('24', '2') = 0.5208402016398397; 
terminals('25', '1') = 0.7832180394990685; terminals('25', '2') = 0.6341214687243051; 
terminals('26', '1') = 0.39437425500667767; terminals('26', '2') = 0.9325000713142382; 
terminals('27', '1') = 0.06339264527724886; terminals('27', '2') = 0.4385886960140769; 
terminals('28', '1') = 0.7306105389744578; terminals('28', '2') = 0.07930652538693805; 
terminals('29', '1') = 0.0581364100687507; terminals('29', '2') = 0.9023240523192311; 
terminals('30', '1') = 0.27406461621050215; terminals('30', '2') = 0.3095875102625001; 
terminals('31', '1') = 0.7194735600661156; terminals('31', '2') = 0.6000262068920096; 
terminals('32', '1') = 0.2198794699505353; terminals('32', '2') = 0.9135073919615575; 
terminals('33', '1') = 0.17967574589894564; terminals('33', '2') = 0.0013233359896119845; 
terminals('34', '1') = 0.31024304873107933; terminals('34', '2') = 0.26258930825617544; 
terminals('35', '1') = 0.323633143779396; terminals('35', '2') = 0.5847124750675176; 
terminals('36', '1') = 0.5982989709829772; terminals('36', '2') = 0.5753231740082259; 
terminals('37', '1') = 0.8563954026284142; terminals('37', '2') = 0.2338708237743179; 
terminals('38', '1') = 0.30620504488341393; terminals('38', '2') = 0.34646820605283013; 
terminals('39', '1') = 0.975351445448176; terminals('39', '2') = 0.1881739488078632; 
terminals('40', '1') = 0.31582674178727344; terminals('40', '2') = 0.9610309968192422; 
terminals('41', '1') = 0.007452012048367873; terminals('41', '2') = 0.7978619943567333; 
terminals('42', '1') = 0.9275340938224557; terminals('42', '2') = 0.4846722941263252; 
terminals('43', '1') = 0.27396288369636; terminals('43', '2') = 0.05601701148832805; 
terminals('44', '1') = 0.6294012868448214; terminals('44', '2') = 0.8903229825230896; 
terminals('45', '1') = 0.2213123446380797; terminals('45', '2') = 0.19031274444854474; 
terminals('46', '1') = 0.30741055832284647; terminals('46', '2') = 0.7594230107840924; 
terminals('47', '1') = 0.2798422132528865; terminals('47', '2') = 0.7564866235398945; 
terminals('48', '1') = 0.5095769162398291; terminals('48', '2') = 0.9698109098495925; 
terminals('49', '1') = 0.48891610893511006; terminals('49', '2') = 0.7640831744282709; 
terminals('50', '1') = 0.6588492379981595; terminals('50', '2') = 0.49286329212128666; 
terminals('51', '1') = 0.41621108423368813; terminals('51', '2') = 0.7075778401715728; 
terminals('52', '1') = 0.9230890617997556; terminals('52', '2') = 0.84750531305688; 
terminals('53', '1') = 0.436084331068597; terminals('53', '2') = 0.6227095809110119; 
terminals('54', '1') = 0.4944686152713905; terminals('54', '2') = 0.26318021910897516; 
terminals('55', '1') = 0.7574711391725601; terminals('55', '2') = 0.5083013998444937; 
terminals('56', '1') = 0.026463148578715567; terminals('56', '2') = 0.7121690767838151; 
terminals('57', '1') = 0.5243658814578113; terminals('57', '2') = 0.8607098685505322; 
terminals('58', '1') = 0.39908096644057345; terminals('58', '2') = 0.013427878433137086; 
terminals('59', '1') = 0.34292802485122853; terminals('59', '2') = 0.686114436456357; 
terminals('60', '1') = 0.5077721595794942; terminals('60', '2') = 0.2160740804916187; 
terminals('61', '1') = 0.23497769426982318; terminals('61', '2') = 0.3100010885993322; 
terminals('62', '1') = 0.02848526265045037; terminals('62', '2') = 0.9470958215167457; 
terminals('63', '1') = 0.2654879239457162; terminals('63', '2') = 0.9455429924711914; 
terminals('64', '1') = 0.2245353768648911; terminals('64', '2') = 0.9733910438303451; 
terminals('65', '1') = 0.8405403353234631; terminals('65', '2') = 0.05259444874342234; 
terminals('66', '1') = 0.9145696158497243; terminals('66', '2') = 0.6990937626272736; 
terminals('67', '1') = 0.7255714729165864; terminals('67', '2') = 0.283200179874634; 
terminals('68', '1') = 0.4342450078987251; terminals('68', '2') = 0.35124337361724256; 
terminals('69', '1') = 0.11693543405338791; terminals('69', '2') = 0.3690231983762894; 
terminals('70', '1') = 0.11441966913069257; terminals('70', '2') = 0.663960034538209; 
terminals('71', '1') = 0.2907473248818252; terminals('71', '2') = 0.9220354948022087; 
terminals('72', '1') = 0.9467626341486374; terminals('72', '2') = 0.2590779140707389; 
terminals('73', '1') = 0.08942256188106379; terminals('73', '2') = 0.6349006498298148; 
terminals('74', '1') = 0.4500239439496819; terminals('74', '2') = 0.6924471290429984; 
terminals('75', '1') = 0.14036045834557165; terminals('75', '2') = 0.5354883086842053; 
terminals('76', '1') = 0.2825726769165574; terminals('76', '2') = 0.9991325056010116; 
terminals('77', '1') = 0.632803522289526; terminals('77', '2') = 0.42021039387372716; 
terminals('78', '1') = 0.47422929453919327; terminals('78', '2') = 0.9985513303714172; 
terminals('79', '1') = 0.5426225344866492; terminals('79', '2') = 0.6491507894344672; 
terminals('80', '1') = 0.7724468418574736; terminals('80', '2') = 0.5559894569806958; 
terminals('81', '1') = 0.35691498036228364; terminals('81', '2') = 0.3433523204451914; 
terminals('82', '1') = 0.4635950390656838; terminals('82', '2') = 0.7045006488302938; 
terminals('83', '1') = 0.2272785191730201; terminals('83', '2') = 0.3090921397303025; 
terminals('84', '1') = 0.22020322741898035; terminals('84', '2') = 0.26565016296874766; 
terminals('85', '1') = 0.40161850992263104; terminals('85', '2') = 0.09671095735100532; 
terminals('86', '1') = 0.9344335059394883; terminals('86', '2') = 0.9276349281051028; 
terminals('87', '1') = 0.9254703424967146; terminals('87', '2') = 0.54150359704167; 
terminals('88', '1') = 0.3870891391263288; terminals('88', '2') = 0.21466409494286698; 
terminals('89', '1') = 0.08531197542039015; terminals('89', '2') = 0.5604987292144534; 
terminals('90', '1') = 0.29053925047581297; terminals('90', '2') = 0.8829476288760749; 
terminals('91', '1') = 0.4253452893690114; terminals('91', '2') = 0.9448945587855807; 
terminals('92', '1') = 0.37780903623169027; terminals('92', '2') = 0.665691604113902; 
terminals('93', '1') = 0.08279354294936958; terminals('93', '2') = 0.4523531930095642; 
terminals('94', '1') = 0.08734596171093734; terminals('94', '2') = 0.4880958991503014; 
terminals('95', '1') = 0.4534244263709801; terminals('95', '2') = 0.6827482823107375; 
terminals('96', '1') = 0.49652080351329797; terminals('96', '2') = 0.053144912398200295; 
terminals('97', '1') = 0.2387694279851088; terminals('97', '2') = 0.9422084379015856; 
terminals('98', '1') = 0.42274541949333444; terminals('98', '2') = 0.3239506054109309; 
terminals('99', '1') = 0.7082393725761847; terminals('99', '2') = 0.36316101429886904; 
terminals('100', '1') = 0.5890921782458624; terminals('100', '2') = 0.4418412869343573; 
terminals('101', '1') = 0.5775660565518346; terminals('101', '2') = 0.37839101404114883; 
terminals('102', '1') = 0.4153101908887469; terminals('102', '2') = 0.5649119771475668; 
terminals('103', '1') = 0.9967661589432554; terminals('103', '2') = 0.5133324975384145; 
terminals('104', '1') = 0.9537714937411997; terminals('104', '2') = 0.7289550700119188; 
terminals('105', '1') = 0.4514934037137076; terminals('105', '2') = 0.24935846957495944; 
terminals('106', '1') = 0.9661658101118968; terminals('106', '2') = 0.42364904029245964; 
terminals('107', '1') = 0.24736682919980613; terminals('107', '2') = 0.37859531451898865; 
terminals('108', '1') = 0.8329320818677892; terminals('108', '2') = 0.39294164050888924; 
terminals('109', '1') = 0.5095148921014379; terminals('109', '2') = 0.7750045610416759; 
terminals('110', '1') = 0.8896072480631075; terminals('110', '2') = 0.5826004281514312; 
Parameter bigM / 1.4142135623730951 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
