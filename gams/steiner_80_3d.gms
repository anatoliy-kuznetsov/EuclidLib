Sets
i Steiner points / 1*78 /
j terminals / 1*80 /
k dimensions / 1*3 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.8639183611899874; terminals('1', '2') = 0.05866022435597662; terminals('1', '3') = 0.9543093364976473; 
terminals('2', '1') = 0.3158948953827083; terminals('2', '2') = 0.6185252797663696; terminals('2', '3') = 0.5273426245487469; 
terminals('3', '1') = 0.6431087017104925; terminals('3', '2') = 0.3206435519192917; terminals('3', '3') = 0.3722885855465746; 
terminals('4', '1') = 0.24866626412761006; terminals('4', '2') = 0.7666346011683024; terminals('4', '3') = 0.4683775253581264; 
terminals('5', '1') = 0.788695303031249; terminals('5', '2') = 0.5437086587024349; terminals('5', '3') = 0.6232083932801823; 
terminals('6', '1') = 0.16333136670251003; terminals('6', '2') = 0.5237047616380859; terminals('6', '3') = 0.2468968402251741; 
terminals('7', '1') = 0.5567497894784903; terminals('7', '2') = 0.9809570147258079; terminals('7', '3') = 0.8388884142123013; 
terminals('8', '1') = 0.39859573432720286; terminals('8', '2') = 0.5137329372204247; terminals('8', '3') = 0.5801354900579894; 
terminals('9', '1') = 0.8505691806055243; terminals('9', '2') = 0.6192808902879907; terminals('9', '3') = 0.3592250112266566; 
terminals('10', '1') = 0.969964412956619; terminals('10', '2') = 0.7595452506278141; terminals('10', '3') = 0.8105387784815029; 
terminals('11', '1') = 0.022288375098834967; terminals('11', '2') = 0.49684011690838215; terminals('11', '3') = 0.3190858213429313; 
terminals('12', '1') = 0.535473452247294; terminals('12', '2') = 0.3405069502673137; terminals('12', '3') = 0.03249335951083354; 
terminals('13', '1') = 0.06518002324824212; terminals('13', '2') = 0.18932269948611524; terminals('13', '3') = 0.6296734292294773; 
terminals('14', '1') = 0.8233125857183213; terminals('14', '2') = 0.027039491098249324; terminals('14', '3') = 0.41938272922805486; 
terminals('15', '1') = 0.020057757773671137; terminals('15', '2') = 0.991310465983186; terminals('15', '3') = 0.1545249061045626; 
terminals('16', '1') = 0.37037617093296826; terminals('16', '2') = 0.4729552491367853; terminals('16', '3') = 0.4279788814935467; 
terminals('17', '1') = 0.11789126814517403; terminals('17', '2') = 0.8407993636741035; terminals('17', '3') = 0.3213672976279939; 
terminals('18', '1') = 0.46370634745603734; terminals('18', '2') = 0.13937701715316886; terminals('18', '3') = 0.8502912726748189; 
terminals('19', '1') = 0.6168495328088864; terminals('19', '2') = 0.8853344361324849; terminals('19', '3') = 0.34268376832520453; 
terminals('20', '1') = 0.5420660729625676; terminals('20', '2') = 0.9377689457684503; terminals('20', '3') = 0.27995536861353976; 
terminals('21', '1') = 0.5623478497051286; terminals('21', '2') = 0.9039705933225366; terminals('21', '3') = 0.740967846597754; 
terminals('22', '1') = 0.7092722061333876; terminals('22', '2') = 0.791532512234269; terminals('22', '3') = 0.2994136055994491; 
terminals('23', '1') = 0.9292875496112409; terminals('23', '2') = 0.25116608427595355; terminals('23', '3') = 0.5462890465607324; 
terminals('24', '1') = 0.46460617660380676; terminals('24', '2') = 0.08832062647643524; terminals('24', '3') = 0.364433322895639; 
terminals('25', '1') = 0.24985437172731295; terminals('25', '2') = 0.42133581712601464; terminals('25', '3') = 0.7120060481567171; 
terminals('26', '1') = 0.8050555908223226; terminals('26', '2') = 0.2957385336063578; terminals('26', '3') = 0.5008015153449964; 
terminals('27', '1') = 0.6013774242426991; terminals('27', '2') = 0.21149203249974946; terminals('27', '3') = 0.9516231675609381; 
terminals('28', '1') = 0.9855136451364583; terminals('28', '2') = 0.39361780440758476; terminals('28', '3') = 0.2876296774786372; 
terminals('29', '1') = 0.938104269089795; terminals('29', '2') = 0.3303058579742675; terminals('29', '3') = 0.8581146498748011; 
terminals('30', '1') = 0.8713555284745691; terminals('30', '2') = 0.345664638026011; terminals('30', '3') = 0.7321448288237824; 
terminals('31', '1') = 0.7076359268092568; terminals('31', '2') = 0.9696075303877418; terminals('31', '3') = 0.28017623865551955; 
terminals('32', '1') = 0.7922025014112977; terminals('32', '2') = 0.0031980845337086228; terminals('32', '3') = 0.6001113446248348; 
terminals('33', '1') = 0.20119295940911874; terminals('33', '2') = 0.5200142828665231; terminals('33', '3') = 0.67989481192219; 
terminals('34', '1') = 0.8384751930444576; terminals('34', '2') = 0.3419434464706699; terminals('34', '3') = 0.7557021051267301; 
terminals('35', '1') = 0.28357997631003706; terminals('35', '2') = 0.759345721566585; terminals('35', '3') = 0.8292916404423192; 
terminals('36', '1') = 0.08492221341781991; terminals('36', '2') = 0.9296392347007519; terminals('36', '3') = 0.3678995301932415; 
terminals('37', '1') = 0.6718865906850227; terminals('37', '2') = 0.1773638317832057; terminals('37', '3') = 0.713429270348539; 
terminals('38', '1') = 0.05506256102095064; terminals('38', '2') = 0.15165931653447895; terminals('38', '3') = 0.6704800451304245; 
terminals('39', '1') = 0.6406239166300473; terminals('39', '2') = 0.16581497815582757; terminals('39', '3') = 0.7868174382028595; 
terminals('40', '1') = 0.2791944037584665; terminals('40', '2') = 0.6814433264192644; terminals('40', '3') = 0.971119728498941; 
terminals('41', '1') = 0.31274930978595317; terminals('41', '2') = 0.08307673804229476; terminals('41', '3') = 0.04372056405796254; 
terminals('42', '1') = 0.2135344097352091; terminals('42', '2') = 0.9409433656795413; terminals('42', '3') = 0.9875883500378104; 
terminals('43', '1') = 0.9879591351560683; terminals('43', '2') = 0.3919643999498279; terminals('43', '3') = 0.11167424664496128; 
terminals('44', '1') = 0.5549626865353942; terminals('44', '2') = 0.48171121608133183; terminals('44', '3') = 0.8812104725173171; 
terminals('45', '1') = 0.6536675194720529; terminals('45', '2') = 0.9467909959023484; terminals('45', '3') = 0.23703292722023828; 
terminals('46', '1') = 0.6582395620976327; terminals('46', '2') = 0.4309383234223141; terminals('46', '3') = 0.15278297528889295; 
terminals('47', '1') = 0.8472811348563651; terminals('47', '2') = 0.9548162521956027; terminals('47', '3') = 0.10588808475129663; 
terminals('48', '1') = 0.3254792008841857; terminals('48', '2') = 0.7167435240247525; terminals('48', '3') = 0.2921648674881485; 
terminals('49', '1') = 0.10647463836446458; terminals('49', '2') = 0.8078720084855587; terminals('49', '3') = 0.1291818428363657; 
terminals('50', '1') = 0.29237764799429733; terminals('50', '2') = 0.9769676157634358; terminals('50', '3') = 0.3643153527844222; 
terminals('51', '1') = 0.5303165493371012; terminals('51', '2') = 0.8244598793663181; terminals('51', '3') = 0.7240317986593612; 
terminals('52', '1') = 0.4610032693128836; terminals('52', '2') = 0.715925334699529; terminals('52', '3') = 0.5283727747677276; 
terminals('53', '1') = 0.6334864334637751; terminals('53', '2') = 0.47998381507167487; terminals('53', '3') = 0.177438062348936; 
terminals('54', '1') = 0.15084066549837227; terminals('54', '2') = 0.03853248698236156; terminals('54', '3') = 0.49161766716918787; 
terminals('55', '1') = 0.7751435388109303; terminals('55', '2') = 0.04989398901051578; terminals('55', '3') = 0.9745096587427281; 
terminals('56', '1') = 0.6151436544331611; terminals('56', '2') = 0.3756681078672255; terminals('56', '3') = 0.5888918268417763; 
terminals('57', '1') = 0.26623038149810585; terminals('57', '2') = 0.7644929946791388; terminals('57', '3') = 0.5948814165035461; 
terminals('58', '1') = 0.736798802959132; terminals('58', '2') = 0.574221312862486; terminals('58', '3') = 0.2350397073062126; 
terminals('59', '1') = 0.46254000242090976; terminals('59', '2') = 0.2742633272570256; terminals('59', '3') = 0.02474865976027052; 
terminals('60', '1') = 0.9983221248450274; terminals('60', '2') = 0.8192718607060795; terminals('60', '3') = 0.4170485828431011; 
terminals('61', '1') = 0.9664174013450035; terminals('61', '2') = 0.8022287280180408; terminals('61', '3') = 0.8518111030850016; 
terminals('62', '1') = 0.0817799393475318; terminals('62', '2') = 0.9099990257801128; terminals('62', '3') = 0.17583676972197293; 
terminals('63', '1') = 0.516550638106787; terminals('63', '2') = 0.8004900894417522; terminals('63', '3') = 0.8121398019870192; 
terminals('64', '1') = 0.0013747138684441218; terminals('64', '2') = 0.04196351294930678; terminals('64', '3') = 0.039077843007632396; 
terminals('65', '1') = 0.5454539096636676; terminals('65', '2') = 0.41798886408934177; terminals('65', '3') = 0.5091079567590286; 
terminals('66', '1') = 0.367803518569923; terminals('66', '2') = 0.2068686483187977; terminals('66', '3') = 0.8328784482763724; 
terminals('67', '1') = 0.8235040876293923; terminals('67', '2') = 0.4968691538931671; terminals('67', '3') = 0.39421080075323833; 
terminals('68', '1') = 0.2635159640004149; terminals('68', '2') = 0.6584933335720686; terminals('68', '3') = 0.8246346489788028; 
terminals('69', '1') = 0.4971890281182638; terminals('69', '2') = 0.17018896631072689; terminals('69', '3') = 0.253645249782654; 
terminals('70', '1') = 0.378258546513108; terminals('70', '2') = 0.5669662096152008; terminals('70', '3') = 0.5986235198197811; 
terminals('71', '1') = 0.3769906035965904; terminals('71', '2') = 0.4567039171306829; terminals('71', '3') = 0.9033288412955748; 
terminals('72', '1') = 0.002186108379169438; terminals('72', '2') = 0.570027656645064; terminals('72', '3') = 0.8975577988283007; 
terminals('73', '1') = 0.30211424713865864; terminals('73', '2') = 0.2810069638871232; terminals('73', '3') = 0.6018183125236053; 
terminals('74', '1') = 0.2873640770970125; terminals('74', '2') = 0.5945275509837851; terminals('74', '3') = 0.3469269290581095; 
terminals('75', '1') = 0.1368103718417243; terminals('75', '2') = 0.36825549420954307; terminals('75', '3') = 0.3598169989692076; 
terminals('76', '1') = 0.9271535551956086; terminals('76', '2') = 0.6539552148647966; terminals('76', '3') = 0.8936134162178105; 
terminals('77', '1') = 0.8809102295343695; terminals('77', '2') = 0.8066811887645826; terminals('77', '3') = 0.3637269311447112; 
terminals('78', '1') = 0.7401310939613146; terminals('78', '2') = 0.46397602278524197; terminals('78', '3') = 0.8927928078380157; 
terminals('79', '1') = 0.6201579625388555; terminals('79', '2') = 0.9977509483448362; terminals('79', '3') = 0.6323165989493396; 
terminals('80', '1') = 0.24914604466511048; terminals('80', '2') = 0.6532338732701021; terminals('80', '3') = 0.35036323749393183; 
Parameter bigM / 1.7320508075688772 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
