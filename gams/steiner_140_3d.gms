Sets
i Steiner points / 1*138 /
j terminals / 1*140 /
k dimensions / 1*3 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.026343380459525556; terminals('1', '2') = 0.7813690555430765; terminals('1', '3') = 0.2726063832840899; 
terminals('2', '1') = 0.09559240016295012; terminals('2', '2') = 0.6636843135795658; terminals('2', '3') = 0.6563800283837913; 
terminals('3', '1') = 0.03021984191149818; terminals('3', '2') = 0.32550720486853546; terminals('3', '3') = 0.9983246672922264; 
terminals('4', '1') = 0.01844593706941411; terminals('4', '2') = 0.7750863553886201; terminals('4', '3') = 0.1274925511095648; 
terminals('5', '1') = 0.33128238455282966; terminals('5', '2') = 0.43144503435637416; terminals('5', '3') = 0.12377539195910858; 
terminals('6', '1') = 0.9187768350249678; terminals('6', '2') = 0.27190431824348005; terminals('6', '3') = 0.14645867558231007; 
terminals('7', '1') = 0.10644923133960649; terminals('7', '2') = 0.26134336360924315; terminals('7', '3') = 0.18448327095435324; 
terminals('8', '1') = 0.6673696272195296; terminals('8', '2') = 0.24737915766263818; terminals('8', '3') = 0.009296986418753983; 
terminals('9', '1') = 0.9717147321272774; terminals('9', '2') = 0.7962056319236935; terminals('9', '3') = 0.9408746218833306; 
terminals('10', '1') = 0.5164356159520489; terminals('10', '2') = 0.6776839867919822; terminals('10', '3') = 0.7168526094627625; 
terminals('11', '1') = 0.9016424041258982; terminals('11', '2') = 0.9696633134946779; terminals('11', '3') = 0.506628127465557; 
terminals('12', '1') = 0.5804129328413339; terminals('12', '2') = 0.2995652119813792; terminals('12', '3') = 0.5278971717412196; 
terminals('13', '1') = 0.8037880008833055; terminals('13', '2') = 0.7400850290059378; terminals('13', '3') = 0.4206734948326629; 
terminals('14', '1') = 0.02389608336288873; terminals('14', '2') = 0.6830705923085667; terminals('14', '3') = 0.19513494452874625; 
terminals('15', '1') = 0.7894276568310608; terminals('15', '2') = 0.18795516635111886; terminals('15', '3') = 0.6619081830054465; 
terminals('16', '1') = 0.6681452036322416; terminals('16', '2') = 0.552826206659373; terminals('16', '3') = 0.4803835731552364; 
terminals('17', '1') = 0.12664580312454077; terminals('17', '2') = 0.04634079804737201; terminals('17', '3') = 0.5513974163848; 
terminals('18', '1') = 0.4520304663871496; terminals('18', '2') = 0.9972835851848496; terminals('18', '3') = 0.7104850818413295; 
terminals('19', '1') = 0.4680348352254471; terminals('19', '2') = 0.003823018553855695; terminals('19', '3') = 0.6650888638033956; 
terminals('20', '1') = 0.4853760030846599; terminals('20', '2') = 0.5052967334335191; terminals('20', '3') = 0.9218763927750685; 
terminals('21', '1') = 0.8351211302961542; terminals('21', '2') = 0.8030216268317144; terminals('21', '3') = 0.5668669345274459; 
terminals('22', '1') = 0.8465200450140877; terminals('22', '2') = 0.9490801219935968; terminals('22', '3') = 0.968801557497072; 
terminals('23', '1') = 0.4419145838543974; terminals('23', '2') = 0.47563951612371025; terminals('23', '3') = 0.03823091277525126; 
terminals('24', '1') = 0.9457453326673921; terminals('24', '2') = 0.21557073978723273; terminals('24', '3') = 0.6642019326717239; 
terminals('25', '1') = 0.043284142505865875; terminals('25', '2') = 0.1498869943883061; terminals('25', '3') = 0.6222906421667227; 
terminals('26', '1') = 0.9641611504347632; terminals('26', '2') = 0.9766592965436613; terminals('26', '3') = 0.8841015446236297; 
terminals('27', '1') = 0.35608196331810926; terminals('27', '2') = 0.8533309160637665; terminals('27', '3') = 0.5276889396908889; 
terminals('28', '1') = 0.40084409295198997; terminals('28', '2') = 0.7746261883911317; terminals('28', '3') = 0.20206869569632802; 
terminals('29', '1') = 0.23164305143324715; terminals('29', '2') = 0.7455981787758587; terminals('29', '3') = 0.236232874137853; 
terminals('30', '1') = 0.6162911183677704; terminals('30', '2') = 0.1493885687105706; terminals('30', '3') = 0.21996393865964448; 
terminals('31', '1') = 0.7116595896112331; terminals('31', '2') = 0.9157997920325903; terminals('31', '3') = 0.5774863794793847; 
terminals('32', '1') = 0.9505943762644284; terminals('32', '2') = 0.1818293922706289; terminals('32', '3') = 0.4648667891085786; 
terminals('33', '1') = 0.8678370423411461; terminals('33', '2') = 0.3487746665571442; terminals('33', '3') = 0.7351222284413026; 
terminals('34', '1') = 0.7875689985464698; terminals('34', '2') = 0.6670499752463569; terminals('34', '3') = 0.13306846871246347; 
terminals('35', '1') = 0.4049210972945446; terminals('35', '2') = 0.5076280700648428; terminals('35', '3') = 0.67916956921979; 
terminals('36', '1') = 0.03814875698970577; terminals('36', '2') = 0.8184928111415427; terminals('36', '3') = 0.6973583260321352; 
terminals('37', '1') = 0.9489410264059718; terminals('37', '2') = 0.1215474716440349; terminals('37', '3') = 0.48514326397024077; 
terminals('38', '1') = 0.55822070933035; terminals('38', '2') = 0.7814484670459443; terminals('38', '3') = 0.11110824984020118; 
terminals('39', '1') = 0.2562357280794768; terminals('39', '2') = 0.27863660248219246; terminals('39', '3') = 0.7347928231490112; 
terminals('40', '1') = 0.08320325086719382; terminals('40', '2') = 0.4125919915246351; terminals('40', '3') = 0.946604254658573; 
terminals('41', '1') = 0.007413247791102084; terminals('41', '2') = 0.5586831952685101; terminals('41', '3') = 0.1178193174540082; 
terminals('42', '1') = 0.6983115659920311; terminals('42', '2') = 0.16831357134184421; terminals('42', '3') = 0.8492272208219264; 
terminals('43', '1') = 0.7186585982013152; terminals('43', '2') = 0.35052047330566705; terminals('43', '3') = 0.5421000791480833; 
terminals('44', '1') = 0.36193997534975353; terminals('44', '2') = 0.49584063095779995; terminals('44', '3') = 0.5503712154710247; 
terminals('45', '1') = 0.1060250107005195; terminals('45', '2') = 0.6806789246759184; terminals('45', '3') = 0.5660851894669002; 
terminals('46', '1') = 0.9982922438769901; terminals('46', '2') = 0.8272962878422532; terminals('46', '3') = 0.44578715276245984; 
terminals('47', '1') = 0.9555951815021732; terminals('47', '2') = 0.42393316006788984; terminals('47', '3') = 0.9966153438195441; 
terminals('48', '1') = 0.9584727424001309; terminals('48', '2') = 0.6014714387021209; terminals('48', '3') = 0.7521479805173659; 
terminals('49', '1') = 0.34220463635571396; terminals('49', '2') = 0.7858465211077492; terminals('49', '3') = 0.2504498722531683; 
terminals('50', '1') = 0.7019498800229159; terminals('50', '2') = 0.6667168402972771; terminals('50', '3') = 0.35364835058237043; 
terminals('51', '1') = 0.14132482652633838; terminals('51', '2') = 0.7061095469041108; terminals('51', '3') = 0.5337555341304153; 
terminals('52', '1') = 0.5391676161103904; terminals('52', '2') = 0.5073012344367506; terminals('52', '3') = 0.8121738074495853; 
terminals('53', '1') = 0.8715939784476847; terminals('53', '2') = 0.4086853829607705; terminals('53', '3') = 0.774858360094107; 
terminals('54', '1') = 0.04143603540146368; terminals('54', '2') = 0.8257049099050593; terminals('54', '3') = 0.23327914868516186; 
terminals('55', '1') = 0.9248808013838228; terminals('55', '2') = 0.9574549317000876; terminals('55', '3') = 0.31811092760604287; 
terminals('56', '1') = 0.03766655080715575; terminals('56', '2') = 0.9446203437247211; terminals('56', '3') = 0.8703240871884904; 
terminals('57', '1') = 0.5096604570573205; terminals('57', '2') = 0.2593855911935927; terminals('57', '3') = 0.15294513311847868; 
terminals('58', '1') = 0.8399546091320734; terminals('58', '2') = 0.03290759313211444; terminals('58', '3') = 0.3972876196867158; 
terminals('59', '1') = 0.9116468900138588; terminals('59', '2') = 0.7880019333897711; terminals('59', '3') = 0.3391155318693758; 
terminals('60', '1') = 0.6655393507721082; terminals('60', '2') = 0.3401395406856702; terminals('60', '3') = 0.9238578522458706; 
terminals('61', '1') = 0.46191874780599385; terminals('61', '2') = 0.8643089603227334; terminals('61', '3') = 0.12910099646291928; 
terminals('62', '1') = 0.6777550029756759; terminals('62', '2') = 0.5472030202993579; terminals('62', '3') = 0.6488270516305192; 
terminals('63', '1') = 0.3133342366442865; terminals('63', '2') = 0.29053899571831177; terminals('63', '3') = 0.6618170417503747; 
terminals('64', '1') = 0.5785420855566732; terminals('64', '2') = 0.27125901316307177; terminals('64', '3') = 0.4347288494733397; 
terminals('65', '1') = 0.7338555575457031; terminals('65', '2') = 0.7633960201885684; terminals('65', '3') = 0.059269540304507595; 
terminals('66', '1') = 0.8785047083764629; terminals('66', '2') = 0.5231361629125483; terminals('66', '3') = 0.6686238674985983; 
terminals('67', '1') = 0.012294489988823654; terminals('67', '2') = 0.2646307715176991; terminals('67', '3') = 0.5907104804344553; 
terminals('68', '1') = 0.0042002861823052795; terminals('68', '2') = 0.8200845541130395; terminals('68', '3') = 0.1677487250998536; 
terminals('69', '1') = 0.6383461227610537; terminals('69', '2') = 0.19212790791304257; terminals('69', '3') = 0.3466454686615196; 
terminals('70', '1') = 0.3763689954431848; terminals('70', '2') = 0.348848741718465; terminals('70', '3') = 0.09666903007827532; 
terminals('71', '1') = 0.6368477361895257; terminals('71', '2') = 0.08695751088764392; terminals('71', '3') = 0.1420866353920014; 
terminals('72', '1') = 0.8233567284762635; terminals('72', '2') = 0.6355723005873114; terminals('72', '3') = 0.1797673072605166; 
terminals('73', '1') = 0.13706060679265542; terminals('73', '2') = 0.29990889495330963; terminals('73', '3') = 0.6140723766097285; 
terminals('74', '1') = 0.7489029862872583; terminals('74', '2') = 0.8592333933904981; terminals('74', '3') = 0.44431728000389725; 
terminals('75', '1') = 0.35058158003315687; terminals('75', '2') = 0.3921503521251928; terminals('75', '3') = 0.04970905188043506; 
terminals('76', '1') = 0.9075989682520393; terminals('76', '2') = 0.6641508945633702; terminals('76', '3') = 0.7760715370406417; 
terminals('77', '1') = 0.10636164431783446; terminals('77', '2') = 0.8484345483632293; terminals('77', '3') = 0.861827509984669; 
terminals('78', '1') = 0.5315814714473417; terminals('78', '2') = 0.24363932894771867; terminals('78', '3') = 0.16969898160851427; 
terminals('79', '1') = 0.04057668820357507; terminals('79', '2') = 0.269592739258974; terminals('79', '3') = 0.609622792298657; 
terminals('80', '1') = 0.3937608944163854; terminals('80', '2') = 0.45162579845975537; terminals('80', '3') = 0.4658436265413576; 
terminals('81', '1') = 0.9350384725085604; terminals('81', '2') = 0.7498089109053343; terminals('81', '3') = 0.07151599054082691; 
terminals('82', '1') = 0.37128519463742127; terminals('82', '2') = 0.32460011533368494; terminals('82', '3') = 0.2526430552814005; 
terminals('83', '1') = 0.8271113813580998; terminals('83', '2') = 0.678718402902148; terminals('83', '3') = 0.7734639990418246; 
terminals('84', '1') = 0.4160746150551643; terminals('84', '2') = 0.5546978631957554; terminals('84', '3') = 0.8441865508183626; 
terminals('85', '1') = 0.3320364684814071; terminals('85', '2') = 0.8049595180113293; terminals('85', '3') = 0.7049830513230652; 
terminals('86', '1') = 0.09827786390560056; terminals('86', '2') = 0.5902798534695815; terminals('86', '3') = 0.40247288057279307; 
terminals('87', '1') = 0.9556236495428945; terminals('87', '2') = 0.45087799594861133; terminals('87', '3') = 0.33960087158056984; 
terminals('88', '1') = 0.9213711324564067; terminals('88', '2') = 0.999754317347117; terminals('88', '3') = 0.9893417039814969; 
terminals('89', '1') = 0.8490216972781408; terminals('89', '2') = 0.11018734656793694; terminals('89', '3') = 0.8954330185821092; 
terminals('90', '1') = 0.6794091658172345; terminals('90', '2') = 0.9026878585781192; terminals('90', '3') = 0.8762572919971185; 
terminals('91', '1') = 0.3628570741948771; terminals('91', '2') = 0.8873062351472321; terminals('91', '3') = 0.791915335208951; 
terminals('92', '1') = 0.33804650345143483; terminals('92', '2') = 0.6551257974861296; terminals('92', '3') = 0.39779426397883133; 
terminals('93', '1') = 0.732333818250249; terminals('93', '2') = 0.39525037173246846; terminals('93', '3') = 0.10260911891191749; 
terminals('94', '1') = 0.467656915182425; terminals('94', '2') = 0.876695944209599; terminals('94', '3') = 0.3108783559917443; 
terminals('95', '1') = 0.003018342767936555; terminals('95', '2') = 0.5579168969728616; terminals('95', '3') = 0.03779830836519826; 
terminals('96', '1') = 0.3175827895614105; terminals('96', '2') = 0.09121807214611732; terminals('96', '3') = 0.42750538560443474; 
terminals('97', '1') = 0.4198182988840006; terminals('97', '2') = 0.45543602434470354; terminals('97', '3') = 0.5097930607632297; 
terminals('98', '1') = 0.6191593779349099; terminals('98', '2') = 0.6773587280281648; terminals('98', '3') = 0.7689553579025876; 
terminals('99', '1') = 0.8860362574008688; terminals('99', '2') = 0.7602917687779365; terminals('99', '3') = 0.15588480043652653; 
terminals('100', '1') = 0.9014172697746741; terminals('100', '2') = 0.05877222371126445; terminals('100', '3') = 0.009615045760825502; 
terminals('101', '1') = 0.07941173713283178; terminals('101', '2') = 0.5020359153833567; terminals('101', '3') = 0.1522362661641573; 
terminals('102', '1') = 0.16343278388158677; terminals('102', '2') = 0.03682783997402961; terminals('102', '3') = 0.584072453318638; 
terminals('103', '1') = 0.31370511164192716; terminals('103', '2') = 0.2568643650989749; terminals('103', '3') = 0.6165731130534684; 
terminals('104', '1') = 0.0744323176287004; terminals('104', '2') = 0.47929026469561564; terminals('104', '3') = 0.8039681817653993; 
terminals('105', '1') = 0.3636597027092707; terminals('105', '2') = 0.9639333427032345; terminals('105', '3') = 0.23817178154602925; 
terminals('106', '1') = 0.0912028083622276; terminals('106', '2') = 0.15583915252198033; terminals('106', '3') = 0.8267599354291101; 
terminals('107', '1') = 0.6727625028225289; terminals('107', '2') = 0.3188983447583652; terminals('107', '3') = 0.24917023627310886; 
terminals('108', '1') = 0.9777967702060668; terminals('108', '2') = 0.09183402435745736; terminals('108', '3') = 0.8598560997961182; 
terminals('109', '1') = 0.2297623482570781; terminals('109', '2') = 0.6986227319675101; terminals('109', '3') = 0.8304110614650944; 
terminals('110', '1') = 0.3440882321192351; terminals('110', '2') = 0.33166960218837915; terminals('110', '3') = 0.49770612267297953; 
terminals('111', '1') = 0.4764702323771699; terminals('111', '2') = 0.811371901507896; terminals('111', '3') = 0.033628815080792074; 
terminals('112', '1') = 0.20267164955302108; terminals('112', '2') = 0.5602108022386855; terminals('112', '3') = 0.5239889813878781; 
terminals('113', '1') = 0.38321394330970193; terminals('113', '2') = 0.003147317058295296; terminals('113', '3') = 0.8684674295201323; 
terminals('114', '1') = 0.44467457143755007; terminals('114', '2') = 0.6629317144387924; terminals('114', '3') = 0.7772605909304345; 
terminals('115', '1') = 0.07603100216479108; terminals('115', '2') = 0.5267291854040803; terminals('115', '3') = 0.9403228622874787; 
terminals('116', '1') = 0.3258645731554377; terminals('116', '2') = 0.19368224713911442; terminals('116', '3') = 0.7311416419664625; 
terminals('117', '1') = 0.9669655791061172; terminals('117', '2') = 0.7631292630723332; terminals('117', '3') = 0.5481428330550134; 
terminals('118', '1') = 0.5528078349992623; terminals('118', '2') = 0.913683781537642; terminals('118', '3') = 0.6736360418102896; 
terminals('119', '1') = 0.8817469348537521; terminals('119', '2') = 0.6999774991538277; terminals('119', '3') = 0.044780827589039784; 
terminals('120', '1') = 0.8293271988577208; terminals('120', '2') = 0.026064060856680227; terminals('120', '3') = 0.9415541662389213; 
terminals('121', '1') = 0.4092711381987769; terminals('121', '2') = 0.3655158295635227; terminals('121', '3') = 0.7750328088835772; 
terminals('122', '1') = 0.3009522180705986; terminals('122', '2') = 0.026602028557770385; terminals('122', '3') = 0.13636827106268834; 
terminals('123', '1') = 0.433633802994013; terminals('123', '2') = 0.1287235836581223; terminals('123', '3') = 0.24599055995953423; 
terminals('124', '1') = 0.34223137982610874; terminals('124', '2') = 0.8494663828124103; terminals('124', '3') = 0.9475538952168614; 
terminals('125', '1') = 0.9261761367986214; terminals('125', '2') = 0.43410729289331973; terminals('125', '3') = 0.34596945718268235; 
terminals('126', '1') = 0.18808097516948963; terminals('126', '2') = 0.7744564951114135; terminals('126', '3') = 0.13031674897626666; 
terminals('127', '1') = 0.3864649766715057; terminals('127', '2') = 0.8547177299452712; terminals('127', '3') = 0.5406855295729472; 
terminals('128', '1') = 0.5097542392758435; terminals('128', '2') = 0.7925136291209406; terminals('128', '3') = 0.6294894805104003; 
terminals('129', '1') = 0.6637025344547588; terminals('129', '2') = 0.6122032204111156; terminals('129', '3') = 0.7611368529017538; 
terminals('130', '1') = 0.9681436705275192; terminals('130', '2') = 0.7718696601217234; terminals('130', '3') = 0.2815251017020951; 
terminals('131', '1') = 0.4778784813265994; terminals('131', '2') = 0.6938648818649117; terminals('131', '3') = 0.9172662905478203; 
terminals('132', '1') = 0.9018877683971027; terminals('132', '2') = 0.9318104376888872; terminals('132', '3') = 0.3407532723965787; 
terminals('133', '1') = 0.909622683788326; terminals('133', '2') = 0.4469776597476395; terminals('133', '3') = 0.5403265591717687; 
terminals('134', '1') = 0.7452496016754458; terminals('134', '2') = 0.4279940739736561; terminals('134', '3') = 0.18395121982493978; 
terminals('135', '1') = 0.7641957197061369; terminals('135', '2') = 0.649619204681891; terminals('135', '3') = 0.2664826924681636; 
terminals('136', '1') = 0.36844729650240315; terminals('136', '2') = 0.5698539757775063; terminals('136', '3') = 0.34194301444620645; 
terminals('137', '1') = 0.7987075753468015; terminals('137', '2') = 0.025850376166102307; terminals('137', '3') = 0.49621182964154453; 
terminals('138', '1') = 0.748142095551974; terminals('138', '2') = 0.17544558187302906; terminals('138', '3') = 0.13968050236765428; 
terminals('139', '1') = 0.9959351107283; terminals('139', '2') = 0.846130408867745; terminals('139', '3') = 0.7858287992744379; 
terminals('140', '1') = 0.6658131295476081; terminals('140', '2') = 0.0044892785066690255; terminals('140', '3') = 0.08316532078073913; 
Parameter bigM / 1.7320508075688772 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
