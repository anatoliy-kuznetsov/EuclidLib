Sets
i Steiner points / 1*63 /
j terminals / 1*65 /
k dimensions / 1*4 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.2106710379682939; terminals('1', '2') = 0.9380328238559007; terminals('1', '3') = 0.5667998461953477; terminals('1', '4') = 0.482178779031632; 
terminals('2', '1') = 0.6921704192424565; terminals('2', '2') = 0.6071159746640816; terminals('2', '3') = 0.28067318178028355; terminals('2', '4') = 0.41569505680078056; 
terminals('3', '1') = 0.26474460667407274; terminals('3', '2') = 0.9614130167855441; terminals('3', '3') = 0.0707151121265176; terminals('3', '4') = 0.9893434542570855; 
terminals('4', '1') = 0.23156734593376105; terminals('4', '2') = 0.7732742734543422; terminals('4', '3') = 0.7628950529059627; terminals('4', '4') = 0.27985320941194014; 
terminals('5', '1') = 0.5367732092433625; terminals('5', '2') = 0.5965451420633557; terminals('5', '3') = 0.6467752274170386; terminals('5', '4') = 0.372411779688262; 
terminals('6', '1') = 0.8279077309261653; terminals('6', '2') = 0.8181245805793201; terminals('6', '3') = 0.3775072307249415; terminals('6', '4') = 0.6867145848811803; 
terminals('7', '1') = 0.7220829306911104; terminals('7', '2') = 0.7342832220144605; terminals('7', '3') = 0.3685845360665072; terminals('7', '4') = 0.7118310852405018; 
terminals('8', '1') = 0.6533762678731008; terminals('8', '2') = 0.592805073085458; terminals('8', '3') = 0.24625026857026722; terminals('8', '4') = 0.634224095845636; 
terminals('9', '1') = 0.7569077546796499; terminals('9', '2') = 0.9343351725725354; terminals('9', '3') = 0.27622085017059816; terminals('9', '4') = 0.4589281122397437; 
terminals('10', '1') = 0.7216276717967004; terminals('10', '2') = 0.017590600245009358; terminals('10', '3') = 0.46941724892095715; terminals('10', '4') = 0.9452764500582773; 
terminals('11', '1') = 0.6074779488685781; terminals('11', '2') = 0.9776067560233044; terminals('11', '3') = 0.9268186379015223; terminals('11', '4') = 0.9436421270531206; 
terminals('12', '1') = 0.18864028013444678; terminals('12', '2') = 0.9208912473126668; terminals('12', '3') = 0.7314713437731547; terminals('12', '4') = 0.4976782180342062; 
terminals('13', '1') = 0.29792175349757; terminals('13', '2') = 0.3500594275918908; terminals('13', '3') = 0.6448825450498948; terminals('13', '4') = 0.5576645496902932; 
terminals('14', '1') = 0.6382451411523757; terminals('14', '2') = 0.20956587468676147; terminals('14', '3') = 0.6320139941266896; terminals('14', '4') = 0.9175561148832773; 
terminals('15', '1') = 0.1559921936429426; terminals('15', '2') = 0.3409841908722594; terminals('15', '3') = 0.6577307948305324; terminals('15', '4') = 0.2777657938873741; 
terminals('16', '1') = 0.14443572426114415; terminals('16', '2') = 0.14364727656465304; terminals('16', '3') = 0.06880467275827229; terminals('16', '4') = 0.5085243158092849; 
terminals('17', '1') = 0.43588036862789326; terminals('17', '2') = 0.9713435863263217; terminals('17', '3') = 0.5695414814133535; terminals('17', '4') = 0.4280783577446694; 
terminals('18', '1') = 0.3298306422132571; terminals('18', '2') = 0.7088843280198104; terminals('18', '3') = 0.8015451633153265; terminals('18', '4') = 0.21772065393846396; 
terminals('19', '1') = 0.6866879485000786; terminals('19', '2') = 0.07237968203725242; terminals('19', '3') = 0.940058781730322; terminals('19', '4') = 0.21964320431462347; 
terminals('20', '1') = 0.5916160596265396; terminals('20', '2') = 0.7781762122149978; terminals('20', '3') = 0.21407212422639832; terminals('20', '4') = 0.8336924476697815; 
terminals('21', '1') = 0.15440819183697263; terminals('21', '2') = 0.3665868158685286; terminals('21', '3') = 0.9844164586117331; terminals('21', '4') = 0.6159088265614614; 
terminals('22', '1') = 0.14231075568033247; terminals('22', '2') = 0.16850407299078884; terminals('22', '3') = 0.37692809442522435; terminals('22', '4') = 0.27568355326162464; 
terminals('23', '1') = 0.1632965140384206; terminals('23', '2') = 0.31564703437091357; terminals('23', '3') = 0.791210567738616; terminals('23', '4') = 0.3223739532041613; 
terminals('24', '1') = 0.871895092239175; terminals('24', '2') = 0.9847921554381042; terminals('24', '3') = 0.581503700855424; terminals('24', '4') = 0.6766761741243248; 
terminals('25', '1') = 0.4976135520146976; terminals('25', '2') = 0.976888807512043; terminals('25', '3') = 0.3527354650547849; terminals('25', '4') = 0.26022239932354696; 
terminals('26', '1') = 0.02089869603951744; terminals('26', '2') = 0.18064654854783613; terminals('26', '3') = 0.6531434026140133; terminals('26', '4') = 0.16877815280695763; 
terminals('27', '1') = 0.8779593397789593; terminals('27', '2') = 0.31952994605271645; terminals('27', '3') = 0.8122725262370806; terminals('27', '4') = 0.23581462716093837; 
terminals('28', '1') = 0.7842438167734226; terminals('28', '2') = 0.5244320347789079; terminals('28', '3') = 0.7673716398276781; terminals('28', '4') = 0.050930251260020265; 
terminals('29', '1') = 0.8319213621243454; terminals('29', '2') = 0.6007744244469179; terminals('29', '3') = 0.22354039420592675; terminals('29', '4') = 0.02969018031833226; 
terminals('30', '1') = 0.5655480290047902; terminals('30', '2') = 0.5562233442379736; terminals('30', '3') = 0.41415299379586157; terminals('30', '4') = 0.4131676816696702; 
terminals('31', '1') = 0.7686206663613182; terminals('31', '2') = 0.15622498016720332; terminals('31', '3') = 0.5787263248618617; terminals('31', '4') = 0.15048975297896872; 
terminals('32', '1') = 0.13132945257799167; terminals('32', '2') = 0.04632760246029044; terminals('32', '3') = 0.763910568955369; terminals('32', '4') = 0.7256677048272328; 
terminals('33', '1') = 0.9402147551422981; terminals('33', '2') = 0.8361941194918164; terminals('33', '3') = 0.15963985126732327; terminals('33', '4') = 0.3933163747529639; 
terminals('34', '1') = 0.3419908538107608; terminals('34', '2') = 0.8899607723703461; terminals('34', '3') = 0.5045252907304003; terminals('34', '4') = 0.8149890929443397; 
terminals('35', '1') = 0.8835913773820666; terminals('35', '2') = 0.5640386686149821; terminals('35', '3') = 0.03250565668862415; terminals('35', '4') = 0.2723235050705626; 
terminals('36', '1') = 0.8702449703434317; terminals('36', '2') = 0.40071150741666495; terminals('36', '3') = 0.8577662747925545; terminals('36', '4') = 0.33718436636394644; 
terminals('37', '1') = 0.9035735228923136; terminals('37', '2') = 0.7768959482374393; terminals('37', '3') = 0.5493591542582895; terminals('37', '4') = 0.1042122728255932; 
terminals('38', '1') = 0.38443163841858885; terminals('38', '2') = 0.2358907514004046; terminals('38', '3') = 0.8713880550534497; terminals('38', '4') = 0.20295848274990425; 
terminals('39', '1') = 0.03935336265603617; terminals('39', '2') = 0.08044729979813825; terminals('39', '3') = 0.7437636393059388; terminals('39', '4') = 0.9098210677134834; 
terminals('40', '1') = 0.27247420981552317; terminals('40', '2') = 0.06799356979165017; terminals('40', '3') = 0.39186561530643593; terminals('40', '4') = 0.6791416164060723; 
terminals('41', '1') = 0.6150489163065032; terminals('41', '2') = 0.7768150869980619; terminals('41', '3') = 0.98459959267252; terminals('41', '4') = 0.1540956806874253; 
terminals('42', '1') = 0.39237875365428077; terminals('42', '2') = 0.16261788898905105; terminals('42', '3') = 0.8835532074781746; terminals('42', '4') = 0.11101005935490138; 
terminals('43', '1') = 0.3253913463102587; terminals('43', '2') = 0.4687380972748747; terminals('43', '3') = 0.34816868945404267; terminals('43', '4') = 0.938667883336953; 
terminals('44', '1') = 0.5139411945760686; terminals('44', '2') = 0.5580829615947299; terminals('44', '3') = 0.29709022169343413; terminals('44', '4') = 0.25332775962602094; 
terminals('45', '1') = 0.31264131738405054; terminals('45', '2') = 0.6926330314424626; terminals('45', '3') = 0.04270301406414212; terminals('45', '4') = 0.09056371162703714; 
terminals('46', '1') = 0.2503149132107303; terminals('46', '2') = 0.8486853674004404; terminals('46', '3') = 0.3816313990262491; terminals('46', '4') = 0.4652041914651769; 
terminals('47', '1') = 0.6575336340575209; terminals('47', '2') = 0.09316138153410625; terminals('47', '3') = 0.6429469110260527; terminals('47', '4') = 0.23929102357280152; 
terminals('48', '1') = 0.1867470821481706; terminals('48', '2') = 0.5525958470131217; terminals('48', '3') = 0.0369948427093012; terminals('48', '4') = 0.9696623651489514; 
terminals('49', '1') = 0.40448848515820324; terminals('49', '2') = 0.593045111408661; terminals('49', '3') = 0.28124508567268525; terminals('49', '4') = 0.913885259324347; 
terminals('50', '1') = 0.9893930839518179; terminals('50', '2') = 0.24150927018805657; terminals('50', '3') = 0.1948195803719841; terminals('50', '4') = 0.7492881907937143; 
terminals('51', '1') = 0.5658424770269935; terminals('51', '2') = 0.14160129282052625; terminals('51', '3') = 0.22524259905220934; terminals('51', '4') = 0.6122517054279317; 
terminals('52', '1') = 0.960030734668562; terminals('52', '2') = 0.5531456600306044; terminals('52', '3') = 0.9221676489285892; terminals('52', '4') = 0.7389094502260896; 
terminals('53', '1') = 0.11710387578229975; terminals('53', '2') = 0.9727455486426109; terminals('53', '3') = 0.8488731841278516; terminals('53', '4') = 0.8467053656903272; 
terminals('54', '1') = 0.09371009287884835; terminals('54', '2') = 0.31411385619969945; terminals('54', '3') = 0.1988284978432644; terminals('54', '4') = 0.48961544211003905; 
terminals('55', '1') = 0.8583561484887641; terminals('55', '2') = 0.3186697464384588; terminals('55', '3') = 0.6688690039382543; terminals('55', '4') = 0.945310479505673; 
terminals('56', '1') = 0.04624981387251337; terminals('56', '2') = 0.231469167293333; terminals('56', '3') = 0.8178163024196056; terminals('56', '4') = 0.02904621642173344; 
terminals('57', '1') = 0.9315040907122351; terminals('57', '2') = 0.7557770948976231; terminals('57', '3') = 0.29745109188198504; terminals('57', '4') = 0.9741736291644159; 
terminals('58', '1') = 0.5284674904595384; terminals('58', '2') = 0.7551993462533833; terminals('58', '3') = 0.5300270799782542; terminals('58', '4') = 0.38184305844838573; 
terminals('59', '1') = 0.6668005549381493; terminals('59', '2') = 0.8811434765989493; terminals('59', '3') = 0.5442813831645835; terminals('59', '4') = 0.3600157236887199; 
terminals('60', '1') = 0.9376821765339066; terminals('60', '2') = 0.3687828622402438; terminals('60', '3') = 0.392932006442667; terminals('60', '4') = 0.33952541461568775; 
terminals('61', '1') = 0.7849014555212018; terminals('61', '2') = 0.22477000594279017; terminals('61', '3') = 0.6254837169277481; terminals('61', '4') = 0.7034892688192731; 
terminals('62', '1') = 0.4247985314136128; terminals('62', '2') = 0.10369414207023708; terminals('62', '3') = 0.28654545614962423; terminals('62', '4') = 0.5021722440245434; 
terminals('63', '1') = 0.3422092502395898; terminals('63', '2') = 0.7935826163050975; terminals('63', '3') = 0.8883883263095201; terminals('63', '4') = 0.5546401634397283; 
terminals('64', '1') = 0.7971530763810396; terminals('64', '2') = 0.6875575338887534; terminals('64', '3') = 0.8063475333256809; terminals('64', '4') = 0.875525331384171; 
terminals('65', '1') = 0.5016179332523351; terminals('65', '2') = 0.38737021369911806; terminals('65', '3') = 0.4626071076281145; terminals('65', '4') = 0.8967522535347754; 
Parameter bigM / 2.0 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
