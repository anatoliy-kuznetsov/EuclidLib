Sets
i Steiner points / 1*73 /
j terminals / 1*75 /
k dimensions / 1*3 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.7000450782567477; terminals('1', '2') = 0.2394849447746733; terminals('1', '3') = 0.7279775715739505; 
terminals('2', '1') = 0.916647952861929; terminals('2', '2') = 0.7016400481377023; terminals('2', '3') = 0.18952416902177693; 
terminals('3', '1') = 0.8823199117831235; terminals('3', '2') = 0.7636713457030768; terminals('3', '3') = 0.14227809738832986; 
terminals('4', '1') = 0.008527872097116918; terminals('4', '2') = 0.18164481071483607; terminals('4', '3') = 0.023865524964543416; 
terminals('5', '1') = 0.692358212737878; terminals('5', '2') = 0.5085117536864288; terminals('5', '3') = 0.9401475323912061; 
terminals('6', '1') = 0.21415446341245425; terminals('6', '2') = 0.291445607571188; terminals('6', '3') = 0.09830249831295412; 
terminals('7', '1') = 0.9869762616337935; terminals('7', '2') = 0.44574498919384786; terminals('7', '3') = 0.13746087693560838; 
terminals('8', '1') = 0.05453580093659971; terminals('8', '2') = 0.7868194462038371; terminals('8', '3') = 0.6777252657016992; 
terminals('9', '1') = 0.13032015691345222; terminals('9', '2') = 0.6219897322370604; terminals('9', '3') = 0.6017875322606928; 
terminals('10', '1') = 0.30977494454417076; terminals('10', '2') = 0.8140812048515104; terminals('10', '3') = 0.6686021989782787; 
terminals('11', '1') = 0.9964978140661794; terminals('11', '2') = 0.5099661556379224; terminals('11', '3') = 0.8693600741310842; 
terminals('12', '1') = 0.29186571148851415; terminals('12', '2') = 0.054111453662097575; terminals('12', '3') = 0.17330928164200832; 
terminals('13', '1') = 0.9729843586393397; terminals('13', '2') = 0.33929936402040783; terminals('13', '3') = 0.1761281781093773; 
terminals('14', '1') = 0.6899727927270032; terminals('14', '2') = 0.5945168109888314; terminals('14', '3') = 0.28808896787259364; 
terminals('15', '1') = 0.8191977512175023; terminals('15', '2') = 0.8510262316614834; terminals('15', '3') = 0.7512001606036997; 
terminals('16', '1') = 0.7390546469257938; terminals('16', '2') = 0.6705852848581687; terminals('16', '3') = 0.3779024289700861; 
terminals('17', '1') = 0.07822601501028748; terminals('17', '2') = 0.84713286325754; terminals('17', '3') = 0.21123109621618463; 
terminals('18', '1') = 0.21817705546280908; terminals('18', '2') = 0.5840737554363552; terminals('18', '3') = 0.9999004669514554; 
terminals('19', '1') = 0.09776670358217099; terminals('19', '2') = 0.7480895748159354; terminals('19', '3') = 0.9373806343249467; 
terminals('20', '1') = 0.1321227288214516; terminals('20', '2') = 0.6088569749521501; terminals('20', '3') = 0.12232623083287397; 
terminals('21', '1') = 0.030331751689569808; terminals('21', '2') = 0.9035955941311934; terminals('21', '3') = 0.7941044083772203; 
terminals('22', '1') = 0.9997288113009181; terminals('22', '2') = 0.8360450026049131; terminals('22', '3') = 0.17755779432400176; 
terminals('23', '1') = 0.5414900888571372; terminals('23', '2') = 0.3285446191886896; terminals('23', '3') = 0.04031113907350625; 
terminals('24', '1') = 0.8036808703387531; terminals('24', '2') = 0.6792448929259501; terminals('24', '3') = 0.08632820699024724; 
terminals('25', '1') = 0.8054666457416383; terminals('25', '2') = 0.3926768319205587; terminals('25', '3') = 0.2436839555396938; 
terminals('26', '1') = 0.49966002196561676; terminals('26', '2') = 0.4966110572519177; terminals('26', '3') = 0.6848866819400203; 
terminals('27', '1') = 0.3221287429266051; terminals('27', '2') = 0.11325947643662382; terminals('27', '3') = 0.42024864703194253; 
terminals('28', '1') = 0.9540437678312349; terminals('28', '2') = 0.0853558808823105; terminals('28', '3') = 0.9515688269099165; 
terminals('29', '1') = 0.2206292121728588; terminals('29', '2') = 0.5682993362602191; terminals('29', '3') = 0.3199891559961596; 
terminals('30', '1') = 0.27105551213669166; terminals('30', '2') = 0.7644883853241868; terminals('30', '3') = 0.023907699435028906; 
terminals('31', '1') = 0.2138340815207841; terminals('31', '2') = 0.16570694000187292; terminals('31', '3') = 0.8510325742219278; 
terminals('32', '1') = 0.47025070949999415; terminals('32', '2') = 0.9415955936461436; terminals('32', '3') = 0.46859122181256174; 
terminals('33', '1') = 0.7044563994302703; terminals('33', '2') = 0.07531934196748702; terminals('33', '3') = 0.17588217877811763; 
terminals('34', '1') = 0.5139240469415074; terminals('34', '2') = 0.21340928031206685; terminals('34', '3') = 0.3239891166636817; 
terminals('35', '1') = 0.06341450200615628; terminals('35', '2') = 0.48477324623755935; terminals('35', '3') = 0.42248699670125456; 
terminals('36', '1') = 0.09136605520810326; terminals('36', '2') = 0.5629998293232065; terminals('36', '3') = 0.8197870960646539; 
terminals('37', '1') = 0.2369274321363315; terminals('37', '2') = 0.0572303591199147; terminals('37', '3') = 0.7597319497303754; 
terminals('38', '1') = 0.13486888291217836; terminals('38', '2') = 0.6290250626467859; terminals('38', '3') = 0.6568957196066607; 
terminals('39', '1') = 0.6015873000132717; terminals('39', '2') = 0.33421840565951133; terminals('39', '3') = 0.8256607757302226; 
terminals('40', '1') = 0.7420115743964193; terminals('40', '2') = 0.13539327370436138; terminals('40', '3') = 0.09574271567862247; 
terminals('41', '1') = 0.1216586055198039; terminals('41', '2') = 0.5175365528432344; terminals('41', '3') = 0.2583429800475434; 
terminals('42', '1') = 0.8285292248189012; terminals('42', '2') = 0.6358793259662966; terminals('42', '3') = 0.1039295611050376; 
terminals('43', '1') = 0.7041147573834082; terminals('43', '2') = 0.7172980458480761; terminals('43', '3') = 0.036611246678236786; 
terminals('44', '1') = 0.40429763194883717; terminals('44', '2') = 0.9635604072947526; terminals('44', '3') = 0.4158028150726306; 
terminals('45', '1') = 0.3370098287861709; terminals('45', '2') = 0.39567791651442685; terminals('45', '3') = 0.10571692052258219; 
terminals('46', '1') = 0.7066326877662078; terminals('46', '2') = 0.3304539470071326; terminals('46', '3') = 0.7015396869389515; 
terminals('47', '1') = 0.6230459679664859; terminals('47', '2') = 0.6312242740562023; terminals('47', '3') = 0.5901489332672668; 
terminals('48', '1') = 0.2333447444726875; terminals('48', '2') = 0.4311589680279426; terminals('48', '3') = 0.681913821529821; 
terminals('49', '1') = 0.3951844445700391; terminals('49', '2') = 0.48926792750726744; terminals('49', '3') = 0.7409598795076401; 
terminals('50', '1') = 0.46399093029904626; terminals('50', '2') = 0.9857840769129829; terminals('50', '3') = 0.22062626013007036; 
terminals('51', '1') = 0.5991996326846302; terminals('51', '2') = 0.06428343319134178; terminals('51', '3') = 0.5939049289099209; 
terminals('52', '1') = 0.9223843842804011; terminals('52', '2') = 0.12643354311992339; terminals('52', '3') = 0.26433017462754793; 
terminals('53', '1') = 0.982397890855148; terminals('53', '2') = 0.6956644026087474; terminals('53', '3') = 0.3038517997559641; 
terminals('54', '1') = 0.8352653246962859; terminals('54', '2') = 0.7915348276565981; terminals('54', '3') = 0.21667557707348473; 
terminals('55', '1') = 0.8044559215444858; terminals('55', '2') = 0.1549621683188107; terminals('55', '3') = 0.28703645153395496; 
terminals('56', '1') = 0.49027872162454234; terminals('56', '2') = 0.16941922284631072; terminals('56', '3') = 0.8968324300570226; 
terminals('57', '1') = 0.9468075672333431; terminals('57', '2') = 0.2817708296801653; terminals('57', '3') = 0.14432708712314757; 
terminals('58', '1') = 0.14582846094416002; terminals('58', '2') = 0.7698724842637626; terminals('58', '3') = 0.716127128482141; 
terminals('59', '1') = 0.41197759393266087; terminals('59', '2') = 0.6259163148755265; terminals('59', '3') = 0.4439610995824348; 
terminals('60', '1') = 0.5163082506080208; terminals('60', '2') = 0.8251769261017192; terminals('60', '3') = 0.160772202968537; 
terminals('61', '1') = 0.2776339159370418; terminals('61', '2') = 0.9913163770950976; terminals('61', '3') = 0.021005281195503933; 
terminals('62', '1') = 0.8019079231354587; terminals('62', '2') = 0.09839193575562344; terminals('62', '3') = 0.8858259721088876; 
terminals('63', '1') = 0.4628527213597887; terminals('63', '2') = 0.8117875810819594; terminals('63', '3') = 0.4800126052330288; 
terminals('64', '1') = 0.5782272536246659; terminals('64', '2') = 0.4913659952382907; terminals('64', '3') = 0.02822076597350187; 
terminals('65', '1') = 0.20499384349028915; terminals('65', '2') = 0.6947516466502546; terminals('65', '3') = 0.2542560252601629; 
terminals('66', '1') = 0.471002023938358; terminals('66', '2') = 0.4663587037249989; terminals('66', '3') = 0.31938562313093133; 
terminals('67', '1') = 0.967384153166505; terminals('67', '2') = 0.6723013441778048; terminals('67', '3') = 0.7884682798571745; 
terminals('68', '1') = 0.95452372945313; terminals('68', '2') = 0.08744992840232857; terminals('68', '3') = 0.5760002563134364; 
terminals('69', '1') = 0.058089063479150216; terminals('69', '2') = 0.2920519286202896; terminals('69', '3') = 0.43114684071684695; 
terminals('70', '1') = 0.3045489785653698; terminals('70', '2') = 0.5511666770477857; terminals('70', '3') = 0.7318954414674298; 
terminals('71', '1') = 0.5345324901563198; terminals('71', '2') = 0.9127030950072822; terminals('71', '3') = 0.5537810558829087; 
terminals('72', '1') = 0.3011231361032999; terminals('72', '2') = 0.6204945285886985; terminals('72', '3') = 0.4088011731322925; 
terminals('73', '1') = 0.5535361652833667; terminals('73', '2') = 0.8445366415391752; terminals('73', '3') = 0.7499126368899339; 
terminals('74', '1') = 0.48571006869374445; terminals('74', '2') = 0.19754274619919443; terminals('74', '3') = 0.45012458007069867; 
terminals('75', '1') = 0.920021368250164; terminals('75', '2') = 0.9613771723853628; terminals('75', '3') = 0.5433223444276609; 
Parameter bigM / 1.7320508075688772 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
