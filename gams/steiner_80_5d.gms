Sets
i Steiner points / 1*78 /
j terminals / 1*80 /
k dimensions / 1*5 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.30768651933894386; terminals('1', '2') = 0.2537958680623499; terminals('1', '3') = 0.8129029727935554; terminals('1', '4') = 0.5659402645310043; terminals('1', '5') = 0.7795295102727396; 
terminals('2', '1') = 0.4583803445942173; terminals('2', '2') = 0.935738047779152; terminals('2', '3') = 0.8505626501354214; terminals('2', '4') = 0.5471057314929944; terminals('2', '5') = 0.9430106494123006; 
terminals('3', '1') = 0.2848524857138498; terminals('3', '2') = 0.21229236320868705; terminals('3', '3') = 0.902787137259264; terminals('3', '4') = 0.9513462941493495; terminals('3', '5') = 0.790468281545228; 
terminals('4', '1') = 0.725417032716593; terminals('4', '2') = 0.04472026873156021; terminals('4', '3') = 0.24955746992969674; terminals('4', '4') = 0.7732762308155692; terminals('4', '5') = 0.006256911051202962; 
terminals('5', '1') = 0.3072172747371531; terminals('5', '2') = 0.22882281548945582; terminals('5', '3') = 0.9334582896130784; terminals('5', '4') = 0.21887363569997398; terminals('5', '5') = 0.09863260457054368; 
terminals('6', '1') = 0.3259489228537791; terminals('6', '2') = 0.9230883200887177; terminals('6', '3') = 0.5964502447126533; terminals('6', '4') = 0.8689802965173425; terminals('6', '5') = 0.7734243528557374; 
terminals('7', '1') = 0.8663668972844281; terminals('7', '2') = 0.9960923383682039; terminals('7', '3') = 0.6374440195200849; terminals('7', '4') = 0.0605906103641789; terminals('7', '5') = 0.09525173327204628; 
terminals('8', '1') = 0.8991197282638466; terminals('8', '2') = 0.548922235660951; terminals('8', '3') = 0.9978162949925327; terminals('8', '4') = 0.6200414917690901; terminals('8', '5') = 0.9951260486785878; 
terminals('9', '1') = 0.4034328273343546; terminals('9', '2') = 0.8917796166978759; terminals('9', '3') = 0.8616961258660821; terminals('9', '4') = 0.899812766260403; terminals('9', '5') = 0.4221244750765185; 
terminals('10', '1') = 0.2834964463206884; terminals('10', '2') = 0.6917911871054089; terminals('10', '3') = 0.6749232613649573; terminals('10', '4') = 0.277217966599122; terminals('10', '5') = 0.7332863285249789; 
terminals('11', '1') = 0.8759016132526537; terminals('11', '2') = 0.8397780635990495; terminals('11', '3') = 0.16724770743450157; terminals('11', '4') = 0.5351585398526069; terminals('11', '5') = 0.7014008455198307; 
terminals('12', '1') = 0.6126463584043891; terminals('12', '2') = 0.23566168736703386; terminals('12', '3') = 0.1516890844986768; terminals('12', '4') = 0.6107993053595159; terminals('12', '5') = 0.9204956298719973; 
terminals('13', '1') = 0.07600592870534695; terminals('13', '2') = 0.794134484139742; terminals('13', '3') = 0.27954417119055786; terminals('13', '4') = 0.3947205886537407; terminals('13', '5') = 0.9449225702249567; 
terminals('14', '1') = 0.7455776667278504; terminals('14', '2') = 0.12327857121592067; terminals('14', '3') = 0.39420197694078674; terminals('14', '4') = 0.43963364255416926; terminals('14', '5') = 0.6699760777224848; 
terminals('15', '1') = 0.725986560165075; terminals('15', '2') = 0.8003404950854692; terminals('15', '3') = 0.3198176803178997; terminals('15', '4') = 0.680631904124216; terminals('15', '5') = 0.5463419013411408; 
terminals('16', '1') = 0.36159034500085463; terminals('16', '2') = 0.45950197444695984; terminals('16', '3') = 0.534856603683225; terminals('16', '4') = 0.8507039689118722; terminals('16', '5') = 0.8677930001230518; 
terminals('17', '1') = 0.30800501702669447; terminals('17', '2') = 0.47567888992308494; terminals('17', '3') = 0.7242212269604228; terminals('17', '4') = 0.4009313808793904; terminals('17', '5') = 0.02633874065030062; 
terminals('18', '1') = 0.7606703933822554; terminals('18', '2') = 0.03478258399157541; terminals('18', '3') = 0.7632631516070435; terminals('18', '4') = 0.1205054673701712; terminals('18', '5') = 0.05993313558581759; 
terminals('19', '1') = 0.32340528126424584; terminals('19', '2') = 0.34410225633039937; terminals('19', '3') = 0.2478681970208393; terminals('19', '4') = 0.754607070093434; terminals('19', '5') = 0.7865650340211188; 
terminals('20', '1') = 0.2073405084439197; terminals('20', '2') = 0.7934829386032218; terminals('20', '3') = 0.6776638293223681; terminals('20', '4') = 0.5796243882903289; terminals('20', '5') = 0.7277473374473251; 
terminals('21', '1') = 0.8183855958289908; terminals('21', '2') = 0.5751930032514113; terminals('21', '3') = 0.0546810899555662; terminals('21', '4') = 0.5898502245411071; terminals('21', '5') = 0.08001049485927281; 
terminals('22', '1') = 0.9917154210298093; terminals('22', '2') = 0.5082605295039815; terminals('22', '3') = 0.5960853005807153; terminals('22', '4') = 0.6305311655106058; terminals('22', '5') = 0.46803502728362556; 
terminals('23', '1') = 0.587652991148417; terminals('23', '2') = 0.3551037512335302; terminals('23', '3') = 0.22062920664393293; terminals('23', '4') = 0.35251678161595057; terminals('23', '5') = 0.6763086977469092; 
terminals('24', '1') = 0.3650380820962107; terminals('24', '2') = 0.5482950481768156; terminals('24', '3') = 0.8890504497658169; terminals('24', '4') = 0.43324557083455095; terminals('24', '5') = 0.14882419885145404; 
terminals('25', '1') = 0.24911909411033661; terminals('25', '2') = 0.5540927359884661; terminals('25', '3') = 0.8820281305138591; terminals('25', '4') = 0.9740930116013747; terminals('25', '5') = 0.046259232468512934; 
terminals('26', '1') = 0.7655737040169776; terminals('26', '2') = 0.7691996827422354; terminals('26', '3') = 0.6528227082033904; terminals('26', '4') = 0.8817328071364817; terminals('26', '5') = 0.10406816526342377; 
terminals('27', '1') = 0.6931207685165801; terminals('27', '2') = 0.5665625636847577; terminals('27', '3') = 0.07850297833805608; terminals('27', '4') = 0.8479495421763021; terminals('27', '5') = 0.14899279551318767; 
terminals('28', '1') = 0.5500640584931823; terminals('28', '2') = 0.23938517177821284; terminals('28', '3') = 0.46900416317180504; terminals('28', '4') = 0.9607190216629823; terminals('28', '5') = 0.2678474793460931; 
terminals('29', '1') = 0.7890080491767512; terminals('29', '2') = 0.9335209703764465; terminals('29', '3') = 0.7845160416822622; terminals('29', '4') = 0.2933740254995244; terminals('29', '5') = 0.46109815006204324; 
terminals('30', '1') = 0.29187533923822184; terminals('30', '2') = 0.13845411722239787; terminals('30', '3') = 0.9564495258923051; terminals('30', '4') = 0.6761092839380812; terminals('30', '5') = 0.7922846324894415; 
terminals('31', '1') = 0.2940737968691821; terminals('31', '2') = 0.6926589389911504; terminals('31', '3') = 0.4251153256769754; terminals('31', '4') = 0.6415615221751126; terminals('31', '5') = 0.9651803664566001; 
terminals('32', '1') = 0.8899005986849097; terminals('32', '2') = 0.8237162811297537; terminals('32', '3') = 0.052474153876580165; terminals('32', '4') = 0.4294005831814345; terminals('32', '5') = 0.2810926025791767; 
terminals('33', '1') = 0.18843123268022577; terminals('33', '2') = 0.8678365838997276; terminals('33', '3') = 0.6241166013878459; terminals('33', '4') = 0.7484131533298953; terminals('33', '5') = 0.909324395615339; 
terminals('34', '1') = 0.1448096223191322; terminals('34', '2') = 0.7803303193859052; terminals('34', '3') = 0.040340025962824266; terminals('34', '4') = 0.7489290387562577; terminals('34', '5') = 0.38942275804751514; 
terminals('35', '1') = 0.08543266419421125; terminals('35', '2') = 0.026617502112248226; terminals('35', '3') = 0.24042148409499953; terminals('35', '4') = 0.007080229587662634; terminals('35', '5') = 0.1527531802675134; 
terminals('36', '1') = 0.3032374362530338; terminals('36', '2') = 0.9628454619024716; terminals('36', '3') = 0.7524745060692616; terminals('36', '4') = 0.45251832134092285; terminals('36', '5') = 0.21057495118499225; 
terminals('37', '1') = 0.9762916536898416; terminals('37', '2') = 0.8919559072939183; terminals('37', '3') = 0.8205844929573787; terminals('37', '4') = 0.47045541915168976; terminals('37', '5') = 0.4075611653861172; 
terminals('38', '1') = 0.18451518103837272; terminals('38', '2') = 0.40730535032344317; terminals('38', '3') = 0.9191206278919202; terminals('38', '4') = 0.5557787604677864; terminals('38', '5') = 0.4123179396424205; 
terminals('39', '1') = 0.3013203450146503; terminals('39', '2') = 0.4449643635573117; terminals('39', '3') = 0.1099218310208867; terminals('39', '4') = 0.7259612113891009; terminals('39', '5') = 0.5420789161593851; 
terminals('40', '1') = 0.2603650011888655; terminals('40', '2') = 0.19272891670923786; terminals('40', '3') = 0.4598582269423003; terminals('40', '4') = 0.8190988157488626; terminals('40', '5') = 0.14761943126631194; 
terminals('41', '1') = 0.9719786603988525; terminals('41', '2') = 0.3744273300644031; terminals('41', '3') = 0.5443483087975071; terminals('41', '4') = 0.006889946099480571; terminals('41', '5') = 0.3337877099570854; 
terminals('42', '1') = 0.5010071990145091; terminals('42', '2') = 0.23522720943484687; terminals('42', '3') = 0.5045702937505634; terminals('42', '4') = 0.028118254768791373; terminals('42', '5') = 0.8502471678442862; 
terminals('43', '1') = 0.3771750859392561; terminals('43', '2') = 0.4993033912712763; terminals('43', '3') = 0.5893309450675185; terminals('43', '4') = 0.5260835422855755; terminals('43', '5') = 0.45067996570618285; 
terminals('44', '1') = 0.9449068071134817; terminals('44', '2') = 0.35718705086032077; terminals('44', '3') = 0.1962781123486772; terminals('44', '4') = 0.02644244498438386; terminals('44', '5') = 0.22257804792877545; 
terminals('45', '1') = 0.6959036483634395; terminals('45', '2') = 0.5482705289311098; terminals('45', '3') = 0.214332265574378; terminals('45', '4') = 0.1265771909149198; terminals('45', '5') = 0.3203364725855271; 
terminals('46', '1') = 0.7266580981374489; terminals('46', '2') = 0.2112490899822851; terminals('46', '3') = 0.25503714796270227; terminals('46', '4') = 0.40853860040617485; terminals('46', '5') = 0.5365163101917959; 
terminals('47', '1') = 0.8814546767398135; terminals('47', '2') = 0.8235378262411811; terminals('47', '3') = 0.023061166969329583; terminals('47', '4') = 0.1970212892326958; terminals('47', '5') = 0.8148852892105645; 
terminals('48', '1') = 0.3941995344068189; terminals('48', '2') = 0.4188165354519655; terminals('48', '3') = 0.5019141545377085; terminals('48', '4') = 0.6969931057873028; terminals('48', '5') = 0.8494669252316382; 
terminals('49', '1') = 0.8891386864872284; terminals('49', '2') = 0.02442353615223325; terminals('49', '3') = 0.8167231464785697; terminals('49', '4') = 0.7211737862453597; terminals('49', '5') = 0.8449048623257763; 
terminals('50', '1') = 0.9464534427742674; terminals('50', '2') = 0.17434643525338533; terminals('50', '3') = 0.2684293332243133; terminals('50', '4') = 0.7270445923306624; terminals('50', '5') = 0.7278946691727464; 
terminals('51', '1') = 0.3893914666465188; terminals('51', '2') = 0.855171017455092; terminals('51', '3') = 0.7564454077712153; terminals('51', '4') = 0.7235725522472645; terminals('51', '5') = 0.7440842086530174; 
terminals('52', '1') = 0.4950213540476054; terminals('52', '2') = 0.5902922789553934; terminals('52', '3') = 0.3521413494131981; terminals('52', '4') = 0.29658357842828587; terminals('52', '5') = 0.7580545770800592; 
terminals('53', '1') = 0.5852357029538093; terminals('53', '2') = 0.1987826165531652; terminals('53', '3') = 0.7983695235113707; terminals('53', '4') = 0.6750572846354982; terminals('53', '5') = 0.9074128621250369; 
terminals('54', '1') = 0.46099271275716136; terminals('54', '2') = 0.9788514715271077; terminals('54', '3') = 0.26367313904193135; terminals('54', '4') = 0.33287999168432436; terminals('54', '5') = 0.18826209727014576; 
terminals('55', '1') = 0.7009132592505231; terminals('55', '2') = 0.4174806415001465; terminals('55', '3') = 0.40962811066980276; terminals('55', '4') = 0.6985491111181049; terminals('55', '5') = 0.6268126502105495; 
terminals('56', '1') = 0.27469029679071744; terminals('56', '2') = 0.7505097688534859; terminals('56', '3') = 0.3496870484596355; terminals('56', '4') = 0.9722771197765924; terminals('56', '5') = 0.5349584679180057; 
terminals('57', '1') = 0.6541129331315982; terminals('57', '2') = 0.10691273135418222; terminals('57', '3') = 0.9078394629336536; terminals('57', '4') = 0.013444641233173238; terminals('57', '5') = 0.7143968474990353; 
terminals('58', '1') = 0.9358077179892371; terminals('58', '2') = 0.38418331825327745; terminals('58', '3') = 0.7360767704435698; terminals('58', '4') = 0.5123290293502794; terminals('58', '5') = 0.5016023212313415; 
terminals('59', '1') = 0.7033938529803678; terminals('59', '2') = 0.6093966668755069; terminals('59', '3') = 0.6592083957770463; terminals('59', '4') = 0.7361679703078566; terminals('59', '5') = 0.8585824871305855; 
terminals('60', '1') = 0.8634295557565536; terminals('60', '2') = 0.004422800321730147; terminals('60', '3') = 0.16834980172986191; terminals('60', '4') = 0.7663383996591302; terminals('60', '5') = 0.5004125615156141; 
terminals('61', '1') = 0.020499010889383773; terminals('61', '2') = 0.960710721417942; terminals('61', '3') = 0.2562699076217705; terminals('61', '4') = 0.971655997080002; terminals('61', '5') = 0.6113786045527259; 
terminals('62', '1') = 0.13314462788295212; terminals('62', '2') = 0.7342801053872202; terminals('62', '3') = 0.7198207787864742; terminals('62', '4') = 0.8246397492755951; terminals('62', '5') = 0.5842884234588824; 
terminals('63', '1') = 0.45691413248422874; terminals('63', '2') = 0.4171077928352741; terminals('63', '3') = 0.5411019621566198; terminals('63', '4') = 0.5000075109485016; terminals('63', '5') = 0.8455017295532418; 
terminals('64', '1') = 0.39783694619241783; terminals('64', '2') = 0.5000751680541995; terminals('64', '3') = 0.9295490141642329; terminals('64', '4') = 0.2834538694040103; terminals('64', '5') = 0.630192607202766; 
terminals('65', '1') = 0.4377531220482639; terminals('65', '2') = 0.9258290733835655; terminals('65', '3') = 0.7340005779894707; terminals('65', '4') = 0.9245319737321399; terminals('65', '5') = 0.35613618808382685; 
terminals('66', '1') = 0.329162225607906; terminals('66', '2') = 0.019994905423918463; terminals('66', '3') = 0.574469310453332; terminals('66', '4') = 0.020274666602318248; terminals('66', '5') = 0.3540286541856732; 
terminals('67', '1') = 0.9935607497044232; terminals('67', '2') = 0.31465992468970194; terminals('67', '3') = 0.5254677291497245; terminals('67', '4') = 0.9839523768514292; terminals('67', '5') = 0.9099006829514306; 
terminals('68', '1') = 0.06276294222350487; terminals('68', '2') = 0.8574308849999163; terminals('68', '3') = 0.3664473322719488; terminals('68', '4') = 0.2118226360560349; terminals('68', '5') = 0.0012155989639601739; 
terminals('69', '1') = 0.8113337527431226; terminals('69', '2') = 0.7652118007049861; terminals('69', '3') = 0.06678459265487158; terminals('69', '4') = 0.04355862629588936; terminals('69', '5') = 0.6048949808446394; 
terminals('70', '1') = 0.5367496059749753; terminals('70', '2') = 0.8122952732455285; terminals('70', '3') = 0.270638865831213; terminals('70', '4') = 0.3358692818342127; terminals('70', '5') = 0.5190995885749915; 
terminals('71', '1') = 0.9938282425565164; terminals('71', '2') = 0.29885112716255113; terminals('71', '3') = 0.8726988215100361; terminals('71', '4') = 0.5674128375982187; terminals('71', '5') = 0.33989760805010316; 
terminals('72', '1') = 0.7214480245903458; terminals('72', '2') = 0.6984475519210315; terminals('72', '3') = 0.9299795854752863; terminals('72', '4') = 0.8067333630784669; terminals('72', '5') = 0.6157077602908803; 
terminals('73', '1') = 0.24387479104075593; terminals('73', '2') = 0.34406792621860904; terminals('73', '3') = 0.4890786499700467; terminals('73', '4') = 0.8602490787585123; terminals('73', '5') = 0.8115950104375227; 
terminals('74', '1') = 0.8331438626725302; terminals('74', '2') = 0.8980288645285213; terminals('74', '3') = 0.10201746130855338; terminals('74', '4') = 0.6974255524330887; terminals('74', '5') = 0.020016340271594713; 
terminals('75', '1') = 0.9760549517082786; terminals('75', '2') = 0.9601549901890197; terminals('75', '3') = 0.9346714132895513; terminals('75', '4') = 0.9385956516000822; terminals('75', '5') = 0.8902354601476402; 
terminals('76', '1') = 0.861706594050599; terminals('76', '2') = 0.334808437937373; terminals('76', '3') = 0.4638707660481356; terminals('76', '4') = 0.07850675387742323; terminals('76', '5') = 0.4001584929670535; 
terminals('77', '1') = 0.819027705701428; terminals('77', '2') = 0.09422841180663422; terminals('77', '3') = 0.4721750282273349; terminals('77', '4') = 0.340481148595154; terminals('77', '5') = 0.9087873441382763; 
terminals('78', '1') = 0.8139470418404867; terminals('78', '2') = 0.22728533391062045; terminals('78', '3') = 0.7899310265626996; terminals('78', '4') = 0.8192197574046588; terminals('78', '5') = 0.04683635346529014; 
terminals('79', '1') = 0.6327088014852063; terminals('79', '2') = 0.1299627344952622; terminals('79', '3') = 0.2592569794321329; terminals('79', '4') = 0.775698537620992; terminals('79', '5') = 0.8484599586348244; 
terminals('80', '1') = 0.887719856494726; terminals('80', '2') = 0.5016933939846495; terminals('80', '3') = 0.020139983034217268; terminals('80', '4') = 0.5509189768040899; terminals('80', '5') = 0.1553103467616389; 
Parameter bigM / 2.23606797749979 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
