Sets
i Steiner points / 1*43 /
j terminals / 1*45 /
k dimensions / 1*3 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.6695350361882403; terminals('1', '2') = 0.6254687133677137; terminals('1', '3') = 0.5827740674937545; 
terminals('2', '1') = 0.48789394120820895; terminals('2', '2') = 0.8209022634164362; terminals('2', '3') = 0.12067570874467715; 
terminals('3', '1') = 0.282914668408617; terminals('3', '2') = 0.5932835849523457; terminals('3', '3') = 0.15247382501853446; 
terminals('4', '1') = 0.6362692584440134; terminals('4', '2') = 0.36114923168496205; terminals('4', '3') = 0.8393511199101306; 
terminals('5', '1') = 0.27180869572392574; terminals('5', '2') = 0.8374797243269323; terminals('5', '3') = 0.933142601480825; 
terminals('6', '1') = 0.281010417915169; terminals('6', '2') = 0.25777080861302404; terminals('6', '3') = 0.03150113070431926; 
terminals('7', '1') = 0.28305691482366535; terminals('7', '2') = 0.2524343951711029; terminals('7', '3') = 0.5225401814781845; 
terminals('8', '1') = 0.978908129629846; terminals('8', '2') = 0.29533869969444404; terminals('8', '3') = 0.7189943549148852; 
terminals('9', '1') = 0.3553208758793258; terminals('9', '2') = 0.3425850575936301; terminals('9', '3') = 0.22975048995246006; 
terminals('10', '1') = 0.8439128024129393; terminals('10', '2') = 0.9674377522045586; terminals('10', '3') = 0.22316762667987255; 
terminals('11', '1') = 0.7179893715787709; terminals('11', '2') = 0.717967091448895; terminals('11', '3') = 0.6947769434490804; 
terminals('12', '1') = 0.3889937815722636; terminals('12', '2') = 0.11778013446823454; terminals('12', '3') = 0.7186831527549611; 
terminals('13', '1') = 0.47297759833369346; terminals('13', '2') = 0.42456515676923445; terminals('13', '3') = 0.7943950467240048; 
terminals('14', '1') = 0.1612564178883763; terminals('14', '2') = 0.23959576142255712; terminals('14', '3') = 0.30336708680189417; 
terminals('15', '1') = 0.9912371802412153; terminals('15', '2') = 0.4825310624599505; terminals('15', '3') = 0.5257957514390238; 
terminals('16', '1') = 0.797309979429091; terminals('16', '2') = 0.32984747946473136; terminals('16', '3') = 0.08149577067945146; 
terminals('17', '1') = 0.28707975033270405; terminals('17', '2') = 0.08036931744417986; terminals('17', '3') = 0.7361492859408345; 
terminals('18', '1') = 0.8142920894562364; terminals('18', '2') = 0.40287267401397686; terminals('18', '3') = 0.03284491221090946; 
terminals('19', '1') = 0.08511011967654059; terminals('19', '2') = 0.12226266158454258; terminals('19', '3') = 0.18346311349248; 
terminals('20', '1') = 0.516319678970926; terminals('20', '2') = 0.012590817128791953; terminals('20', '3') = 0.4466496963093688; 
terminals('21', '1') = 0.37187041108791175; terminals('21', '2') = 0.1552729352561365; terminals('21', '3') = 0.2173049485407773; 
terminals('22', '1') = 0.6640529513018564; terminals('22', '2') = 0.6912409764590567; terminals('22', '3') = 0.21429459575480203; 
terminals('23', '1') = 0.49348146919297553; terminals('23', '2') = 0.8696111830741812; terminals('23', '3') = 0.531182148574801; 
terminals('24', '1') = 0.8032402756441228; terminals('24', '2') = 0.9314406425513925; terminals('24', '3') = 0.4606993808221621; 
terminals('25', '1') = 0.1427853819045598; terminals('25', '2') = 0.017106664203874078; terminals('25', '3') = 0.6098616009696001; 
terminals('26', '1') = 0.9597524179475606; terminals('26', '2') = 0.6116293734846523; terminals('26', '3') = 0.3381121043114935; 
terminals('27', '1') = 0.088859294814286; terminals('27', '2') = 0.7643610046597781; terminals('27', '3') = 0.08922974951689422; 
terminals('28', '1') = 0.6286566766484968; terminals('28', '2') = 0.7506799219937328; terminals('28', '3') = 0.5775122632296453; 
terminals('29', '1') = 0.8400697304633535; terminals('29', '2') = 0.08507966875187278; terminals('29', '3') = 0.10940406632610156; 
terminals('30', '1') = 0.9757192775821655; terminals('30', '2') = 0.5089943042660856; terminals('30', '3') = 0.2804268772190215; 
terminals('31', '1') = 0.7525684236077185; terminals('31', '2') = 0.8561870710198258; terminals('31', '3') = 0.33685186777988274; 
terminals('32', '1') = 0.20777894321229873; terminals('32', '2') = 0.21699155473017873; terminals('32', '3') = 0.6505366633426662; 
terminals('33', '1') = 0.8893918109514898; terminals('33', '2') = 0.25754026084063175; terminals('33', '3') = 0.5371217458137044; 
terminals('34', '1') = 0.1428164768034148; terminals('34', '2') = 0.2614993708434705; terminals('34', '3') = 0.42489598449168686; 
terminals('35', '1') = 0.4955911735966896; terminals('35', '2') = 0.06312354351287586; terminals('35', '3') = 0.878355877383058; 
terminals('36', '1') = 0.8869201974608224; terminals('36', '2') = 0.7561505012992606; terminals('36', '3') = 0.9774866530494637; 
terminals('37', '1') = 0.558478926147618; terminals('37', '2') = 0.26746094419422983; terminals('37', '3') = 0.21753567522073902; 
terminals('38', '1') = 0.475223174485629; terminals('38', '2') = 0.32120590226162726; terminals('38', '3') = 0.557053394439355; 
terminals('39', '1') = 0.3982706812689749; terminals('39', '2') = 0.46191442980300723; terminals('39', '3') = 0.29686973480363554; 
terminals('40', '1') = 0.6175175795039187; terminals('40', '2') = 0.400136927202529; terminals('40', '3') = 0.6279517973268771; 
terminals('41', '1') = 0.35312140115950075; terminals('41', '2') = 0.7883127393397416; terminals('41', '3') = 0.1664199823572713; 
terminals('42', '1') = 0.9549893599544698; terminals('42', '2') = 0.34136777828958376; terminals('42', '3') = 0.7872534826338662; 
terminals('43', '1') = 0.8993992079021113; terminals('43', '2') = 0.076403236415171; terminals('43', '3') = 0.13085540036429533; 
terminals('44', '1') = 0.47236827018630945; terminals('44', '2') = 0.7216148256432533; terminals('44', '3') = 0.19563858448250215; 
terminals('45', '1') = 0.8251982057962626; terminals('45', '2') = 0.3043307381741399; terminals('45', '3') = 0.44911071100871447; 
Parameter bigM / 1.7320508075688772 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
