Sets
i Steiner points / 1*113 /
j terminals / 1*115 /
k dimensions / 1*3 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.7706592178728677; terminals('1', '2') = 0.0057735827906761905; terminals('1', '3') = 0.9995498389755325; 
terminals('2', '1') = 0.10181926331325541; terminals('2', '2') = 0.36774942793376086; terminals('2', '3') = 0.9560117099379959; 
terminals('3', '1') = 0.14952784764009275; terminals('3', '2') = 0.2813517182622104; terminals('3', '3') = 0.6716272896475732; 
terminals('4', '1') = 0.29401657766629485; terminals('4', '2') = 0.6715659077616836; terminals('4', '3') = 0.14388667114821585; 
terminals('5', '1') = 0.7855283514875269; terminals('5', '2') = 0.34339162708506643; terminals('5', '3') = 0.34030290800682994; 
terminals('6', '1') = 0.7807931922623157; terminals('6', '2') = 0.4918772937555397; terminals('6', '3') = 0.8632370117460707; 
terminals('7', '1') = 0.6482630902935297; terminals('7', '2') = 0.6377417309131275; terminals('7', '3') = 0.5862562750558514; 
terminals('8', '1') = 0.6310854425513722; terminals('8', '2') = 0.45089060992516405; terminals('8', '3') = 0.043850522162819705; 
terminals('9', '1') = 0.7172181319348023; terminals('9', '2') = 0.8418561224437177; terminals('9', '3') = 0.9206574693582463; 
terminals('10', '1') = 0.716884096573249; terminals('10', '2') = 0.3610371656083382; terminals('10', '3') = 0.7368337592182778; 
terminals('11', '1') = 0.6258743752006122; terminals('11', '2') = 0.5039581213020577; terminals('11', '3') = 0.5056995937716605; 
terminals('12', '1') = 0.9547762213528403; terminals('12', '2') = 0.8179341327072581; terminals('12', '3') = 0.15623057252173655; 
terminals('13', '1') = 0.7469926048678174; terminals('13', '2') = 0.6574044642649027; terminals('13', '3') = 0.4875570970351105; 
terminals('14', '1') = 0.6273443015430001; terminals('14', '2') = 0.2705373354616597; terminals('14', '3') = 0.6647251600300534; 
terminals('15', '1') = 0.8194965114240501; terminals('15', '2') = 0.826862747759644; terminals('15', '3') = 0.8045703214532082; 
terminals('16', '1') = 0.9597813583721705; terminals('16', '2') = 0.23355068644449317; terminals('16', '3') = 0.14771389384239342; 
terminals('17', '1') = 0.4723494358830548; terminals('17', '2') = 0.6130342905494838; terminals('17', '3') = 0.6147498881337649; 
terminals('18', '1') = 0.10467256594658136; terminals('18', '2') = 0.267731806371887; terminals('18', '3') = 0.7090625949465033; 
terminals('19', '1') = 0.6256140325516624; terminals('19', '2') = 0.13057338467305535; terminals('19', '3') = 0.3116740330378498; 
terminals('20', '1') = 0.12787133489351732; terminals('20', '2') = 0.23841037036196056; terminals('20', '3') = 0.7151712197897854; 
terminals('21', '1') = 0.31047636261099865; terminals('21', '2') = 0.6703732146539427; terminals('21', '3') = 0.5679012110291267; 
terminals('22', '1') = 0.36949109070111064; terminals('22', '2') = 0.9243974317261009; terminals('22', '3') = 0.8424369859584211; 
terminals('23', '1') = 0.8979379147607677; terminals('23', '2') = 0.054191750788153414; terminals('23', '3') = 0.9322323772542234; 
terminals('24', '1') = 0.6073151828418482; terminals('24', '2') = 0.5782453692379342; terminals('24', '3') = 0.5814146622953149; 
terminals('25', '1') = 0.42379650642540134; terminals('25', '2') = 0.6314375558384719; terminals('25', '3') = 0.0872367032704735; 
terminals('26', '1') = 0.06186206871895483; terminals('26', '2') = 0.7267580517824597; terminals('26', '3') = 0.7898290226175523; 
terminals('27', '1') = 0.8974398589690105; terminals('27', '2') = 0.925740814229567; terminals('27', '3') = 0.17346736600848134; 
terminals('28', '1') = 0.9974868969744213; terminals('28', '2') = 0.9600354576800231; terminals('28', '3') = 0.2537921297715652; 
terminals('29', '1') = 0.8336210332795652; terminals('29', '2') = 0.7985236140997674; terminals('29', '3') = 0.33801506512042423; 
terminals('30', '1') = 0.26090808869943116; terminals('30', '2') = 0.2909982911101191; terminals('30', '3') = 0.4936861901122329; 
terminals('31', '1') = 0.600715533684335; terminals('31', '2') = 0.2026370630235882; terminals('31', '3') = 0.6633459784350924; 
terminals('32', '1') = 0.4442982350519542; terminals('32', '2') = 0.48197339657293237; terminals('32', '3') = 0.6436321273093143; 
terminals('33', '1') = 0.36296617962858657; terminals('33', '2') = 0.014098835491569539; terminals('33', '3') = 0.507029737209502; 
terminals('34', '1') = 0.6995639631228959; terminals('34', '2') = 0.7062622109179295; terminals('34', '3') = 0.5070037971912925; 
terminals('35', '1') = 0.09291393911449009; terminals('35', '2') = 0.6221824318215673; terminals('35', '3') = 0.9629208037271728; 
terminals('36', '1') = 0.34317329241306604; terminals('36', '2') = 0.4498240824494196; terminals('36', '3') = 0.4081879074548168; 
terminals('37', '1') = 0.15023635277451064; terminals('37', '2') = 0.68736515938438; terminals('37', '3') = 0.9820264809822533; 
terminals('38', '1') = 0.4050345262371656; terminals('38', '2') = 0.04820861755114236; terminals('38', '3') = 0.2610007820939396; 
terminals('39', '1') = 0.4609736973264059; terminals('39', '2') = 0.7385930437679591; terminals('39', '3') = 0.6360097575158248; 
terminals('40', '1') = 0.38842995191039975; terminals('40', '2') = 0.8595398673944564; terminals('40', '3') = 0.08454934609214482; 
terminals('41', '1') = 0.8569154461057501; terminals('41', '2') = 0.3818810813908441; terminals('41', '3') = 0.03607319511730711; 
terminals('42', '1') = 0.5826893091531908; terminals('42', '2') = 0.1284263023983424; terminals('42', '3') = 0.3423011000202184; 
terminals('43', '1') = 0.7954249188986796; terminals('43', '2') = 0.46923639716087195; terminals('43', '3') = 0.6031301725953606; 
terminals('44', '1') = 0.6592279219217148; terminals('44', '2') = 0.9910609105560172; terminals('44', '3') = 0.14627728984919153; 
terminals('45', '1') = 0.1857188214159864; terminals('45', '2') = 0.035384077912238854; terminals('45', '3') = 0.7556067272237473; 
terminals('46', '1') = 0.19819496835921546; terminals('46', '2') = 0.8051334356141401; terminals('46', '3') = 0.7153621928792184; 
terminals('47', '1') = 0.718692768925066; terminals('47', '2') = 0.06611999041130501; terminals('47', '3') = 0.8255217881807487; 
terminals('48', '1') = 0.5264921429460162; terminals('48', '2') = 0.9914286712863144; terminals('48', '3') = 0.9960140498997304; 
terminals('49', '1') = 0.5370120385272655; terminals('49', '2') = 0.48137364138437644; terminals('49', '3') = 0.4835419393347976; 
terminals('50', '1') = 0.6347525414984617; terminals('50', '2') = 0.2038431621152571; terminals('50', '3') = 0.36906304209805485; 
terminals('51', '1') = 0.8576266116954712; terminals('51', '2') = 0.19173032592180306; terminals('51', '3') = 0.08183736354012339; 
terminals('52', '1') = 0.4886429282919639; terminals('52', '2') = 0.8958733869534461; terminals('52', '3') = 0.7261088818630113; 
terminals('53', '1') = 0.35891902596276815; terminals('53', '2') = 0.47717470201894485; terminals('53', '3') = 0.13843543214860998; 
terminals('54', '1') = 0.40711638144660545; terminals('54', '2') = 0.029043638016717055; terminals('54', '3') = 0.17111933095682552; 
terminals('55', '1') = 0.6890554721828837; terminals('55', '2') = 0.30434697827883905; terminals('55', '3') = 0.33024184466780804; 
terminals('56', '1') = 0.14052308042732942; terminals('56', '2') = 0.22515648179086034; terminals('56', '3') = 0.09134712387315069; 
terminals('57', '1') = 0.4416512926847649; terminals('57', '2') = 0.8497422680948133; terminals('57', '3') = 0.15702292307278765; 
terminals('58', '1') = 0.1570218204051993; terminals('58', '2') = 0.6820284900300553; terminals('58', '3') = 0.28869817964206634; 
terminals('59', '1') = 0.4373742348101546; terminals('59', '2') = 0.08871386029686268; terminals('59', '3') = 0.4047897041145865; 
terminals('60', '1') = 0.6301884086830128; terminals('60', '2') = 0.8102678147508987; terminals('60', '3') = 0.45625900982673195; 
terminals('61', '1') = 0.11159704890246203; terminals('61', '2') = 0.20684884186181174; terminals('61', '3') = 0.36901280420456073; 
terminals('62', '1') = 0.9206952907036614; terminals('62', '2') = 0.03284551354439491; terminals('62', '3') = 0.007851737453741126; 
terminals('63', '1') = 0.2839828877518259; terminals('63', '2') = 0.9845640390276998; terminals('63', '3') = 0.5490190403250288; 
terminals('64', '1') = 0.2030848537068679; terminals('64', '2') = 0.3142347833851875; terminals('64', '3') = 0.509038863794783; 
terminals('65', '1') = 0.5848307807595657; terminals('65', '2') = 0.20538129696091045; terminals('65', '3') = 0.14553494022854496; 
terminals('66', '1') = 0.7347891436538007; terminals('66', '2') = 0.7760209422234063; terminals('66', '3') = 0.9897231971587975; 
terminals('67', '1') = 0.4946685291438131; terminals('67', '2') = 0.7752524467111291; terminals('67', '3') = 0.35029769126440924; 
terminals('68', '1') = 0.1544205389157428; terminals('68', '2') = 0.34573153824084457; terminals('68', '3') = 0.4328393837736796; 
terminals('69', '1') = 0.08944996355998536; terminals('69', '2') = 0.37263067319597665; terminals('69', '3') = 0.902991582200765; 
terminals('70', '1') = 0.8338414537035295; terminals('70', '2') = 0.2084075084294389; terminals('70', '3') = 0.05139277575914625; 
terminals('71', '1') = 0.5201932947839781; terminals('71', '2') = 0.44976111072794667; terminals('71', '3') = 0.7280380082909186; 
terminals('72', '1') = 0.8486970963861172; terminals('72', '2') = 0.33608334979771104; terminals('72', '3') = 0.3474212722247012; 
terminals('73', '1') = 0.8481416158113892; terminals('73', '2') = 0.1492046976975807; terminals('73', '3') = 0.005030009592970508; 
terminals('74', '1') = 0.8976656084923524; terminals('74', '2') = 0.2863321412001356; terminals('74', '3') = 0.15608989798374584; 
terminals('75', '1') = 0.5096874781666143; terminals('75', '2') = 0.10166253618323584; terminals('75', '3') = 0.5875176865946962; 
terminals('76', '1') = 0.6670022893034826; terminals('76', '2') = 0.3050708212278026; terminals('76', '3') = 0.7864829187297817; 
terminals('77', '1') = 0.13257511677192502; terminals('77', '2') = 0.09933572456191819; terminals('77', '3') = 0.3813564822915798; 
terminals('78', '1') = 0.7904051130344821; terminals('78', '2') = 0.6290326204077334; terminals('78', '3') = 0.5076381206844504; 
terminals('79', '1') = 0.9204011199349129; terminals('79', '2') = 0.9203514538702057; terminals('79', '3') = 0.35359123019073424; 
terminals('80', '1') = 0.49848115786416347; terminals('80', '2') = 0.5108883590199603; terminals('80', '3') = 0.42750277419300453; 
terminals('81', '1') = 0.3157105741481525; terminals('81', '2') = 0.425331543642295; terminals('81', '3') = 0.6046506814337325; 
terminals('82', '1') = 0.8341785437273755; terminals('82', '2') = 0.5741617416502248; terminals('82', '3') = 0.007436052402006621; 
terminals('83', '1') = 0.8327291952144208; terminals('83', '2') = 0.5084289128301399; terminals('83', '3') = 0.4260807282828175; 
terminals('84', '1') = 0.9552799665385534; terminals('84', '2') = 0.8527448088449261; terminals('84', '3') = 0.15294879345938261; 
terminals('85', '1') = 0.22594411199827058; terminals('85', '2') = 0.4339631343155138; terminals('85', '3') = 0.6066856771371952; 
terminals('86', '1') = 0.7647892045662679; terminals('86', '2') = 0.008120819771898713; terminals('86', '3') = 0.3797447009518983; 
terminals('87', '1') = 0.5859034640421323; terminals('87', '2') = 0.2639593338440166; terminals('87', '3') = 0.30479997912034495; 
terminals('88', '1') = 0.3871432486779157; terminals('88', '2') = 0.7502779147767252; terminals('88', '3') = 0.6135748441990057; 
terminals('89', '1') = 0.9696912923562442; terminals('89', '2') = 0.0610424285013238; terminals('89', '3') = 0.7306007591520416; 
terminals('90', '1') = 0.26146903957449164; terminals('90', '2') = 0.9975983136663963; terminals('90', '3') = 0.7348161601481399; 
terminals('91', '1') = 0.575492090810361; terminals('91', '2') = 0.09423766985680637; terminals('91', '3') = 0.6002173370110787; 
terminals('92', '1') = 0.4693207929335331; terminals('92', '2') = 0.4831861078085149; terminals('92', '3') = 0.8799192833697659; 
terminals('93', '1') = 0.7782497396329009; terminals('93', '2') = 0.17791094528066098; terminals('93', '3') = 0.4651646459819023; 
terminals('94', '1') = 0.6456363735085944; terminals('94', '2') = 0.8541930597073628; terminals('94', '3') = 0.583416872133648; 
terminals('95', '1') = 0.206710409756796; terminals('95', '2') = 0.39484045208112206; terminals('95', '3') = 0.29498152089230456; 
terminals('96', '1') = 0.5188559396784059; terminals('96', '2') = 0.2961807974021029; terminals('96', '3') = 0.4751238935981583; 
terminals('97', '1') = 0.1302735690224256; terminals('97', '2') = 0.6575662494673837; terminals('97', '3') = 0.9352386827750292; 
terminals('98', '1') = 0.6624959686481608; terminals('98', '2') = 0.19724511788590215; terminals('98', '3') = 0.1801631287342662; 
terminals('99', '1') = 0.853378123117441; terminals('99', '2') = 0.2852945071481279; terminals('99', '3') = 0.5908106008066407; 
terminals('100', '1') = 0.06809206145494029; terminals('100', '2') = 0.11205340388486063; terminals('100', '3') = 0.10891294163243714; 
terminals('101', '1') = 0.38334952898024166; terminals('101', '2') = 0.7838365401137701; terminals('101', '3') = 0.1196577098239312; 
terminals('102', '1') = 0.6901587935229633; terminals('102', '2') = 0.9345624678197264; terminals('102', '3') = 0.5705546216548638; 
terminals('103', '1') = 0.9376674299609845; terminals('103', '2') = 0.6377311988137595; terminals('103', '3') = 0.09483864002283737; 
terminals('104', '1') = 0.7742224593161308; terminals('104', '2') = 0.7480213241564079; terminals('104', '3') = 0.9683280789245271; 
terminals('105', '1') = 0.8364545416749494; terminals('105', '2') = 0.5870493787619834; terminals('105', '3') = 0.7819844553073255; 
terminals('106', '1') = 0.16421187226338751; terminals('106', '2') = 0.07186203955477644; terminals('106', '3') = 0.4010882741817945; 
terminals('107', '1') = 0.5271529433228132; terminals('107', '2') = 0.7897220840689696; terminals('107', '3') = 0.28260007881041405; 
terminals('108', '1') = 0.6383763672915787; terminals('108', '2') = 0.8021023868808621; terminals('108', '3') = 0.4051970738095493; 
terminals('109', '1') = 0.3994498678985391; terminals('109', '2') = 0.8653196094325445; terminals('109', '3') = 0.8944362245824377; 
terminals('110', '1') = 0.4150186223527791; terminals('110', '2') = 0.0653722624168539; terminals('110', '3') = 0.25239768085551695; 
terminals('111', '1') = 0.5750796733282115; terminals('111', '2') = 0.8204988693051373; terminals('111', '3') = 0.8186929465887326; 
terminals('112', '1') = 0.8810023710817343; terminals('112', '2') = 0.1357601553990223; terminals('112', '3') = 0.7258143936153595; 
terminals('113', '1') = 0.8023575536678831; terminals('113', '2') = 0.9026460544707765; terminals('113', '3') = 0.3696055104332602; 
terminals('114', '1') = 0.06083564009075526; terminals('114', '2') = 0.7141106775265749; terminals('114', '3') = 0.34591238125247625; 
terminals('115', '1') = 0.24048745215865774; terminals('115', '2') = 0.36114769877600716; terminals('115', '3') = 0.25729793753404284; 
Parameter bigM / 1.7320508075688772 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
