Sets
i Steiner points / 1*108 /
j terminals / 1*110 /
k dimensions / 1*4 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.12425804697951648; terminals('1', '2') = 0.082758112222302; terminals('1', '3') = 0.30120980705277045; terminals('1', '4') = 0.2954508381634292; 
terminals('2', '1') = 0.20712260306185537; terminals('2', '2') = 0.06033536289207253; terminals('2', '3') = 0.5515486123545684; terminals('2', '4') = 0.5661486703111976; 
terminals('3', '1') = 0.6066035507779123; terminals('3', '2') = 0.6420259262503005; terminals('3', '3') = 0.23295963992737412; terminals('3', '4') = 0.39542183297557754; 
terminals('4', '1') = 0.08433350482208302; terminals('4', '2') = 0.242872520833595; terminals('4', '3') = 0.09944362539683937; terminals('4', '4') = 0.29269740083644036; 
terminals('5', '1') = 0.3967177425444327; terminals('5', '2') = 0.8531663532162437; terminals('5', '3') = 0.7333919529268166; terminals('5', '4') = 0.7825052466865459; 
terminals('6', '1') = 0.40166187099833883; terminals('6', '2') = 0.4410566217141827; terminals('6', '3') = 0.3114098507047942; terminals('6', '4') = 0.9760311035081537; 
terminals('7', '1') = 0.9891300975394858; terminals('7', '2') = 0.5334900387888333; terminals('7', '3') = 0.7025118282237356; terminals('7', '4') = 0.3881400219171346; 
terminals('8', '1') = 0.42191322877218107; terminals('8', '2') = 0.12498550886897841; terminals('8', '3') = 0.13412191367642634; terminals('8', '4') = 0.9025357042836055; 
terminals('9', '1') = 0.7344712465285531; terminals('9', '2') = 0.7071912153345155; terminals('9', '3') = 0.0010490269714368283; terminals('9', '4') = 0.8254857815702983; 
terminals('10', '1') = 0.9855088593154455; terminals('10', '2') = 0.18971182592368385; terminals('10', '3') = 0.2692541155888766; terminals('10', '4') = 0.332271773984287; 
terminals('11', '1') = 0.1337161064684892; terminals('11', '2') = 0.4306128174526459; terminals('11', '3') = 0.26805626765939683; terminals('11', '4') = 0.8687987391632874; 
terminals('12', '1') = 0.56902255025672; terminals('12', '2') = 0.8776922800152916; terminals('12', '3') = 0.17872226742913222; terminals('12', '4') = 0.3130947659903913; 
terminals('13', '1') = 0.8324305867765903; terminals('13', '2') = 0.7486079501111431; terminals('13', '3') = 0.9133953845239413; terminals('13', '4') = 0.5004555703715713; 
terminals('14', '1') = 0.02527246705235342; terminals('14', '2') = 0.9052328821963329; terminals('14', '3') = 0.985705707746825; terminals('14', '4') = 0.9516193992518295; 
terminals('15', '1') = 0.15875442302022857; terminals('15', '2') = 0.24775672724139863; terminals('15', '3') = 0.3077386583342496; terminals('15', '4') = 0.20134169052806428; 
terminals('16', '1') = 0.6929834309950533; terminals('16', '2') = 0.2400915128333947; terminals('16', '3') = 0.8248584754586153; terminals('16', '4') = 0.7555865926121921; 
terminals('17', '1') = 0.9133081401191376; terminals('17', '2') = 0.7477799458451803; terminals('17', '3') = 0.8763609399629724; terminals('17', '4') = 0.6479422148724104; 
terminals('18', '1') = 0.2150296759120669; terminals('18', '2') = 0.19130963880324126; terminals('18', '3') = 0.9987643457822267; terminals('18', '4') = 0.8374976059271351; 
terminals('19', '1') = 0.9670472083804499; terminals('19', '2') = 0.1523476306587035; terminals('19', '3') = 0.8864807204855856; terminals('19', '4') = 0.37075439999655235; 
terminals('20', '1') = 0.4579520598187654; terminals('20', '2') = 0.662939644177187; terminals('20', '3') = 0.39240617688465596; terminals('20', '4') = 0.44044281743248614; 
terminals('21', '1') = 0.4178314219496241; terminals('21', '2') = 0.356573888401172; terminals('21', '3') = 0.015459474186992006; terminals('21', '4') = 0.4323997316389252; 
terminals('22', '1') = 0.1999107679734593; terminals('22', '2') = 0.3228825514316801; terminals('22', '3') = 0.3920499001603879; terminals('22', '4') = 0.777025906745516; 
terminals('23', '1') = 0.23431037052063786; terminals('23', '2') = 0.9079503661657823; terminals('23', '3') = 0.6646609349809683; terminals('23', '4') = 0.3282310846576597; 
terminals('24', '1') = 0.12440255509846898; terminals('24', '2') = 0.9811818627494069; terminals('24', '3') = 0.5014409204668379; terminals('24', '4') = 0.6692862703744832; 
terminals('25', '1') = 0.42999964791268264; terminals('25', '2') = 0.9771788291803234; terminals('25', '3') = 0.16990059437103544; terminals('25', '4') = 0.1045230709039926; 
terminals('26', '1') = 0.34584145237212616; terminals('26', '2') = 0.05799153382182176; terminals('26', '3') = 0.132719145674569; terminals('26', '4') = 0.01115033949415567; 
terminals('27', '1') = 0.790437942600486; terminals('27', '2') = 0.8782251952312218; terminals('27', '3') = 0.43380729220877856; terminals('27', '4') = 0.7384272327318032; 
terminals('28', '1') = 0.5069347523852279; terminals('28', '2') = 0.9679337884958303; terminals('28', '3') = 0.47233310110023097; terminals('28', '4') = 0.5970969447673973; 
terminals('29', '1') = 0.8809052468138288; terminals('29', '2') = 0.6308473841245137; terminals('29', '3') = 0.7974634075793038; terminals('29', '4') = 0.7593242062863429; 
terminals('30', '1') = 0.19579456560948583; terminals('30', '2') = 0.5056915002776269; terminals('30', '3') = 0.3957887467161142; terminals('30', '4') = 0.9566230622531728; 
terminals('31', '1') = 0.9388386814213261; terminals('31', '2') = 0.6722170268347925; terminals('31', '3') = 0.6931922510690698; terminals('31', '4') = 0.1329144305160822; 
terminals('32', '1') = 0.6361385819058815; terminals('32', '2') = 0.7022574881017961; terminals('32', '3') = 0.3817945961901805; terminals('32', '4') = 0.44486149920487883; 
terminals('33', '1') = 0.3416015805026199; terminals('33', '2') = 0.019648074576283148; terminals('33', '3') = 0.05872709635635531; terminals('33', '4') = 0.1301562134592842; 
terminals('34', '1') = 0.3902112349811181; terminals('34', '2') = 0.37384913793625296; terminals('34', '3') = 0.993011478267402; terminals('34', '4') = 0.32941460693687474; 
terminals('35', '1') = 0.31141269350644274; terminals('35', '2') = 0.3899686472310435; terminals('35', '3') = 0.9704193638769087; terminals('35', '4') = 0.6670706524410575; 
terminals('36', '1') = 0.31171854980435754; terminals('36', '2') = 0.5817844078656397; terminals('36', '3') = 0.5566133673681408; terminals('36', '4') = 0.064501588755571; 
terminals('37', '1') = 0.9409841794979671; terminals('37', '2') = 0.9178328735441447; terminals('37', '3') = 0.391723954406083; terminals('37', '4') = 0.2509103685128762; 
terminals('38', '1') = 0.6737149934452635; terminals('38', '2') = 0.7017952086067827; terminals('38', '3') = 0.1959330783332871; terminals('38', '4') = 0.574759326467484; 
terminals('39', '1') = 0.14977594790169546; terminals('39', '2') = 0.01579346895840683; terminals('39', '3') = 0.8248400240617255; terminals('39', '4') = 0.37597490945433476; 
terminals('40', '1') = 0.8417717606653773; terminals('40', '2') = 0.9896515250279593; terminals('40', '3') = 0.7411326797309601; terminals('40', '4') = 0.2443379098944154; 
terminals('41', '1') = 0.25825860534950784; terminals('41', '2') = 0.6275710378088868; terminals('41', '3') = 0.8257758665003327; terminals('41', '4') = 0.8187255009835542; 
terminals('42', '1') = 0.6366334009784266; terminals('42', '2') = 0.3532604218735925; terminals('42', '3') = 0.5980859527067124; terminals('42', '4') = 0.1320048004289307; 
terminals('43', '1') = 0.5972690077248597; terminals('43', '2') = 0.5426738312913206; terminals('43', '3') = 0.4857584725138613; terminals('43', '4') = 0.11682831763930945; 
terminals('44', '1') = 0.6274153152698984; terminals('44', '2') = 0.22473851138819656; terminals('44', '3') = 0.69638452649439; terminals('44', '4') = 0.4567259690419371; 
terminals('45', '1') = 0.02570780827571839; terminals('45', '2') = 0.7957137740850471; terminals('45', '3') = 0.10776896179756124; terminals('45', '4') = 0.2509373219666443; 
terminals('46', '1') = 0.9064493772853142; terminals('46', '2') = 0.14143149420786838; terminals('46', '3') = 0.6960165730945203; terminals('46', '4') = 0.5693074431278877; 
terminals('47', '1') = 0.8974801469026629; terminals('47', '2') = 0.43409761986873385; terminals('47', '3') = 0.37668119319332716; terminals('47', '4') = 0.9744420595658158; 
terminals('48', '1') = 0.0917447257779831; terminals('48', '2') = 0.19343292514223154; terminals('48', '3') = 0.893708458547298; terminals('48', '4') = 0.505644451301809; 
terminals('49', '1') = 0.569488882260678; terminals('49', '2') = 0.4762352030507596; terminals('49', '3') = 0.5075454198979451; terminals('49', '4') = 0.40957756432341397; 
terminals('50', '1') = 0.07897524786247212; terminals('50', '2') = 0.5545741472362299; terminals('50', '3') = 0.8123746626843701; terminals('50', '4') = 0.9834671736559729; 
terminals('51', '1') = 0.8826352753633532; terminals('51', '2') = 0.5385884545055883; terminals('51', '3') = 0.7012313932505038; terminals('51', '4') = 0.3797110807727181; 
terminals('52', '1') = 0.9209921168507522; terminals('52', '2') = 0.3943194022784089; terminals('52', '3') = 0.7371144299463852; terminals('52', '4') = 0.6528510804512451; 
terminals('53', '1') = 0.3811394243120406; terminals('53', '2') = 0.9008486497541832; terminals('53', '3') = 0.29277134423171947; terminals('53', '4') = 0.6069087837602671; 
terminals('54', '1') = 0.3625015327707142; terminals('54', '2') = 0.14369959767769513; terminals('54', '3') = 0.36158985683021083; terminals('54', '4') = 0.6133925992495494; 
terminals('55', '1') = 0.41925510633341556; terminals('55', '2') = 0.7490520353068258; terminals('55', '3') = 0.05525841978707202; terminals('55', '4') = 0.9271558848830774; 
terminals('56', '1') = 0.921482003073166; terminals('56', '2') = 0.8307792793526216; terminals('56', '3') = 0.8362218565252425; terminals('56', '4') = 0.3189048102741555; 
terminals('57', '1') = 0.6051712875950832; terminals('57', '2') = 0.7663936752812137; terminals('57', '3') = 0.10544138978539097; terminals('57', '4') = 0.6125373426861308; 
terminals('58', '1') = 0.8332762399409213; terminals('58', '2') = 0.20350581883524643; terminals('58', '3') = 0.6918550818697532; terminals('58', '4') = 0.1517864315023868; 
terminals('59', '1') = 0.8163635402668336; terminals('59', '2') = 0.17297503443001827; terminals('59', '3') = 0.8801156491401574; terminals('59', '4') = 0.8092672939089578; 
terminals('60', '1') = 0.7495677208994859; terminals('60', '2') = 0.4493005029891418; terminals('60', '3') = 0.7686133693554708; terminals('60', '4') = 0.6943306827484783; 
terminals('61', '1') = 0.40107893724343247; terminals('61', '2') = 0.39398172019788613; terminals('61', '3') = 0.5415452325161989; terminals('61', '4') = 0.7020843942112002; 
terminals('62', '1') = 0.9354360810636579; terminals('62', '2') = 0.9533662837924547; terminals('62', '3') = 0.7375680807948966; terminals('62', '4') = 0.005269846484001861; 
terminals('63', '1') = 0.4950828816939854; terminals('63', '2') = 0.513442482983264; terminals('63', '3') = 0.5753656059513736; terminals('63', '4') = 0.3751324549343378; 
terminals('64', '1') = 0.018213395874614347; terminals('64', '2') = 0.0669191273899008; terminals('64', '3') = 0.39847087026796024; terminals('64', '4') = 0.5689153589183747; 
terminals('65', '1') = 0.7388451460134826; terminals('65', '2') = 0.12765721066669133; terminals('65', '3') = 0.4868595636181763; terminals('65', '4') = 0.5835246921395947; 
terminals('66', '1') = 0.7673251377625225; terminals('66', '2') = 0.8412403127378592; terminals('66', '3') = 0.5666460096909411; terminals('66', '4') = 0.7107347143359967; 
terminals('67', '1') = 0.3703713473463871; terminals('67', '2') = 0.8183936953328727; terminals('67', '3') = 0.46475210636432074; terminals('67', '4') = 0.5211422201663317; 
terminals('68', '1') = 0.3978544583903183; terminals('68', '2') = 0.4580349123621774; terminals('68', '3') = 0.3488159240106715; terminals('68', '4') = 0.13596658693868335; 
terminals('69', '1') = 0.01822102639284351; terminals('69', '2') = 0.31307355792692704; terminals('69', '3') = 0.7420285638752008; terminals('69', '4') = 0.6223814604342878; 
terminals('70', '1') = 0.9781418199626134; terminals('70', '2') = 0.724886169913707; terminals('70', '3') = 0.17323521722094548; terminals('70', '4') = 0.5108834659391162; 
terminals('71', '1') = 0.43212238037263506; terminals('71', '2') = 0.862665933538261; terminals('71', '3') = 0.8850653820094638; terminals('71', '4') = 0.5526717053744244; 
terminals('72', '1') = 0.838914886952538; terminals('72', '2') = 0.3552600318765483; terminals('72', '3') = 0.27809593393632714; terminals('72', '4') = 0.6172784696266498; 
terminals('73', '1') = 0.49275025217751633; terminals('73', '2') = 0.899382850418644; terminals('73', '3') = 0.9780712692618719; terminals('73', '4') = 0.2797199232933303; 
terminals('74', '1') = 0.48927522918370425; terminals('74', '2') = 0.9096104459255017; terminals('74', '3') = 0.4589681270359649; terminals('74', '4') = 0.520242644529998; 
terminals('75', '1') = 0.22160299174137688; terminals('75', '2') = 0.8001708919737033; terminals('75', '3') = 0.1711458666604957; terminals('75', '4') = 0.5336953916084063; 
terminals('76', '1') = 0.5314228147872361; terminals('76', '2') = 0.9422910264046913; terminals('76', '3') = 0.011847675739045771; terminals('76', '4') = 0.06052203699783887; 
terminals('77', '1') = 0.7486324916658125; terminals('77', '2') = 0.7597070331693399; terminals('77', '3') = 0.5896339328157728; terminals('77', '4') = 0.4327600430217119; 
terminals('78', '1') = 0.42121839541233175; terminals('78', '2') = 0.46791856489914685; terminals('78', '3') = 0.0028274345496226427; terminals('78', '4') = 0.6573588384921945; 
terminals('79', '1') = 0.9645427057288412; terminals('79', '2') = 0.11724553883179811; terminals('79', '3') = 0.7533260001735755; terminals('79', '4') = 0.028075402991060816; 
terminals('80', '1') = 0.11766454890147338; terminals('80', '2') = 0.1140828516244794; terminals('80', '3') = 0.045179951038625044; terminals('80', '4') = 0.07536604620753684; 
terminals('81', '1') = 0.825010980015481; terminals('81', '2') = 0.9427627709710314; terminals('81', '3') = 0.512958164479288; terminals('81', '4') = 0.5788191118272681; 
terminals('82', '1') = 0.21318212894213606; terminals('82', '2') = 0.8998560055816583; terminals('82', '3') = 0.02382966867733116; terminals('82', '4') = 0.922362485894565; 
terminals('83', '1') = 0.9112105370330722; terminals('83', '2') = 0.5670893454614385; terminals('83', '3') = 0.3934961829010606; terminals('83', '4') = 0.5337069218091905; 
terminals('84', '1') = 0.8591424936362883; terminals('84', '2') = 0.3585262073943454; terminals('84', '3') = 0.6904966988072998; terminals('84', '4') = 0.6243599901118404; 
terminals('85', '1') = 0.613821894073027; terminals('85', '2') = 0.9402282050723044; terminals('85', '3') = 0.5909264837711375; terminals('85', '4') = 0.13178451445159467; 
terminals('86', '1') = 0.5503502794655526; terminals('86', '2') = 0.017699442065644; terminals('86', '3') = 0.4982176460702106; terminals('86', '4') = 0.5983327144330267; 
terminals('87', '1') = 0.3541196194466486; terminals('87', '2') = 0.13649298656296827; terminals('87', '3') = 0.8628278518822271; terminals('87', '4') = 0.6914724415012642; 
terminals('88', '1') = 0.31540985948283295; terminals('88', '2') = 0.42556658921833235; terminals('88', '3') = 0.024095150103079055; terminals('88', '4') = 0.23388857980879318; 
terminals('89', '1') = 0.7867969818817387; terminals('89', '2') = 0.208178818584965; terminals('89', '3') = 0.41701426989114987; terminals('89', '4') = 0.5792151792972815; 
terminals('90', '1') = 0.44226662484400503; terminals('90', '2') = 0.7314006652429171; terminals('90', '3') = 0.5070065608916134; terminals('90', '4') = 0.27710627753191763; 
terminals('91', '1') = 0.8892544682253246; terminals('91', '2') = 0.08750211256501694; terminals('91', '3') = 0.8930468521163404; terminals('91', '4') = 0.25414770909117335; 
terminals('92', '1') = 0.6795777716271356; terminals('92', '2') = 0.6781570948859263; terminals('92', '3') = 0.3319772233227464; terminals('92', '4') = 0.6641608242365983; 
terminals('93', '1') = 0.7103201059464415; terminals('93', '2') = 0.5307804318182172; terminals('93', '3') = 0.9688840213890184; terminals('93', '4') = 0.7901256683752236; 
terminals('94', '1') = 0.2866589679532979; terminals('94', '2') = 0.022212872321172528; terminals('94', '3') = 0.5192700676757555; terminals('94', '4') = 0.9889115054969883; 
terminals('95', '1') = 0.7387372293851528; terminals('95', '2') = 0.7097871871103478; terminals('95', '3') = 0.5845624173037359; terminals('95', '4') = 0.4057386037490155; 
terminals('96', '1') = 0.8102769768561551; terminals('96', '2') = 0.4847397248656038; terminals('96', '3') = 0.25821430409503243; terminals('96', '4') = 0.774415128167437; 
terminals('97', '1') = 0.5808011682940604; terminals('97', '2') = 0.09121903072888804; terminals('97', '3') = 0.834886231662943; terminals('97', '4') = 0.09724279542083303; 
terminals('98', '1') = 0.08265866231442642; terminals('98', '2') = 0.5278923107582502; terminals('98', '3') = 0.4168225822314291; terminals('98', '4') = 0.7469251387957091; 
terminals('99', '1') = 0.6111135565246311; terminals('99', '2') = 0.9523566722840527; terminals('99', '3') = 0.610796109798942; terminals('99', '4') = 0.11886606775806152; 
terminals('100', '1') = 0.20770408320934297; terminals('100', '2') = 0.5216254867440931; terminals('100', '3') = 0.4025687832961202; terminals('100', '4') = 0.7114434238531919; 
terminals('101', '1') = 0.3519925157148518; terminals('101', '2') = 0.19939301353197036; terminals('101', '3') = 0.9371662814418953; terminals('101', '4') = 0.6303086626128555; 
terminals('102', '1') = 0.48517544493390374; terminals('102', '2') = 0.6952757829523273; terminals('102', '3') = 0.5146515004849938; terminals('102', '4') = 0.025610004055285907; 
terminals('103', '1') = 0.5062898029534982; terminals('103', '2') = 0.37215684731134624; terminals('103', '3') = 0.3076850565713688; terminals('103', '4') = 0.10676870426578422; 
terminals('104', '1') = 0.9987110729492172; terminals('104', '2') = 0.765667582786383; terminals('104', '3') = 0.17637345157539674; terminals('104', '4') = 0.6377223552880832; 
terminals('105', '1') = 0.811525677867429; terminals('105', '2') = 0.5656360501477814; terminals('105', '3') = 0.6199388064422909; terminals('105', '4') = 0.6161323088056566; 
terminals('106', '1') = 0.7376718821803631; terminals('106', '2') = 0.9167818343001555; terminals('106', '3') = 0.9534378461741988; terminals('106', '4') = 0.0996991060398228; 
terminals('107', '1') = 0.36899734854839483; terminals('107', '2') = 0.22867362556041726; terminals('107', '3') = 0.756392730640265; terminals('107', '4') = 0.790806825975945; 
terminals('108', '1') = 0.8525294736610046; terminals('108', '2') = 0.22900891791487732; terminals('108', '3') = 0.07501333278751865; terminals('108', '4') = 0.643691459285224; 
terminals('109', '1') = 0.38544295169636444; terminals('109', '2') = 0.8062239538949569; terminals('109', '3') = 0.274905126747895; terminals('109', '4') = 0.23433740470474707; 
terminals('110', '1') = 0.8006644178694232; terminals('110', '2') = 0.47654592310911226; terminals('110', '3') = 0.028249572503526332; terminals('110', '4') = 0.41819196937969616; 
Parameter bigM / 2.0 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
