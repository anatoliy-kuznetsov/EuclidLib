Sets
i Steiner points / 1*93 /
j terminals / 1*95 /
k dimensions / 1*2 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.07458726442278918; terminals('1', '2') = 0.7517550612636806; 
terminals('2', '1') = 0.8933339519011296; terminals('2', '2') = 0.20812612937758446; 
terminals('3', '1') = 0.4726872100996795; terminals('3', '2') = 0.9543384766141204; 
terminals('4', '1') = 0.15453317080002338; terminals('4', '2') = 0.8807281010330265; 
terminals('5', '1') = 0.7931314915140215; terminals('5', '2') = 0.9897260109316676; 
terminals('6', '1') = 0.05563345243890416; terminals('6', '2') = 0.9357104639324126; 
terminals('7', '1') = 0.06963406887731172; terminals('7', '2') = 0.7496143680621247; 
terminals('8', '1') = 0.6899241083209441; terminals('8', '2') = 0.3983693259361688; 
terminals('9', '1') = 0.04801600213090029; terminals('9', '2') = 0.8477767381240225; 
terminals('10', '1') = 0.7441318209562995; terminals('10', '2') = 0.20920769412555007; 
terminals('11', '1') = 0.693631619718664; terminals('11', '2') = 0.8604394007192356; 
terminals('12', '1') = 0.4831442428458531; terminals('12', '2') = 0.8653433418607542; 
terminals('13', '1') = 0.5651632450864935; terminals('13', '2') = 0.5488688060945208; 
terminals('14', '1') = 0.5240108306220186; terminals('14', '2') = 0.33276195978583334; 
terminals('15', '1') = 0.6486373543905707; terminals('15', '2') = 0.3769417245053285; 
terminals('16', '1') = 0.5849936172419113; terminals('16', '2') = 0.39167707071216373; 
terminals('17', '1') = 0.8803054577483458; terminals('17', '2') = 0.8523743851151416; 
terminals('18', '1') = 0.5692298239191917; terminals('18', '2') = 0.4700384730401833; 
terminals('19', '1') = 0.34288126797090523; terminals('19', '2') = 0.2402413171863802; 
terminals('20', '1') = 0.6848883024008562; terminals('20', '2') = 0.2755878207048609; 
terminals('21', '1') = 0.26389082644094797; terminals('21', '2') = 0.1918490333293097; 
terminals('22', '1') = 0.068378528344336; terminals('22', '2') = 0.9975380931990478; 
terminals('23', '1') = 0.11284805129810294; terminals('23', '2') = 0.6235467883381055; 
terminals('24', '1') = 0.19889914152649724; terminals('24', '2') = 0.7833256985505608; 
terminals('25', '1') = 0.32305854764259767; terminals('25', '2') = 0.625081289804176; 
terminals('26', '1') = 0.7150581130885941; terminals('26', '2') = 0.9224483772648121; 
terminals('27', '1') = 0.7069417327560309; terminals('27', '2') = 0.6639485014832801; 
terminals('28', '1') = 0.9281509104843682; terminals('28', '2') = 0.30143009613369454; 
terminals('29', '1') = 0.260770854847002; terminals('29', '2') = 0.5216918077622588; 
terminals('30', '1') = 0.4408705115295598; terminals('30', '2') = 0.32628545163477074; 
terminals('31', '1') = 0.9233451281736298; terminals('31', '2') = 0.16906712375716348; 
terminals('32', '1') = 0.05235682734776059; terminals('32', '2') = 0.5671238815664479; 
terminals('33', '1') = 0.7171325927069749; terminals('33', '2') = 0.5203183473344989; 
terminals('34', '1') = 0.5377449164540273; terminals('34', '2') = 0.3446625196123938; 
terminals('35', '1') = 0.6996496912197092; terminals('35', '2') = 0.6572160904573673; 
terminals('36', '1') = 0.5096681872224669; terminals('36', '2') = 0.6169318608687295; 
terminals('37', '1') = 0.23499110621198838; terminals('37', '2') = 0.2909749641618202; 
terminals('38', '1') = 0.6396849116451837; terminals('38', '2') = 0.1301785461661522; 
terminals('39', '1') = 0.16716224982166128; terminals('39', '2') = 0.48668813304706093; 
terminals('40', '1') = 0.900692369516547; terminals('40', '2') = 0.025413336805040876; 
terminals('41', '1') = 0.429136491075194; terminals('41', '2') = 0.5718414781891852; 
terminals('42', '1') = 0.631246514688401; terminals('42', '2') = 0.604284616487616; 
terminals('43', '1') = 0.30821186474724793; terminals('43', '2') = 0.5089006237706418; 
terminals('44', '1') = 0.014555852705264272; terminals('44', '2') = 0.03834657291385268; 
terminals('45', '1') = 0.4290000992621241; terminals('45', '2') = 0.8513518623801242; 
terminals('46', '1') = 0.17069450844336354; terminals('46', '2') = 0.7860725568397996; 
terminals('47', '1') = 0.24346584610548638; terminals('47', '2') = 0.5149296766660653; 
terminals('48', '1') = 0.13378346389315243; terminals('48', '2') = 0.7738831387604963; 
terminals('49', '1') = 0.09325630758239511; terminals('49', '2') = 0.7243627798554061; 
terminals('50', '1') = 0.6803231952534085; terminals('50', '2') = 0.31834677588712035; 
terminals('51', '1') = 0.8871834997917961; terminals('51', '2') = 0.8712879695072352; 
terminals('52', '1') = 0.8656358666457336; terminals('52', '2') = 0.6710614680048729; 
terminals('53', '1') = 0.4771399851898469; terminals('53', '2') = 0.09942886216687985; 
terminals('54', '1') = 0.7523040567600625; terminals('54', '2') = 0.9561903537521045; 
terminals('55', '1') = 0.6564453412280702; terminals('55', '2') = 0.6000836346231476; 
terminals('56', '1') = 0.8170449984229902; terminals('56', '2') = 0.9463124428924036; 
terminals('57', '1') = 0.7655136659171671; terminals('57', '2') = 0.9708998767295652; 
terminals('58', '1') = 0.9452154449585954; terminals('58', '2') = 0.7404617910752712; 
terminals('59', '1') = 0.8575972851976444; terminals('59', '2') = 0.4685986536854465; 
terminals('60', '1') = 0.03692669254351266; terminals('60', '2') = 0.8080891338361446; 
terminals('61', '1') = 0.09897957439507699; terminals('61', '2') = 0.16816395860251054; 
terminals('62', '1') = 0.6098901486887052; terminals('62', '2') = 0.6945287996558946; 
terminals('63', '1') = 0.9734269518911965; terminals('63', '2') = 0.3295756904212159; 
terminals('64', '1') = 0.27800784307310333; terminals('64', '2') = 0.03328795080086533; 
terminals('65', '1') = 0.6086752081628153; terminals('65', '2') = 0.9769911340760957; 
terminals('66', '1') = 0.6681776371626992; terminals('66', '2') = 0.24949380020454703; 
terminals('67', '1') = 0.4208685786510119; terminals('67', '2') = 0.8818177175242512; 
terminals('68', '1') = 0.8596221563741002; terminals('68', '2') = 0.9624333739210098; 
terminals('69', '1') = 0.5869954009802936; terminals('69', '2') = 0.9125389935818103; 
terminals('70', '1') = 0.8411859591535189; terminals('70', '2') = 0.3117723012241663; 
terminals('71', '1') = 0.570648339100368; terminals('71', '2') = 0.8900282179048329; 
terminals('72', '1') = 0.6139267370320727; terminals('72', '2') = 0.38611238860433517; 
terminals('73', '1') = 0.691317932519842; terminals('73', '2') = 0.6616220454687937; 
terminals('74', '1') = 0.8824769165599923; terminals('74', '2') = 0.215640075346877; 
terminals('75', '1') = 0.12699945263625434; terminals('75', '2') = 0.748853246905495; 
terminals('76', '1') = 0.3733283793023864; terminals('76', '2') = 0.46980034769475587; 
terminals('77', '1') = 0.31131749351216076; terminals('77', '2') = 0.7277142579109811; 
terminals('78', '1') = 0.049092541749529706; terminals('78', '2') = 0.8363689304650158; 
terminals('79', '1') = 0.5056081320066095; terminals('79', '2') = 0.5107191775834223; 
terminals('80', '1') = 0.5388333943557089; terminals('80', '2') = 0.41780575810430287; 
terminals('81', '1') = 0.14979700668369877; terminals('81', '2') = 0.25047145449304653; 
terminals('82', '1') = 0.20671786712732154; terminals('82', '2') = 0.564910374301599; 
terminals('83', '1') = 0.11911985116039525; terminals('83', '2') = 0.6660751835201616; 
terminals('84', '1') = 0.529973532617081; terminals('84', '2') = 0.21969161104476387; 
terminals('85', '1') = 0.49405965705089294; terminals('85', '2') = 0.8530119494979644; 
terminals('86', '1') = 0.26925858782684586; terminals('86', '2') = 0.30876397329812466; 
terminals('87', '1') = 0.29872465289362216; terminals('87', '2') = 0.4933917289064387; 
terminals('88', '1') = 0.554958335534133; terminals('88', '2') = 0.9867960626460017; 
terminals('89', '1') = 0.05705044370862711; terminals('89', '2') = 0.4827398899404075; 
terminals('90', '1') = 0.9193382028959789; terminals('90', '2') = 0.2775720944174558; 
terminals('91', '1') = 0.4260934923106052; terminals('91', '2') = 0.5721369296557496; 
terminals('92', '1') = 0.42818230377064825; terminals('92', '2') = 0.5063442116656828; 
terminals('93', '1') = 0.09509590316640681; terminals('93', '2') = 0.612025341806059; 
terminals('94', '1') = 0.15682498006191636; terminals('94', '2') = 0.08225693056664207; 
terminals('95', '1') = 0.7882729773912447; terminals('95', '2') = 0.8207851480769889; 
Parameter bigM / 1.4142135623730951 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
