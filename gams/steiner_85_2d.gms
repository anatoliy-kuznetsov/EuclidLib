Sets
i Steiner points / 1*83 /
j terminals / 1*85 /
k dimensions / 1*2 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.7874013583733741; terminals('1', '2') = 0.9099069373097282; 
terminals('2', '1') = 0.5865766802447452; terminals('2', '2') = 0.31459805438003396; 
terminals('3', '1') = 0.24222791437749003; terminals('3', '2') = 0.2654316096044541; 
terminals('4', '1') = 0.12161406292202026; terminals('4', '2') = 0.7962530612094555; 
terminals('5', '1') = 0.015043403131328348; terminals('5', '2') = 0.9070578254955792; 
terminals('6', '1') = 0.3042046098246983; terminals('6', '2') = 0.4988400721540762; 
terminals('7', '1') = 0.517632263527612; terminals('7', '2') = 0.5746156815212102; 
terminals('8', '1') = 0.006275424231276472; terminals('8', '2') = 0.8221572479063552; 
terminals('9', '1') = 0.4598466106871312; terminals('9', '2') = 0.17650783058650354; 
terminals('10', '1') = 0.4640099075839108; terminals('10', '2') = 0.1774462809360926; 
terminals('11', '1') = 0.17387278618453506; terminals('11', '2') = 0.0023657364428982808; 
terminals('12', '1') = 0.4427789192097874; terminals('12', '2') = 0.014399884104416838; 
terminals('13', '1') = 0.45986281893811265; terminals('13', '2') = 0.545067503241869; 
terminals('14', '1') = 0.574465588551383; terminals('14', '2') = 0.35465782567573734; 
terminals('15', '1') = 0.03713445543661542; terminals('15', '2') = 0.5309522431685183; 
terminals('16', '1') = 0.014808798815740376; terminals('16', '2') = 0.3958396641509123; 
terminals('17', '1') = 0.06649506637050862; terminals('17', '2') = 0.3430245407317829; 
terminals('18', '1') = 0.9762663024192003; terminals('18', '2') = 0.08248453837676228; 
terminals('19', '1') = 0.7019353883386594; terminals('19', '2') = 0.18423669431596157; 
terminals('20', '1') = 0.31419716445179713; terminals('20', '2') = 0.5417934172005947; 
terminals('21', '1') = 0.1429142293181599; terminals('21', '2') = 0.33334498851743155; 
terminals('22', '1') = 0.3972927647350406; terminals('22', '2') = 0.16526469753488449; 
terminals('23', '1') = 0.9077623275968545; terminals('23', '2') = 0.2905299894604433; 
terminals('24', '1') = 0.5045165491642873; terminals('24', '2') = 0.5849135744259155; 
terminals('25', '1') = 0.785889481107968; terminals('25', '2') = 0.5631029978336833; 
terminals('26', '1') = 0.002866889981182008; terminals('26', '2') = 0.9339488748002964; 
terminals('27', '1') = 0.9269298872793659; terminals('27', '2') = 0.714005641459099; 
terminals('28', '1') = 0.0642494600548853; terminals('28', '2') = 0.6996170245232214; 
terminals('29', '1') = 0.1179191513483332; terminals('29', '2') = 0.9652817245357246; 
terminals('30', '1') = 0.0715930724284134; terminals('30', '2') = 0.2585091559523819; 
terminals('31', '1') = 0.5255816591349075; terminals('31', '2') = 0.1333029801279395; 
terminals('32', '1') = 0.6031942459598011; terminals('32', '2') = 0.03064222901985647; 
terminals('33', '1') = 0.3356569342006196; terminals('33', '2') = 0.6810862048406515; 
terminals('34', '1') = 0.10471688753081143; terminals('34', '2') = 0.2178652237424321; 
terminals('35', '1') = 0.646645340590969; terminals('35', '2') = 0.9609929351114823; 
terminals('36', '1') = 0.07936290306037574; terminals('36', '2') = 0.5248328102829651; 
terminals('37', '1') = 0.8259995791140082; terminals('37', '2') = 0.05491438314295982; 
terminals('38', '1') = 0.345268502150994; terminals('38', '2') = 0.9091060474419134; 
terminals('39', '1') = 0.2647867312238896; terminals('39', '2') = 0.6833401935490953; 
terminals('40', '1') = 0.6153798668350505; terminals('40', '2') = 0.14037621435508385; 
terminals('41', '1') = 0.12434544596096297; terminals('41', '2') = 0.10425034824789081; 
terminals('42', '1') = 0.8615434115148425; terminals('42', '2') = 0.695486540192526; 
terminals('43', '1') = 0.29346049093871096; terminals('43', '2') = 0.06052778106164414; 
terminals('44', '1') = 0.7510202834581587; terminals('44', '2') = 0.53011249837437; 
terminals('45', '1') = 0.42728009462773275; terminals('45', '2') = 0.20667879431422997; 
terminals('46', '1') = 0.0007737719327433057; terminals('46', '2') = 0.5075826445583026; 
terminals('47', '1') = 0.9021112873402367; terminals('47', '2') = 0.014733319039330728; 
terminals('48', '1') = 0.25067544273970543; terminals('48', '2') = 0.6889003551656513; 
terminals('49', '1') = 0.5366191203022781; terminals('49', '2') = 0.3349009478444416; 
terminals('50', '1') = 0.5209750922611137; terminals('50', '2') = 0.2457509575965281; 
terminals('51', '1') = 0.1430850549751791; terminals('51', '2') = 0.22609131228337898; 
terminals('52', '1') = 0.8160159689074895; terminals('52', '2') = 0.04770223334320822; 
terminals('53', '1') = 0.03167786599910516; terminals('53', '2') = 0.8384729010362966; 
terminals('54', '1') = 0.22623191392784425; terminals('54', '2') = 0.5647587857141151; 
terminals('55', '1') = 0.16828268778662936; terminals('55', '2') = 0.11028158855071246; 
terminals('56', '1') = 0.562393074258682; terminals('56', '2') = 0.079753950365539; 
terminals('57', '1') = 0.46219226204209474; terminals('57', '2') = 0.02552401352584177; 
terminals('58', '1') = 0.07078073338766888; terminals('58', '2') = 0.17113470991984348; 
terminals('59', '1') = 0.38088161776901; terminals('59', '2') = 0.6583215148068252; 
terminals('60', '1') = 0.4369065329929538; terminals('60', '2') = 0.38355745420047427; 
terminals('61', '1') = 0.9666534963227296; terminals('61', '2') = 0.658845888084955; 
terminals('62', '1') = 0.5393884623927045; terminals('62', '2') = 0.6795085496406372; 
terminals('63', '1') = 0.3775402912916809; terminals('63', '2') = 0.969825022196746; 
terminals('64', '1') = 0.7333635394087121; terminals('64', '2') = 0.339577772342345; 
terminals('65', '1') = 0.4102675272141868; terminals('65', '2') = 0.005931809024595225; 
terminals('66', '1') = 0.7252848474080469; terminals('66', '2') = 0.8515335257880133; 
terminals('67', '1') = 0.3674080116677534; terminals('67', '2') = 0.009458381431517893; 
terminals('68', '1') = 0.4525749813932517; terminals('68', '2') = 0.8026710286809127; 
terminals('69', '1') = 0.49249632760276396; terminals('69', '2') = 0.8740547409342186; 
terminals('70', '1') = 0.6224895114389997; terminals('70', '2') = 0.15309895754964975; 
terminals('71', '1') = 0.5966760348193136; terminals('71', '2') = 0.7088511476098609; 
terminals('72', '1') = 0.1322328443954518; terminals('72', '2') = 0.8856110285489596; 
terminals('73', '1') = 0.2300119666399395; terminals('73', '2') = 0.5602119794346828; 
terminals('74', '1') = 0.34050883367555596; terminals('74', '2') = 0.6183978606126815; 
terminals('75', '1') = 0.9221554260180557; terminals('75', '2') = 0.20627078150531186; 
terminals('76', '1') = 0.6843949493094972; terminals('76', '2') = 0.88533386901754; 
terminals('77', '1') = 0.8982460188617571; terminals('77', '2') = 0.32960143739487724; 
terminals('78', '1') = 0.2914839073010105; terminals('78', '2') = 0.406542516276309; 
terminals('79', '1') = 0.51512497875223; terminals('79', '2') = 0.15912921535609925; 
terminals('80', '1') = 0.9369280919408167; terminals('80', '2') = 0.7544709017219183; 
terminals('81', '1') = 0.9015417167242705; terminals('81', '2') = 0.5427144201177422; 
terminals('82', '1') = 0.6470631292693831; terminals('82', '2') = 0.5370523677067335; 
terminals('83', '1') = 0.8262951847304852; terminals('83', '2') = 0.5683362576252383; 
terminals('84', '1') = 0.2825776054536394; terminals('84', '2') = 0.2641675284701327; 
terminals('85', '1') = 0.7530689027479238; terminals('85', '2') = 0.43554360003938164; 
Parameter bigM / 1.4142135623730951 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
