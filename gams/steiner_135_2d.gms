Sets
i Steiner points / 1*133 /
j terminals / 1*135 /
k dimensions / 1*2 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.8468921793952306; terminals('1', '2') = 0.35785367200729423; 
terminals('2', '1') = 0.07930411942726912; terminals('2', '2') = 0.594892932343681; 
terminals('3', '1') = 0.29907512679224424; terminals('3', '2') = 0.5787576282500965; 
terminals('4', '1') = 0.6434039909621216; terminals('4', '2') = 0.14009968222879332; 
terminals('5', '1') = 0.8458062023930348; terminals('5', '2') = 0.4835349213012943; 
terminals('6', '1') = 0.29235346068863344; terminals('6', '2') = 0.6567676205430774; 
terminals('7', '1') = 0.876804989879486; terminals('7', '2') = 0.5225622423705627; 
terminals('8', '1') = 0.25518808477260035; terminals('8', '2') = 0.6562959836732345; 
terminals('9', '1') = 0.4349110599086098; terminals('9', '2') = 0.910974194220566; 
terminals('10', '1') = 0.184218724683342; terminals('10', '2') = 0.5717845519739091; 
terminals('11', '1') = 0.752568666460211; terminals('11', '2') = 0.05347356215363186; 
terminals('12', '1') = 0.742405804375938; terminals('12', '2') = 0.595417514468651; 
terminals('13', '1') = 0.6048644848449706; terminals('13', '2') = 0.7388837983758122; 
terminals('14', '1') = 0.044919256713795264; terminals('14', '2') = 0.16853840186741142; 
terminals('15', '1') = 0.3147809031131228; terminals('15', '2') = 0.886570544325035; 
terminals('16', '1') = 0.7509343813269023; terminals('16', '2') = 0.49721956764836317; 
terminals('17', '1') = 0.32342073499070634; terminals('17', '2') = 0.36180698223246177; 
terminals('18', '1') = 0.44007264139707913; terminals('18', '2') = 0.44132312205384217; 
terminals('19', '1') = 0.9237728964313136; terminals('19', '2') = 0.3124562421906; 
terminals('20', '1') = 0.071863968172177; terminals('20', '2') = 0.6334882129272638; 
terminals('21', '1') = 0.7771785138099013; terminals('21', '2') = 0.006924344364637625; 
terminals('22', '1') = 0.3084638638781463; terminals('22', '2') = 0.9514344907187533; 
terminals('23', '1') = 0.7587518659541719; terminals('23', '2') = 0.6486793960902858; 
terminals('24', '1') = 0.7277674631170509; terminals('24', '2') = 0.8888582320511026; 
terminals('25', '1') = 0.8559576385708217; terminals('25', '2') = 0.1202611399632304; 
terminals('26', '1') = 0.18205842502057257; terminals('26', '2') = 0.2629690561781841; 
terminals('27', '1') = 0.4030087185857085; terminals('27', '2') = 0.5114967718081908; 
terminals('28', '1') = 0.31048151430280124; terminals('28', '2') = 0.8099435016093273; 
terminals('29', '1') = 0.37975124554114437; terminals('29', '2') = 0.5876647922422333; 
terminals('30', '1') = 0.8982665970930979; terminals('30', '2') = 0.2200174677390745; 
terminals('31', '1') = 0.3924343963176732; terminals('31', '2') = 0.4442768152433463; 
terminals('32', '1') = 0.9546576580419741; terminals('32', '2') = 0.03112380710268814; 
terminals('33', '1') = 0.5763412622050282; terminals('33', '2') = 0.5817371207304755; 
terminals('34', '1') = 0.37416373168968764; terminals('34', '2') = 0.3127084401742708; 
terminals('35', '1') = 0.36508901859076315; terminals('35', '2') = 0.5903191867577585; 
terminals('36', '1') = 0.452477987459201; terminals('36', '2') = 0.21307467264130164; 
terminals('37', '1') = 0.599803642620017; terminals('37', '2') = 0.5345609080254436; 
terminals('38', '1') = 0.6227536973065894; terminals('38', '2') = 0.16853749891215875; 
terminals('39', '1') = 0.06036608473634564; terminals('39', '2') = 0.8305698322784919; 
terminals('40', '1') = 0.05396488031381874; terminals('40', '2') = 0.8297027699295658; 
terminals('41', '1') = 0.41258841999113804; terminals('41', '2') = 0.6926924043712591; 
terminals('42', '1') = 0.4218927532446418; terminals('42', '2') = 0.42123292167755755; 
terminals('43', '1') = 0.014852251644165926; terminals('43', '2') = 0.024436222583364198; 
terminals('44', '1') = 0.2525033052684268; terminals('44', '2') = 0.6809543779528375; 
terminals('45', '1') = 0.8391257385006557; terminals('45', '2') = 0.8608747574638531; 
terminals('46', '1') = 0.24191889564162528; terminals('46', '2') = 0.422640318885082; 
terminals('47', '1') = 0.4721417164446893; terminals('47', '2') = 0.5160136021951413; 
terminals('48', '1') = 0.43035455591924465; terminals('48', '2') = 0.4547851513031791; 
terminals('49', '1') = 0.3491634985124863; terminals('49', '2') = 0.03741613888790385; 
terminals('50', '1') = 0.6865094041363268; terminals('50', '2') = 0.4240277676416303; 
terminals('51', '1') = 0.8325065378929193; terminals('51', '2') = 0.9558102468509789; 
terminals('52', '1') = 0.7764749208829479; terminals('52', '2') = 0.9232418058007508; 
terminals('53', '1') = 0.24562377093757848; terminals('53', '2') = 0.21641087854197982; 
terminals('54', '1') = 0.5764802567354279; terminals('54', '2') = 0.991286323128529; 
terminals('55', '1') = 0.2841015654611515; terminals('55', '2') = 0.6513269885481453; 
terminals('56', '1') = 0.7700673214401517; terminals('56', '2') = 0.2249604291859193; 
terminals('57', '1') = 0.06936176917960102; terminals('57', '2') = 0.8904870294745785; 
terminals('58', '1') = 0.0540269112714844; terminals('58', '2') = 0.7753718117101118; 
terminals('59', '1') = 0.5405437020233019; terminals('59', '2') = 0.045301393757303354; 
terminals('60', '1') = 0.9898940051876771; terminals('60', '2') = 0.179759136697904; 
terminals('61', '1') = 0.8736287347292665; terminals('61', '2') = 0.3077641541088486; 
terminals('62', '1') = 0.26428869216447126; terminals('62', '2') = 0.09348802188298466; 
terminals('63', '1') = 0.17253634073433677; terminals('63', '2') = 0.222727438291364; 
terminals('64', '1') = 0.26788199724323913; terminals('64', '2') = 0.5879378730715613; 
terminals('65', '1') = 0.20247852141110778; terminals('65', '2') = 0.24315078786060496; 
terminals('66', '1') = 0.9776311788788025; terminals('66', '2') = 0.5213302239630475; 
terminals('67', '1') = 0.6829878870097007; terminals('67', '2') = 0.41543259706878055; 
terminals('68', '1') = 0.49374545378262225; terminals('68', '2') = 0.7950041265757212; 
terminals('69', '1') = 0.5770821864581219; terminals('69', '2') = 0.6060650063310109; 
terminals('70', '1') = 0.47933361057957535; terminals('70', '2') = 0.9412468186134797; 
terminals('71', '1') = 0.07908110926724521; terminals('71', '2') = 0.08830621980949327; 
terminals('72', '1') = 0.6396333799742715; terminals('72', '2') = 0.12981918423128658; 
terminals('73', '1') = 0.9315589554294197; terminals('73', '2') = 0.4968631872170103; 
terminals('74', '1') = 0.6174463693720086; terminals('74', '2') = 0.03838287040355681; 
terminals('75', '1') = 0.4490585228262193; terminals('75', '2') = 0.9058731752924863; 
terminals('76', '1') = 0.003691402440382907; terminals('76', '2') = 0.9785475155018067; 
terminals('77', '1') = 0.041334261293869745; terminals('77', '2') = 0.5465019482106426; 
terminals('78', '1') = 0.8875880130052174; terminals('78', '2') = 0.45471731299942175; 
terminals('79', '1') = 0.921005473696805; terminals('79', '2') = 0.5352996978788472; 
terminals('80', '1') = 0.4789046673533639; terminals('80', '2') = 0.814691211687865; 
terminals('81', '1') = 0.36527667080052906; terminals('81', '2') = 0.41373425451124646; 
terminals('82', '1') = 0.40413518355380884; terminals('82', '2') = 0.02268192071931674; 
terminals('83', '1') = 0.5974463200509494; terminals('83', '2') = 0.5078551613759245; 
terminals('84', '1') = 0.2972322687907796; terminals('84', '2') = 0.9857478332244735; 
terminals('85', '1') = 0.5621144415543103; terminals('85', '2') = 0.6561528406642807; 
terminals('86', '1') = 0.26538284447450067; terminals('86', '2') = 0.6238394116200641; 
terminals('87', '1') = 0.6212727870529462; terminals('87', '2') = 0.1736709916286584; 
terminals('88', '1') = 0.6704529094023355; terminals('88', '2') = 0.9582389690600159; 
terminals('89', '1') = 0.6073146910554291; terminals('89', '2') = 0.04292285513529004; 
terminals('90', '1') = 0.6633828861482775; terminals('90', '2') = 0.6157385462442326; 
terminals('91', '1') = 0.7867975571826477; terminals('91', '2') = 0.6090504018216905; 
terminals('92', '1') = 0.9663651993199988; terminals('92', '2') = 0.5268372796115331; 
terminals('93', '1') = 0.24135145464561958; terminals('93', '2') = 0.4020497205440825; 
terminals('94', '1') = 0.9139104534573902; terminals('94', '2') = 0.2375038761167484; 
terminals('95', '1') = 0.044152353819845835; terminals('95', '2') = 0.31119990257644115; 
terminals('96', '1') = 0.268424529508539; terminals('96', '2') = 0.4625738778607539; 
terminals('97', '1') = 0.7982170610774139; terminals('97', '2') = 0.8089857789673542; 
terminals('98', '1') = 0.414470287823664; terminals('98', '2') = 0.3185352588904051; 
terminals('99', '1') = 0.3135373088909903; terminals('99', '2') = 0.43459096981710443; 
terminals('100', '1') = 0.893013312736152; terminals('100', '2') = 0.5940211042035195; 
terminals('101', '1') = 0.5345554687762283; terminals('101', '2') = 0.026558349037922535; 
terminals('102', '1') = 0.9460743918088409; terminals('102', '2') = 0.6349629536493874; 
terminals('103', '1') = 0.9550035959657791; terminals('103', '2') = 0.16624422075644885; 
terminals('104', '1') = 0.15421745006829468; terminals('104', '2') = 0.8155633303252693; 
terminals('105', '1') = 0.3439769848899161; terminals('105', '2') = 0.46565217272895754; 
terminals('106', '1') = 0.596010599516748; terminals('106', '2') = 0.41186387242267497; 
terminals('107', '1') = 0.5472844882705841; terminals('107', '2') = 0.3162116026009727; 
terminals('108', '1') = 0.4164993581669768; terminals('108', '2') = 0.7975517249175045; 
terminals('109', '1') = 0.10881130313905074; terminals('109', '2') = 0.23026962557622888; 
terminals('110', '1') = 0.10790155805110357; terminals('110', '2') = 0.4535098714835901; 
terminals('111', '1') = 0.5186254282510353; terminals('111', '2') = 0.24135708748889095; 
terminals('112', '1') = 0.22300482702242774; terminals('112', '2') = 0.32569856240419504; 
terminals('113', '1') = 0.7688400424117579; terminals('113', '2') = 0.2841336567951681; 
terminals('114', '1') = 0.24986996535729; terminals('114', '2') = 0.7675583273334322; 
terminals('115', '1') = 0.5240991505460109; terminals('115', '2') = 0.0012020405716626215; 
terminals('116', '1') = 0.48329977123129886; terminals('116', '2') = 0.09071680441199825; 
terminals('117', '1') = 0.7578447062302449; terminals('117', '2') = 0.8726162295511728; 
terminals('118', '1') = 0.31345150305197733; terminals('118', '2') = 0.20862773296788284; 
terminals('119', '1') = 0.1811919118285068; terminals('119', '2') = 0.7837839055893004; 
terminals('120', '1') = 0.7606605735120642; terminals('120', '2') = 0.9802800816245387; 
terminals('121', '1') = 0.2976181547835218; terminals('121', '2') = 0.8849790040704566; 
terminals('122', '1') = 0.2650347443128688; terminals('122', '2') = 0.8772171872265457; 
terminals('123', '1') = 0.05381245809827695; terminals('123', '2') = 0.8050929601447766; 
terminals('124', '1') = 0.9616199142220556; terminals('124', '2') = 0.4478422373262172; 
terminals('125', '1') = 0.35390828335254676; terminals('125', '2') = 0.33931031522672406; 
terminals('126', '1') = 0.08977678677258905; terminals('126', '2') = 0.30743167876384947; 
terminals('127', '1') = 0.6460780732182244; terminals('127', '2') = 0.9024865545486396; 
terminals('128', '1') = 0.02500670050093723; terminals('128', '2') = 0.8033320186112473; 
terminals('129', '1') = 0.45315773189596553; terminals('129', '2') = 0.10029398051789284; 
terminals('130', '1') = 0.008242842347703894; terminals('130', '2') = 0.4682576429251113; 
terminals('131', '1') = 0.4173801840953585; terminals('131', '2') = 0.6812267718882078; 
terminals('132', '1') = 0.8838280020537285; terminals('132', '2') = 0.32072164371772327; 
terminals('133', '1') = 0.7844245047529876; terminals('133', '2') = 0.8347715851618329; 
terminals('134', '1') = 0.4370710644396012; terminals('134', '2') = 0.9450062088053764; 
terminals('135', '1') = 0.8292636152029196; terminals('135', '2') = 0.38437855555519806; 
Parameter bigM / 1.4142135623730951 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
