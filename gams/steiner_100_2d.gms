Sets
i Steiner points / 1*98 /
j terminals / 1*100 /
k dimensions / 1*2 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.04560930208539393; terminals('1', '2') = 0.20344697486239927; 
terminals('2', '1') = 0.709123984205446; terminals('2', '2') = 0.14284849627100393; 
terminals('3', '1') = 0.8600109875105951; terminals('3', '2') = 0.26671226260336733; 
terminals('4', '1') = 0.011472960500748308; terminals('4', '2') = 0.43997054330904173; 
terminals('5', '1') = 0.1672104054587421; terminals('5', '2') = 0.016226131011587097; 
terminals('6', '1') = 0.27813667386355834; terminals('6', '2') = 0.45979992473023357; 
terminals('7', '1') = 0.19285636878249712; terminals('7', '2') = 0.8528244429906146; 
terminals('8', '1') = 0.30002455193093036; terminals('8', '2') = 0.7008269160039364; 
terminals('9', '1') = 0.3509502235742331; terminals('9', '2') = 0.10094211595822156; 
terminals('10', '1') = 0.43458724193158105; terminals('10', '2') = 0.6856550495783891; 
terminals('11', '1') = 0.48700804482709137; terminals('11', '2') = 0.6421958261391797; 
terminals('12', '1') = 0.12173880439760654; terminals('12', '2') = 0.13990110801878353; 
terminals('13', '1') = 0.1301332897100964; terminals('13', '2') = 0.49166847140006; 
terminals('14', '1') = 0.8609822704622245; terminals('14', '2') = 0.38315482800871437; 
terminals('15', '1') = 0.8202806632946681; terminals('15', '2') = 0.11120307867998969; 
terminals('16', '1') = 0.2253871228333516; terminals('16', '2') = 0.6732858989355599; 
terminals('17', '1') = 0.785590069932909; terminals('17', '2') = 0.793650531197551; 
terminals('18', '1') = 0.14566803661800132; terminals('18', '2') = 0.5414979580853482; 
terminals('19', '1') = 0.23749337067619203; terminals('19', '2') = 0.7493618283112125; 
terminals('20', '1') = 0.5800976453507244; terminals('20', '2') = 0.6885242190704849; 
terminals('21', '1') = 0.7837376458144856; terminals('21', '2') = 0.9860359539824124; 
terminals('22', '1') = 0.46624211657744563; terminals('22', '2') = 0.994789173348928; 
terminals('23', '1') = 0.2897705978290378; terminals('23', '2') = 0.8814705700873252; 
terminals('24', '1') = 0.10563344655601192; terminals('24', '2') = 0.7163472571753333; 
terminals('25', '1') = 0.8967613596633169; terminals('25', '2') = 0.5550703987568195; 
terminals('26', '1') = 0.3610663269919401; terminals('26', '2') = 0.8256329295556797; 
terminals('27', '1') = 0.8143412639002516; terminals('27', '2') = 0.7145400458176119; 
terminals('28', '1') = 0.3450452532797509; terminals('28', '2') = 0.5152307970985156; 
terminals('29', '1') = 0.0019320409027601126; terminals('29', '2') = 0.5289931014465276; 
terminals('30', '1') = 0.30776291124558264; terminals('30', '2') = 0.6753774886552658; 
terminals('31', '1') = 0.01964412600588028; terminals('31', '2') = 0.44791957974135377; 
terminals('32', '1') = 0.11778070263277263; terminals('32', '2') = 0.34556383565243276; 
terminals('33', '1') = 0.978777773780051; terminals('33', '2') = 0.7592486833162064; 
terminals('34', '1') = 0.6449030701988681; terminals('34', '2') = 0.363278778459709; 
terminals('35', '1') = 0.09889839771218234; terminals('35', '2') = 0.030991647558839763; 
terminals('36', '1') = 0.5457877582852109; terminals('36', '2') = 0.984666516473319; 
terminals('37', '1') = 0.7356024863493776; terminals('37', '2') = 0.21197268723923524; 
terminals('38', '1') = 0.9718099272172258; terminals('38', '2') = 0.22530657721450764; 
terminals('39', '1') = 0.04638537168140999; terminals('39', '2') = 0.5089201398466281; 
terminals('40', '1') = 0.44873466243144344; terminals('40', '2') = 0.06862446499325392; 
terminals('41', '1') = 0.9198629159532808; terminals('41', '2') = 0.291550462921334; 
terminals('42', '1') = 0.39254344976243183; terminals('42', '2') = 0.03970582801852374; 
terminals('43', '1') = 0.013575552368260135; terminals('43', '2') = 0.948641239481525; 
terminals('44', '1') = 0.9652434088326232; terminals('44', '2') = 0.6227684825617382; 
terminals('45', '1') = 0.04958487491591723; terminals('45', '2') = 0.14361747198321884; 
terminals('46', '1') = 0.1371469828999734; terminals('46', '2') = 0.011311374012273001; 
terminals('47', '1') = 0.7966026046223665; terminals('47', '2') = 0.45448634167604973; 
terminals('48', '1') = 0.02963887464246262; terminals('48', '2') = 0.2655482159824325; 
terminals('49', '1') = 0.45961519757368907; terminals('49', '2') = 0.518603776359552; 
terminals('50', '1') = 0.5187062711359054; terminals('50', '2') = 0.13374883636102952; 
terminals('51', '1') = 0.7997273804354993; terminals('51', '2') = 0.09790449917708899; 
terminals('52', '1') = 0.44218478390906635; terminals('52', '2') = 0.7291421266560294; 
terminals('53', '1') = 0.10681973205712214; terminals('53', '2') = 0.020989677560024678; 
terminals('54', '1') = 0.988459726437621; terminals('54', '2') = 0.6929284415069897; 
terminals('55', '1') = 0.19188607130061797; terminals('55', '2') = 0.6601006590297704; 
terminals('56', '1') = 0.10148042744776675; terminals('56', '2') = 0.8265180326706605; 
terminals('57', '1') = 0.03926915675190601; terminals('57', '2') = 0.11021478947349217; 
terminals('58', '1') = 0.22233985355805086; terminals('58', '2') = 0.6260762028425085; 
terminals('59', '1') = 0.8696718270637287; terminals('59', '2') = 0.2433757164509922; 
terminals('60', '1') = 0.7744922055249331; terminals('60', '2') = 0.41239461366594377; 
terminals('61', '1') = 0.45821322471002335; terminals('61', '2') = 0.6767145605894804; 
terminals('62', '1') = 0.23930028629758748; terminals('62', '2') = 0.7083088661552592; 
terminals('63', '1') = 0.3442768038113623; terminals('63', '2') = 0.15812151415577136; 
terminals('64', '1') = 0.6415403183057607; terminals('64', '2') = 0.5126520545620054; 
terminals('65', '1') = 0.04032851042107832; terminals('65', '2') = 0.9447606633854594; 
terminals('66', '1') = 0.7682144383337516; terminals('66', '2') = 0.4467636790627819; 
terminals('67', '1') = 0.7940626567070503; terminals('67', '2') = 0.7657290749603061; 
terminals('68', '1') = 0.032089300237294394; terminals('68', '2') = 0.059280240805465345; 
terminals('69', '1') = 0.4902617345131739; terminals('69', '2') = 0.4229359158412549; 
terminals('70', '1') = 0.6765279252034997; terminals('70', '2') = 0.16201869993279994; 
terminals('71', '1') = 0.13894337697455694; terminals('71', '2') = 0.37951835100052733; 
terminals('72', '1') = 0.9875263328228819; terminals('72', '2') = 0.01923842677011811; 
terminals('73', '1') = 0.9538445856789007; terminals('73', '2') = 0.5932855716720428; 
terminals('74', '1') = 0.35467575846729127; terminals('74', '2') = 0.09713878604246018; 
terminals('75', '1') = 0.4405317168588473; terminals('75', '2') = 0.4343573682967059; 
terminals('76', '1') = 0.05512501692901495; terminals('76', '2') = 0.4015423368288136; 
terminals('77', '1') = 0.9248251975106013; terminals('77', '2') = 0.9554689197464995; 
terminals('78', '1') = 0.704105337626332; terminals('78', '2') = 0.3893318067152114; 
terminals('79', '1') = 0.8638334436340364; terminals('79', '2') = 0.04088412625175364; 
terminals('80', '1') = 0.7171239360471783; terminals('80', '2') = 0.7054028247455268; 
terminals('81', '1') = 0.1478769918225642; terminals('81', '2') = 0.3659903207564169; 
terminals('82', '1') = 0.4152964639596536; terminals('82', '2') = 0.7924129778773544; 
terminals('83', '1') = 0.5913554017887985; terminals('83', '2') = 0.2402399834711323; 
terminals('84', '1') = 0.818956154949347; terminals('84', '2') = 0.4862604471754307; 
terminals('85', '1') = 0.7814698258940335; terminals('85', '2') = 0.3572710914192252; 
terminals('86', '1') = 0.3384008587880498; terminals('86', '2') = 0.3344036059321027; 
terminals('87', '1') = 0.1629996448611707; terminals('87', '2') = 0.7666358380249497; 
terminals('88', '1') = 0.6561352802071562; terminals('88', '2') = 0.3928923171608375; 
terminals('89', '1') = 0.603280772010727; terminals('89', '2') = 0.6878546371034739; 
terminals('90', '1') = 0.961075831699323; terminals('90', '2') = 0.135334507356193; 
terminals('91', '1') = 0.09619514658360506; terminals('91', '2') = 0.8854518851427745; 
terminals('92', '1') = 0.9434854136651187; terminals('92', '2') = 0.7238604744962794; 
terminals('93', '1') = 0.5387589883314188; terminals('93', '2') = 0.9579589886830618; 
terminals('94', '1') = 0.8853724054157126; terminals('94', '2') = 0.09282036397134052; 
terminals('95', '1') = 0.6933266605042222; terminals('95', '2') = 0.8067187962677371; 
terminals('96', '1') = 0.2750188078120398; terminals('96', '2') = 0.8098562951777283; 
terminals('97', '1') = 0.9114399516595678; terminals('97', '2') = 0.4961769974043919; 
terminals('98', '1') = 0.4199984163025846; terminals('98', '2') = 0.5837584016655579; 
terminals('99', '1') = 0.8079089076448015; terminals('99', '2') = 0.6497741209273058; 
terminals('100', '1') = 0.9887875684503837; terminals('100', '2') = 0.4895113467854829; 
Parameter bigM / 1.4142135623730951 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
