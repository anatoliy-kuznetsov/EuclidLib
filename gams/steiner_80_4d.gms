Sets
i Steiner points / 1*78 /
j terminals / 1*80 /
k dimensions / 1*4 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.4455298893939469; terminals('1', '2') = 0.6293702057674703; terminals('1', '3') = 0.43815078248669503; terminals('1', '4') = 0.32221017854005174; 
terminals('2', '1') = 0.41872339898159605; terminals('2', '2') = 0.09041527467199384; terminals('2', '3') = 0.512261202246994; terminals('2', '4') = 0.7868139353465692; 
terminals('3', '1') = 0.3565780045208714; terminals('3', '2') = 0.6236893924772794; terminals('3', '3') = 0.5585584547820461; terminals('3', '4') = 0.4797692291790605; 
terminals('4', '1') = 0.17164343220437317; terminals('4', '2') = 0.48057279913884166; terminals('4', '3') = 0.4972712339025608; terminals('4', '4') = 0.023648310258253646; 
terminals('5', '1') = 0.8574710096650844; terminals('5', '2') = 0.7372662066233695; terminals('5', '3') = 0.6277447208958677; terminals('5', '4') = 0.25411699378537855; 
terminals('6', '1') = 0.6319240691189618; terminals('6', '2') = 0.856033625937846; terminals('6', '3') = 0.4521982441807805; terminals('6', '4') = 0.8944157128101614; 
terminals('7', '1') = 0.83288418532921; terminals('7', '2') = 0.1683073276682988; terminals('7', '3') = 0.4101994929621736; terminals('7', '4') = 0.08466558897948806; 
terminals('8', '1') = 0.5627450752387648; terminals('8', '2') = 0.625088793268923; terminals('8', '3') = 0.4799221004067452; terminals('8', '4') = 0.38018462451376667; 
terminals('9', '1') = 0.454174978119365; terminals('9', '2') = 0.19481893511381554; terminals('9', '3') = 0.9589621478017274; terminals('9', '4') = 0.6230210615025001; 
terminals('10', '1') = 0.8997751485394359; terminals('10', '2') = 0.3776606322412739; terminals('10', '3') = 0.3937461592178103; terminals('10', '4') = 0.17223508237154328; 
terminals('11', '1') = 0.3227459535859748; terminals('11', '2') = 0.1102741909193995; terminals('11', '3') = 0.2462956543400706; terminals('11', '4') = 0.4217599781240188; 
terminals('12', '1') = 0.7611086792378045; terminals('12', '2') = 0.4276899134775589; terminals('12', '3') = 0.5185413710504576; terminals('12', '4') = 0.4428875894224702; 
terminals('13', '1') = 0.9592933282499748; terminals('13', '2') = 0.7731328251277534; terminals('13', '3') = 0.6746659626914765; terminals('13', '4') = 0.8661569922756054; 
terminals('14', '1') = 0.250372093763063; terminals('14', '2') = 0.8773231535037482; terminals('14', '3') = 0.3406709337217775; terminals('14', '4') = 0.11697800780526368; 
terminals('15', '1') = 0.5872309345488673; terminals('15', '2') = 0.21831756976657335; terminals('15', '3') = 0.8378760935271274; terminals('15', '4') = 0.6776493957328074; 
terminals('16', '1') = 0.8702590363502473; terminals('16', '2') = 0.205129232520061; terminals('16', '3') = 0.14615031279839907; terminals('16', '4') = 0.107491311500574; 
terminals('17', '1') = 0.7895198725756678; terminals('17', '2') = 0.394933275352092; terminals('17', '3') = 0.7442826370776762; terminals('17', '4') = 0.3036512636688945; 
terminals('18', '1') = 0.6606902064536205; terminals('18', '2') = 0.6372155130843187; terminals('18', '3') = 0.38391620444917773; terminals('18', '4') = 0.17286055863024807; 
terminals('19', '1') = 0.9416517137884097; terminals('19', '2') = 0.42901995941096094; terminals('19', '3') = 0.6391553939055744; terminals('19', '4') = 0.6168353034453201; 
terminals('20', '1') = 0.03179250495099528; terminals('20', '2') = 0.5914469682267048; terminals('20', '3') = 0.6913739121148023; terminals('20', '4') = 0.5670283797441411; 
terminals('21', '1') = 0.2169520096346732; terminals('21', '2') = 0.8584544171514705; terminals('21', '3') = 0.030380541436583752; terminals('21', '4') = 0.06545604954675255; 
terminals('22', '1') = 0.08389321210987111; terminals('22', '2') = 0.38747064607519643; terminals('22', '3') = 0.589879532667547; terminals('22', '4') = 0.8979382762464111; 
terminals('23', '1') = 0.03951348868766014; terminals('23', '2') = 0.8414171698644511; terminals('23', '3') = 0.5993060839274001; terminals('23', '4') = 0.19829168163940192; 
terminals('24', '1') = 0.3624651022128176; terminals('24', '2') = 0.6035567239515969; terminals('24', '3') = 0.3303732606476688; terminals('24', '4') = 0.6365074476789606; 
terminals('25', '1') = 0.03113596058754131; terminals('25', '2') = 0.6456374926601384; terminals('25', '3') = 0.45014891034711846; terminals('25', '4') = 0.07107508812405483; 
terminals('26', '1') = 0.015458751768947843; terminals('26', '2') = 0.014522483218780469; terminals('26', '3') = 0.4465592424039688; terminals('26', '4') = 0.5166152632312095; 
terminals('27', '1') = 0.8039295937498655; terminals('27', '2') = 0.9850536812765522; terminals('27', '3') = 0.645040071914947; terminals('27', '4') = 0.2116264299608387; 
terminals('28', '1') = 0.04570370201793705; terminals('28', '2') = 0.3416902093174212; terminals('28', '3') = 0.29449314942150506; terminals('28', '4') = 0.4381760785367178; 
terminals('29', '1') = 0.35612327436055136; terminals('29', '2') = 0.040090014507067506; terminals('29', '3') = 0.8992513251477188; terminals('29', '4') = 0.4237374481943451; 
terminals('30', '1') = 0.7827206042613836; terminals('30', '2') = 0.3878293789074767; terminals('30', '3') = 0.8363365298797815; terminals('30', '4') = 0.3783076597774694; 
terminals('31', '1') = 0.9672425539431136; terminals('31', '2') = 0.381898891885597; terminals('31', '3') = 0.0015580766477453212; terminals('31', '4') = 0.2013904135711947; 
terminals('32', '1') = 0.7807053191960718; terminals('32', '2') = 0.35440343707609645; terminals('32', '3') = 0.04829930622788192; terminals('32', '4') = 0.7292950156036617; 
terminals('33', '1') = 0.12235414657743127; terminals('33', '2') = 0.6294069386136322; terminals('33', '3') = 0.8017639035334784; terminals('33', '4') = 0.7804327368595637; 
terminals('34', '1') = 0.5842028836939287; terminals('34', '2') = 0.04420280558764078; terminals('34', '3') = 0.39759638495707805; terminals('34', '4') = 0.5590427311859697; 
terminals('35', '1') = 0.7581820669832062; terminals('35', '2') = 0.05494380294806123; terminals('35', '3') = 0.8095137502239066; terminals('35', '4') = 0.4408489573829091; 
terminals('36', '1') = 0.9686875460315043; terminals('36', '2') = 0.6680596944858201; terminals('36', '3') = 0.8335742090050073; terminals('36', '4') = 0.5336444415966143; 
terminals('37', '1') = 0.15770650440270173; terminals('37', '2') = 0.5565178209469913; terminals('37', '3') = 0.962666313507055; terminals('37', '4') = 0.8420014650980541; 
terminals('38', '1') = 0.27259228209979436; terminals('38', '2') = 0.2785921411961164; terminals('38', '3') = 0.968433230021599; terminals('38', '4') = 0.19549582595843296; 
terminals('39', '1') = 0.6045859938279272; terminals('39', '2') = 0.9676440109158194; terminals('39', '3') = 0.34869646685759703; terminals('39', '4') = 0.12039645735911919; 
terminals('40', '1') = 0.6736426756779942; terminals('40', '2') = 0.19466681117014417; terminals('40', '3') = 0.3412417991178224; terminals('40', '4') = 0.9265774618022464; 
terminals('41', '1') = 0.45000665820979147; terminals('41', '2') = 0.31380317297550675; terminals('41', '3') = 0.5451896008638016; terminals('41', '4') = 0.2097921459740011; 
terminals('42', '1') = 0.5277985487614228; terminals('42', '2') = 0.36537516307814943; terminals('42', '3') = 0.8864481283746772; terminals('42', '4') = 0.4531084906418522; 
terminals('43', '1') = 0.27516501896934775; terminals('43', '2') = 0.9783114405525773; terminals('43', '3') = 0.5730731458149129; terminals('43', '4') = 0.8009467967361926; 
terminals('44', '1') = 0.8830526253043408; terminals('44', '2') = 0.24708606291079405; terminals('44', '3') = 0.9411183959665772; terminals('44', '4') = 0.6496238401791858; 
terminals('45', '1') = 0.4803965460043952; terminals('45', '2') = 0.24041452113801753; terminals('45', '3') = 0.1832467511448188; terminals('45', '4') = 0.7547624417701762; 
terminals('46', '1') = 0.7871174180231629; terminals('46', '2') = 0.8284551646041691; terminals('46', '3') = 0.9660813352997589; terminals('46', '4') = 0.952272771411663; 
terminals('47', '1') = 0.6991037389353322; terminals('47', '2') = 0.6035495643444244; terminals('47', '3') = 0.45463288757897347; terminals('47', '4') = 0.8896392036385404; 
terminals('48', '1') = 0.25074967904805956; terminals('48', '2') = 0.24457998888752364; terminals('48', '3') = 0.44235163463559213; terminals('48', '4') = 0.844164399977756; 
terminals('49', '1') = 0.9165814699503152; terminals('49', '2') = 0.5020563635369024; terminals('49', '3') = 0.668128850622424; terminals('49', '4') = 0.9457898080684891; 
terminals('50', '1') = 0.40364584731196695; terminals('50', '2') = 0.8298309543690146; terminals('50', '3') = 0.16642929618930002; terminals('50', '4') = 0.21903919600243404; 
terminals('51', '1') = 0.9461802192018578; terminals('51', '2') = 0.10816659305930576; terminals('51', '3') = 0.2437952596683418; terminals('51', '4') = 0.5991163654755294; 
terminals('52', '1') = 0.7732920127294252; terminals('52', '2') = 0.3490600117283611; terminals('52', '3') = 0.5913203323060244; terminals('52', '4') = 0.38642490544520125; 
terminals('53', '1') = 0.8854227774469536; terminals('53', '2') = 0.8419800610926954; terminals('53', '3') = 0.7788823433771762; terminals('53', '4') = 0.49161893538434265; 
terminals('54', '1') = 0.00802274017859339; terminals('54', '2') = 0.11161796054910478; terminals('54', '3') = 0.6319317742303264; terminals('54', '4') = 0.32824123298719077; 
terminals('55', '1') = 0.8483290578776839; terminals('55', '2') = 0.6695745340710115; terminals('55', '3') = 0.4231047585385096; terminals('55', '4') = 0.29110769952570525; 
terminals('56', '1') = 0.5043096060157163; terminals('56', '2') = 0.6088064258767943; terminals('56', '3') = 0.07044668313657687; terminals('56', '4') = 0.04990988138610286; 
terminals('57', '1') = 0.65888489674685; terminals('57', '2') = 0.3170036503302588; terminals('57', '3') = 0.04476566447674202; terminals('57', '4') = 0.5893926470034497; 
terminals('58', '1') = 0.07909798794537404; terminals('58', '2') = 0.16023283077358874; terminals('58', '3') = 0.37980190819556303; terminals('58', '4') = 0.3432299034902053; 
terminals('59', '1') = 0.3797298720696307; terminals('59', '2') = 0.6034810433473115; terminals('59', '3') = 0.1516263773037797; terminals('59', '4') = 0.587175925937779; 
terminals('60', '1') = 0.6741464759849484; terminals('60', '2') = 0.30562207421102805; terminals('60', '3') = 0.057025728267064535; terminals('60', '4') = 0.46140882719019904; 
terminals('61', '1') = 0.2796310703365631; terminals('61', '2') = 0.06994153016325733; terminals('61', '3') = 0.5014840930880187; terminals('61', '4') = 0.3650967577997687; 
terminals('62', '1') = 0.128917585614454; terminals('62', '2') = 0.18228638462050606; terminals('62', '3') = 0.3313129766843891; terminals('62', '4') = 0.8883380333240976; 
terminals('63', '1') = 0.6088491460515337; terminals('63', '2') = 0.25840314990954627; terminals('63', '3') = 0.560617938980244; terminals('63', '4') = 0.6907404609870454; 
terminals('64', '1') = 0.09265115984287653; terminals('64', '2') = 0.7198250455731111; terminals('64', '3') = 0.6817623134510699; terminals('64', '4') = 0.37983458327537345; 
terminals('65', '1') = 0.24016829664289518; terminals('65', '2') = 0.39031411738954624; terminals('65', '3') = 0.11358866920642807; terminals('65', '4') = 0.09353680315710344; 
terminals('66', '1') = 0.8963096485003641; terminals('66', '2') = 0.7348120530468292; terminals('66', '3') = 0.7016820699002506; terminals('66', '4') = 0.23047977620065374; 
terminals('67', '1') = 0.044413495458424435; terminals('67', '2') = 0.3699562452760633; terminals('67', '3') = 0.9131410484783282; terminals('67', '4') = 0.405334406460244; 
terminals('68', '1') = 0.7854071064008382; terminals('68', '2') = 0.21206867883263114; terminals('68', '3') = 0.5239054649360507; terminals('68', '4') = 0.6628439139797319; 
terminals('69', '1') = 0.83697688659056; terminals('69', '2') = 0.13000461282923892; terminals('69', '3') = 0.8959407040969449; terminals('69', '4') = 0.6250214727346992; 
terminals('70', '1') = 0.7075449593978352; terminals('70', '2') = 0.1367836811687706; terminals('70', '3') = 0.8861426367263125; terminals('70', '4') = 0.6929217515237983; 
terminals('71', '1') = 0.12310964108121625; terminals('71', '2') = 0.5393901262385409; terminals('71', '3') = 0.26746679844170573; terminals('71', '4') = 0.436891818528791; 
terminals('72', '1') = 0.9596866162296039; terminals('72', '2') = 0.48946026729631664; terminals('72', '3') = 0.6959575744809926; terminals('72', '4') = 0.23280043696130426; 
terminals('73', '1') = 0.3095913751194398; terminals('73', '2') = 0.21078925090146916; terminals('73', '3') = 0.4000749431645444; terminals('73', '4') = 0.17774696627152853; 
terminals('74', '1') = 0.7242097862333337; terminals('74', '2') = 0.10963139188923277; terminals('74', '3') = 0.458889237308181; terminals('74', '4') = 0.7441668483139576; 
terminals('75', '1') = 0.007864684969059232; terminals('75', '2') = 0.5254136969572878; terminals('75', '3') = 0.6091534634078397; terminals('75', '4') = 0.45805499853083265; 
terminals('76', '1') = 0.943070774224704; terminals('76', '2') = 0.4804693135912794; terminals('76', '3') = 0.30878573857238667; terminals('76', '4') = 0.15320092008085173; 
terminals('77', '1') = 0.40371323017921934; terminals('77', '2') = 0.6769351612292416; terminals('77', '3') = 0.11331403052260036; terminals('77', '4') = 0.03267030236120516; 
terminals('78', '1') = 0.35274152265369174; terminals('78', '2') = 0.8101254636690483; terminals('78', '3') = 0.22474352604503578; terminals('78', '4') = 0.47203849506271145; 
terminals('79', '1') = 0.9473860341895137; terminals('79', '2') = 0.2339701880077366; terminals('79', '3') = 0.9595472951933244; terminals('79', '4') = 0.606187256597862; 
terminals('80', '1') = 0.12355634676685756; terminals('80', '2') = 0.8938421174565612; terminals('80', '3') = 0.4371842719294927; terminals('80', '4') = 0.9210517444974321; 
Parameter bigM / 2.0 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
