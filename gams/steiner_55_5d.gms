Sets
i Steiner points / 1*53 /
j terminals / 1*55 /
k dimensions / 1*5 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.7596439854481012; terminals('1', '2') = 0.8277319827984633; terminals('1', '3') = 0.5707523206581371; terminals('1', '4') = 0.3712906655468997; terminals('1', '5') = 0.29566885024337497; 
terminals('2', '1') = 0.1791317676801455; terminals('2', '2') = 0.3321363164929554; terminals('2', '3') = 0.626666433988293; terminals('2', '4') = 0.8648304576581199; terminals('2', '5') = 0.6192765858305823; 
terminals('3', '1') = 0.35724284092983305; terminals('3', '2') = 0.4398069796922578; terminals('3', '3') = 0.5612642981354817; terminals('3', '4') = 0.868350725113401; terminals('3', '5') = 0.8891390970605841; 
terminals('4', '1') = 0.7000939307892393; terminals('4', '2') = 0.2297008127361473; terminals('4', '3') = 0.6146966714148647; terminals('4', '4') = 0.693707701360373; terminals('4', '5') = 0.04659058543721106; 
terminals('5', '1') = 0.35319738979266047; terminals('5', '2') = 0.31428083197940904; terminals('5', '3') = 0.8048540648224181; terminals('5', '4') = 0.6698273636508365; terminals('5', '5') = 0.35146750807305394; 
terminals('6', '1') = 0.7715689701302639; terminals('6', '2') = 0.6608819439838491; terminals('6', '3') = 0.8720798826287274; terminals('6', '4') = 0.8879362263018751; terminals('6', '5') = 0.6916872073172631; 
terminals('7', '1') = 0.18789451094869059; terminals('7', '2') = 0.8590350709719466; terminals('7', '3') = 0.09090487837494643; terminals('7', '4') = 0.19837580199332427; terminals('7', '5') = 0.9488560480488178; 
terminals('8', '1') = 0.7252574519794961; terminals('8', '2') = 0.517947503315764; terminals('8', '3') = 0.8008907615008585; terminals('8', '4') = 0.12063153213657751; terminals('8', '5') = 0.5997369573051508; 
terminals('9', '1') = 0.3296564551506699; terminals('9', '2') = 0.3220282434478591; terminals('9', '3') = 0.7965664119252835; terminals('9', '4') = 0.2247201220774243; terminals('9', '5') = 0.026540712234837338; 
terminals('10', '1') = 0.2657356790092529; terminals('10', '2') = 0.7927285848151138; terminals('10', '3') = 0.40770534780938594; terminals('10', '4') = 0.2513038566141854; terminals('10', '5') = 0.9648766760005214; 
terminals('11', '1') = 0.2254438848534488; terminals('11', '2') = 0.5450945901056061; terminals('11', '3') = 0.1094753964468077; terminals('11', '4') = 0.4412278102475654; terminals('11', '5') = 0.9442629116068882; 
terminals('12', '1') = 0.0914492115199751; terminals('12', '2') = 0.921946371192216; terminals('12', '3') = 0.5958525286078603; terminals('12', '4') = 0.984965571132206; terminals('12', '5') = 0.3042520389486455; 
terminals('13', '1') = 0.35931685079531783; terminals('13', '2') = 0.3324824870031827; terminals('13', '3') = 0.17368899713439423; terminals('13', '4') = 0.12755914126344392; terminals('13', '5') = 0.8448980645153029; 
terminals('14', '1') = 0.7179297575630629; terminals('14', '2') = 0.770366255315522; terminals('14', '3') = 0.5046740622743915; terminals('14', '4') = 0.6276885086075644; terminals('14', '5') = 0.5816622875765041; 
terminals('15', '1') = 0.4833264156469388; terminals('15', '2') = 0.9860598189091377; terminals('15', '3') = 0.7217164509135547; terminals('15', '4') = 0.5640432249924704; terminals('15', '5') = 0.3424045410763794; 
terminals('16', '1') = 0.6801325939561401; terminals('16', '2') = 0.13017294243238664; terminals('16', '3') = 0.5494106786415434; terminals('16', '4') = 0.23701864929286998; terminals('16', '5') = 0.1634710257034372; 
terminals('17', '1') = 0.10560396404483707; terminals('17', '2') = 0.6902585567308018; terminals('17', '3') = 0.8178744652387387; terminals('17', '4') = 0.2732182939663017; terminals('17', '5') = 0.36460924009760454; 
terminals('18', '1') = 0.6123752073650625; terminals('18', '2') = 0.4922409825990427; terminals('18', '3') = 0.0037959762113275453; terminals('18', '4') = 0.4551723654092089; terminals('18', '5') = 0.012863205199524552; 
terminals('19', '1') = 0.7421213961669172; terminals('19', '2') = 0.5545263529726236; terminals('19', '3') = 0.9521337799471508; terminals('19', '4') = 0.9568312259974007; terminals('19', '5') = 0.7314008624396289; 
terminals('20', '1') = 0.058490753006280705; terminals('20', '2') = 0.09447240838792803; terminals('20', '3') = 0.2125885400562043; terminals('20', '4') = 0.16639030862746107; terminals('20', '5') = 0.4897296500552464; 
terminals('21', '1') = 0.9510393404867483; terminals('21', '2') = 0.7841454701198914; terminals('21', '3') = 0.874761288607431; terminals('21', '4') = 0.5255086449598012; terminals('21', '5') = 0.08469241000747896; 
terminals('22', '1') = 0.003952112429023158; terminals('22', '2') = 0.5501887580956387; terminals('22', '3') = 0.49464794048129357; terminals('22', '4') = 0.7449616006489251; terminals('22', '5') = 0.9769572476269539; 
terminals('23', '1') = 0.04697529855601634; terminals('23', '2') = 0.6645000170366762; terminals('23', '3') = 0.18322761638731278; terminals('23', '4') = 0.7743027704500357; terminals('23', '5') = 0.3725386374316595; 
terminals('24', '1') = 0.4620131724759111; terminals('24', '2') = 0.3380831037462242; terminals('24', '3') = 0.814096564386308; terminals('24', '4') = 0.8494844222158533; terminals('24', '5') = 0.3456376373441653; 
terminals('25', '1') = 0.729486695264704; terminals('25', '2') = 0.47067180268114106; terminals('25', '3') = 0.3367554233016061; terminals('25', '4') = 0.5167262285203549; terminals('25', '5') = 0.5777091844052005; 
terminals('26', '1') = 0.3604397631183972; terminals('26', '2') = 0.8035186644694544; terminals('26', '3') = 0.5760996199243422; terminals('26', '4') = 0.08183188256824947; terminals('26', '5') = 0.16818124412662716; 
terminals('27', '1') = 0.4277445365787481; terminals('27', '2') = 0.17523102328590268; terminals('27', '3') = 0.48999983807514436; terminals('27', '4') = 0.5088015172223292; terminals('27', '5') = 0.7750287026729689; 
terminals('28', '1') = 0.8343536504569689; terminals('28', '2') = 0.3478812448196199; terminals('28', '3') = 0.25312664130887974; terminals('28', '4') = 0.6030170346584419; terminals('28', '5') = 0.3249179911368941; 
terminals('29', '1') = 0.7525338848822477; terminals('29', '2') = 0.7149202368143929; terminals('29', '3') = 0.4186176939165187; terminals('29', '4') = 0.9159178934696423; terminals('29', '5') = 0.2515494341089708; 
terminals('30', '1') = 0.41067915752684847; terminals('30', '2') = 0.5052304457443612; terminals('30', '3') = 0.35132389415527887; terminals('30', '4') = 0.12544982778582858; terminals('30', '5') = 0.37255664927234355; 
terminals('31', '1') = 0.6275716099818058; terminals('31', '2') = 0.712807228702048; terminals('31', '3') = 0.7479240734543592; terminals('31', '4') = 0.4437358036676695; terminals('31', '5') = 0.5241692151643473; 
terminals('32', '1') = 0.3112795202890537; terminals('32', '2') = 0.48719761477659707; terminals('32', '3') = 0.2656219061731764; terminals('32', '4') = 0.9837263492109168; terminals('32', '5') = 0.7495081564047071; 
terminals('33', '1') = 0.21802023454847108; terminals('33', '2') = 0.6537216138885795; terminals('33', '3') = 0.2008099500804974; terminals('33', '4') = 0.91358432253931; terminals('33', '5') = 0.2989191404349476; 
terminals('34', '1') = 0.2241403237906271; terminals('34', '2') = 0.3884725320783855; terminals('34', '3') = 0.3139558678833707; terminals('34', '4') = 0.11493806888935354; terminals('34', '5') = 0.23307459807890418; 
terminals('35', '1') = 0.25012554899987227; terminals('35', '2') = 0.2532541850352312; terminals('35', '3') = 0.8811452571111817; terminals('35', '4') = 0.4560348957218646; terminals('35', '5') = 0.5041964780475283; 
terminals('36', '1') = 0.38455509224000906; terminals('36', '2') = 0.17791794359511137; terminals('36', '3') = 0.829195098617962; terminals('36', '4') = 0.8968189180557158; terminals('36', '5') = 0.11151857832892798; 
terminals('37', '1') = 0.2785222283220097; terminals('37', '2') = 0.300894937007937; terminals('37', '3') = 0.9407773034783962; terminals('37', '4') = 0.17209320579459986; terminals('37', '5') = 0.679735889325824; 
terminals('38', '1') = 0.02591186778442034; terminals('38', '2') = 0.5581341527101654; terminals('38', '3') = 0.5348836617644533; terminals('38', '4') = 0.5337244020314112; terminals('38', '5') = 0.7231247685241482; 
terminals('39', '1') = 0.3065877355802863; terminals('39', '2') = 0.6380152269375104; terminals('39', '3') = 0.2383308447983007; terminals('39', '4') = 0.2558185496957709; terminals('39', '5') = 0.9751386962586887; 
terminals('40', '1') = 0.21402959351866202; terminals('40', '2') = 0.4115433263701852; terminals('40', '3') = 0.22147954047216367; terminals('40', '4') = 0.39528463051660534; terminals('40', '5') = 0.01614303462027611; 
terminals('41', '1') = 0.16142754157935824; terminals('41', '2') = 0.2606364314252215; terminals('41', '3') = 0.9816505544974696; terminals('41', '4') = 0.6696873804362743; terminals('41', '5') = 0.47726485482898506; 
terminals('42', '1') = 0.8017833436352835; terminals('42', '2') = 0.17254605261954048; terminals('42', '3') = 0.4133438512105785; terminals('42', '4') = 0.29924336781326777; terminals('42', '5') = 0.1459491868343139; 
terminals('43', '1') = 0.37262044554844365; terminals('43', '2') = 0.5881014015408962; terminals('43', '3') = 0.16330247494874572; terminals('43', '4') = 0.609971094823566; terminals('43', '5') = 0.15625468706526313; 
terminals('44', '1') = 0.7605259650967643; terminals('44', '2') = 0.03836529158457114; terminals('44', '3') = 0.2551662057970344; terminals('44', '4') = 0.7879048759673718; terminals('44', '5') = 0.33466499826587337; 
terminals('45', '1') = 0.6526383037272577; terminals('45', '2') = 0.7670646904210503; terminals('45', '3') = 0.4066841472648348; terminals('45', '4') = 0.023842109345669216; terminals('45', '5') = 0.5902024452167912; 
terminals('46', '1') = 0.5548116457351358; terminals('46', '2') = 0.53038250346928; terminals('46', '3') = 0.07301105970578747; terminals('46', '4') = 0.75148858142359; terminals('46', '5') = 0.25514497215071585; 
terminals('47', '1') = 0.4951694015114658; terminals('47', '2') = 0.024219956520255437; terminals('47', '3') = 0.9866464344872631; terminals('47', '4') = 0.5838678985466729; terminals('47', '5') = 0.5672814679290678; 
terminals('48', '1') = 0.1225142354214448; terminals('48', '2') = 0.7762341601757766; terminals('48', '3') = 0.9902853506534827; terminals('48', '4') = 0.049864727474436044; terminals('48', '5') = 0.9926373943190626; 
terminals('49', '1') = 0.7915348282423396; terminals('49', '2') = 0.43984624940214045; terminals('49', '3') = 0.4487956923908145; terminals('49', '4') = 0.13654872398426154; terminals('49', '5') = 0.4317398638922376; 
terminals('50', '1') = 0.8184553814174357; terminals('50', '2') = 0.14167244671135415; terminals('50', '3') = 0.24281157568694378; terminals('50', '4') = 0.7384894243563517; terminals('50', '5') = 0.5746412554901674; 
terminals('51', '1') = 0.207235523709287; terminals('51', '2') = 0.2568559292568475; terminals('51', '3') = 0.7516817121454153; terminals('51', '4') = 0.03065908268195139; terminals('51', '5') = 0.12383877551965927; 
terminals('52', '1') = 0.27241661588979826; terminals('52', '2') = 0.4224958557798927; terminals('52', '3') = 0.6984555344287956; terminals('52', '4') = 0.19329986473917216; terminals('52', '5') = 0.013180975067886402; 
terminals('53', '1') = 0.9400057835086395; terminals('53', '2') = 0.11148685061545294; terminals('53', '3') = 0.9869756044043062; terminals('53', '4') = 0.0742442971581544; terminals('53', '5') = 0.697819092807307; 
terminals('54', '1') = 0.6334325199414804; terminals('54', '2') = 0.8012923497808535; terminals('54', '3') = 0.31881501130777656; terminals('54', '4') = 0.8500789570924411; terminals('54', '5') = 0.6291667566519277; 
terminals('55', '1') = 0.9055856994506755; terminals('55', '2') = 0.88501875260022; terminals('55', '3') = 0.4513966988148739; terminals('55', '4') = 0.1271411905800489; terminals('55', '5') = 0.034078521401926465; 
Parameter bigM / 2.23606797749979 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
