Sets
i Steiner points / 1*63 /
j terminals / 1*65 /
k dimensions / 1*5 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.5507538158685366; terminals('1', '2') = 0.1256613400887654; terminals('1', '3') = 0.12154778818784495; terminals('1', '4') = 0.9148461574417326; terminals('1', '5') = 0.6586016422075806; 
terminals('2', '1') = 0.17066156383965203; terminals('2', '2') = 0.926500918294576; terminals('2', '3') = 0.23634153038454409; terminals('2', '4') = 0.6798939472402181; terminals('2', '5') = 0.9571485489420571; 
terminals('3', '1') = 0.12029126791442368; terminals('3', '2') = 0.6129514278652578; terminals('3', '3') = 0.8593780776917862; terminals('3', '4') = 0.9202725597560185; terminals('3', '5') = 0.14023290988409576; 
terminals('4', '1') = 0.5092545836796418; terminals('4', '2') = 0.44712155662830433; terminals('4', '3') = 0.19927436180363678; terminals('4', '4') = 0.00698628018567804; terminals('4', '5') = 0.49878891441096074; 
terminals('5', '1') = 0.18917432840250903; terminals('5', '2') = 0.2723260973136088; terminals('5', '3') = 0.3813458527071526; terminals('5', '4') = 0.35929849629822974; terminals('5', '5') = 0.9717413820448308; 
terminals('6', '1') = 0.48051950398515875; terminals('6', '2') = 0.07845809584453611; terminals('6', '3') = 0.2175785753412679; terminals('6', '4') = 0.9188866494794282; terminals('6', '5') = 0.6368088556749502; 
terminals('7', '1') = 0.627306053932165; terminals('7', '2') = 0.3211540416238604; terminals('7', '3') = 0.31353485945862536; terminals('7', '4') = 0.39516722588164976; terminals('7', '5') = 0.2878083172476602; 
terminals('8', '1') = 0.8623983991975603; terminals('8', '2') = 0.7307459437585702; terminals('8', '3') = 0.36978296732380744; terminals('8', '4') = 0.45496556227968266; terminals('8', '5') = 0.26983576230088646; 
terminals('9', '1') = 0.7655419809369689; terminals('9', '2') = 0.3216020777519192; terminals('9', '3') = 0.23863557083910802; terminals('9', '4') = 0.3350250681681457; terminals('9', '5') = 0.18283906218028367; 
terminals('10', '1') = 0.07497066623807891; terminals('10', '2') = 0.2675251098319461; terminals('10', '3') = 0.7718823731869509; terminals('10', '4') = 0.08470502795377399; terminals('10', '5') = 0.4554891923776543; 
terminals('11', '1') = 0.2310718841948467; terminals('11', '2') = 0.05734613361288521; terminals('11', '3') = 0.19793765295206422; terminals('11', '4') = 0.013295941855535509; terminals('11', '5') = 0.9057019850452059; 
terminals('12', '1') = 0.9522663133410935; terminals('12', '2') = 0.09270718868549721; terminals('12', '3') = 0.5571507468962267; terminals('12', '4') = 0.8362766300518331; terminals('12', '5') = 0.3421725346001755; 
terminals('13', '1') = 0.2447357551053485; terminals('13', '2') = 0.9775533718738395; terminals('13', '3') = 0.9116693762983743; terminals('13', '4') = 0.7759852892144047; terminals('13', '5') = 0.22763904431023618; 
terminals('14', '1') = 0.5359629102655242; terminals('14', '2') = 0.7735217516730979; terminals('14', '3') = 0.8574747272817979; terminals('14', '4') = 0.042268829128756735; terminals('14', '5') = 0.5901184193825126; 
terminals('15', '1') = 0.2969517137744164; terminals('15', '2') = 0.3793696583922409; terminals('15', '3') = 0.15959175950454996; terminals('15', '4') = 0.51573178547799; terminals('15', '5') = 0.21921736536706093; 
terminals('16', '1') = 0.3645655004474796; terminals('16', '2') = 0.5089889107032669; terminals('16', '3') = 0.23005876068149378; terminals('16', '4') = 0.8984235013051954; terminals('16', '5') = 0.07404533741619068; 
terminals('17', '1') = 0.72760536968155; terminals('17', '2') = 0.5500883611689064; terminals('17', '3') = 0.6092411870550435; terminals('17', '4') = 0.5950657639370931; terminals('17', '5') = 0.9939458077414884; 
terminals('18', '1') = 0.5190519113375068; terminals('18', '2') = 0.8624809979910686; terminals('18', '3') = 0.7951871064611898; terminals('18', '4') = 0.19064035780615973; terminals('18', '5') = 0.5451196635964954; 
terminals('19', '1') = 0.537485191670469; terminals('19', '2') = 0.49678362196711656; terminals('19', '3') = 0.8185682736646155; terminals('19', '4') = 0.5771618108636122; terminals('19', '5') = 0.7283888612503412; 
terminals('20', '1') = 0.0727991069860634; terminals('20', '2') = 0.9379564017351066; terminals('20', '3') = 0.8795019573218193; terminals('20', '4') = 0.10655356980023656; terminals('20', '5') = 0.6970297316145599; 
terminals('21', '1') = 0.8551363039659873; terminals('21', '2') = 0.4016789006216719; terminals('21', '3') = 0.10917053434090274; terminals('21', '4') = 0.27498286572761865; terminals('21', '5') = 0.4237463191988884; 
terminals('22', '1') = 0.6741633313446596; terminals('22', '2') = 0.0879416749331855; terminals('22', '3') = 0.5582238675421982; terminals('22', '4') = 0.6521175463437346; terminals('22', '5') = 0.10614363303369012; 
terminals('23', '1') = 0.2847217370859093; terminals('23', '2') = 0.6868132457553476; terminals('23', '3') = 0.4701820022234293; terminals('23', '4') = 0.46849040901385275; terminals('23', '5') = 0.18902807098439733; 
terminals('24', '1') = 0.6966013865751682; terminals('24', '2') = 0.7178338555764149; terminals('24', '3') = 0.3053520720185454; terminals('24', '4') = 0.7334244196130575; terminals('24', '5') = 0.011918915727979873; 
terminals('25', '1') = 0.8164989600364237; terminals('25', '2') = 0.12876674933375565; terminals('25', '3') = 0.7372069490393879; terminals('25', '4') = 0.7319771836729626; terminals('25', '5') = 0.4032645794746377; 
terminals('26', '1') = 0.2390050179203438; terminals('26', '2') = 0.18847648385396465; terminals('26', '3') = 0.9269049358249772; terminals('26', '4') = 0.18460001230870515; terminals('26', '5') = 0.10707708472442456; 
terminals('27', '1') = 0.4538423815662882; terminals('27', '2') = 0.21943325116314605; terminals('27', '3') = 0.7060337957650736; terminals('27', '4') = 0.7135926628456436; terminals('27', '5') = 0.5557096155950152; 
terminals('28', '1') = 0.7756996958449114; terminals('28', '2') = 0.00339327923686783; terminals('28', '3') = 0.43409013842244515; terminals('28', '4') = 0.7449303158264624; terminals('28', '5') = 0.5525897645246207; 
terminals('29', '1') = 0.06827174600838548; terminals('29', '2') = 0.779611494932993; terminals('29', '3') = 0.9044697311176718; terminals('29', '4') = 0.1926550816705952; terminals('29', '5') = 0.5339997730911359; 
terminals('30', '1') = 0.6171803594449504; terminals('30', '2') = 0.33997088639865713; terminals('30', '3') = 0.3546293700394285; terminals('30', '4') = 0.3719370878720748; terminals('30', '5') = 0.6692884618403738; 
terminals('31', '1') = 0.8451798413485431; terminals('31', '2') = 0.10438055539506097; terminals('31', '3') = 0.8245337404472662; terminals('31', '4') = 0.531416624168066; terminals('31', '5') = 0.7498012764869454; 
terminals('32', '1') = 0.7046992018918166; terminals('32', '2') = 0.10815920772736654; terminals('32', '3') = 0.09022996319773047; terminals('32', '4') = 0.8151085747544063; terminals('32', '5') = 0.7304363181298074; 
terminals('33', '1') = 0.6042202408619836; terminals('33', '2') = 0.11026985590543803; terminals('33', '3') = 0.3376626502601796; terminals('33', '4') = 0.3834764187708126; terminals('33', '5') = 0.22803323649721408; 
terminals('34', '1') = 0.8715784281466998; terminals('34', '2') = 0.15289470078731848; terminals('34', '3') = 0.8790438364201508; terminals('34', '4') = 0.38610482374973976; terminals('34', '5') = 0.8869436722951736; 
terminals('35', '1') = 0.6708814112808065; terminals('35', '2') = 0.9063088072606968; terminals('35', '3') = 0.5854262171502868; terminals('35', '4') = 0.16218382900196548; terminals('35', '5') = 0.33577976791339215; 
terminals('36', '1') = 0.4298813473183559; terminals('36', '2') = 0.451615786757695; terminals('36', '3') = 0.5267685782433923; terminals('36', '4') = 0.729130376395028; terminals('36', '5') = 0.05773673931397649; 
terminals('37', '1') = 0.5891396037154617; terminals('37', '2') = 0.7467008468718149; terminals('37', '3') = 0.03489600741152954; terminals('37', '4') = 0.3293774805905584; terminals('37', '5') = 0.39674696253916064; 
terminals('38', '1') = 0.9872354230654729; terminals('38', '2') = 0.4954094615705674; terminals('38', '3') = 0.237870965085912; terminals('38', '4') = 0.6525539094101528; terminals('38', '5') = 0.6819767713262727; 
terminals('39', '1') = 0.6483129105428682; terminals('39', '2') = 0.3029389924742556; terminals('39', '3') = 0.8034189402133013; terminals('39', '4') = 0.6697775059667722; terminals('39', '5') = 0.17769688437943854; 
terminals('40', '1') = 0.6097978787527149; terminals('40', '2') = 0.5866297850442923; terminals('40', '3') = 0.6425291308568242; terminals('40', '4') = 0.743110178361536; terminals('40', '5') = 0.6521317119359503; 
terminals('41', '1') = 0.12600423979609088; terminals('41', '2') = 0.23344014261013069; terminals('41', '3') = 0.673623044089587; terminals('41', '4') = 0.8932759267541278; terminals('41', '5') = 0.4190652299133377; 
terminals('42', '1') = 0.8628280926167469; terminals('42', '2') = 0.7013597025891781; terminals('42', '3') = 0.1916704327502604; terminals('42', '4') = 0.8170944215906742; terminals('42', '5') = 0.8702178336397752; 
terminals('43', '1') = 0.032467900564234875; terminals('43', '2') = 0.12508183641973547; terminals('43', '3') = 0.8735483701435843; terminals('43', '4') = 0.6127540910825742; terminals('43', '5') = 0.9138755155367663; 
terminals('44', '1') = 0.3253055837308295; terminals('44', '2') = 0.2882967395809978; terminals('44', '3') = 0.23092276705472936; terminals('44', '4') = 0.193863545488279; terminals('44', '5') = 0.2029569333137854; 
terminals('45', '1') = 0.3460828583031702; terminals('45', '2') = 0.6862365673176442; terminals('45', '3') = 0.40376916509845284; terminals('45', '4') = 0.5772605646024338; terminals('45', '5') = 0.6702535205525985; 
terminals('46', '1') = 0.9475785249577392; terminals('46', '2') = 0.06297216395637206; terminals('46', '3') = 0.6433874761253904; terminals('46', '4') = 0.6984495370497666; terminals('46', '5') = 0.08987130851115888; 
terminals('47', '1') = 0.9579646164937086; terminals('47', '2') = 0.3477714334587596; terminals('47', '3') = 0.18506311980350876; terminals('47', '4') = 0.8758578066730138; terminals('47', '5') = 0.2865059544149007; 
terminals('48', '1') = 0.4439612018171357; terminals('48', '2') = 0.38442917136377996; terminals('48', '3') = 0.0002548079831660166; terminals('48', '4') = 0.3781633159918183; terminals('48', '5') = 0.06062882698594596; 
terminals('49', '1') = 0.8908878763231491; terminals('49', '2') = 0.7872098116919796; terminals('49', '3') = 0.5922990189379606; terminals('49', '4') = 0.5209988759535078; terminals('49', '5') = 0.9090569904843742; 
terminals('50', '1') = 0.9072019380242065; terminals('50', '2') = 0.417032250389747; terminals('50', '3') = 0.492363405434184; terminals('50', '4') = 0.35335854609593775; terminals('50', '5') = 0.16006396714056026; 
terminals('51', '1') = 0.6580914295095696; terminals('51', '2') = 0.0771019567764547; terminals('51', '3') = 0.6621124534018479; terminals('51', '4') = 0.37624528316359906; terminals('51', '5') = 0.18259985936026601; 
terminals('52', '1') = 0.9299569873076834; terminals('52', '2') = 0.36850665957945006; terminals('52', '3') = 0.5072013489221687; terminals('52', '4') = 0.4782258987977792; terminals('52', '5') = 0.8972861371443013; 
terminals('53', '1') = 0.24997306675094788; terminals('53', '2') = 0.3251733784471694; terminals('53', '3') = 0.3143578749873114; terminals('53', '4') = 0.37191383357869967; terminals('53', '5') = 0.7646599571884927; 
terminals('54', '1') = 0.16075249207244413; terminals('54', '2') = 0.17641625552093243; terminals('54', '3') = 0.019062836351258605; terminals('54', '4') = 0.43179411231103526; terminals('54', '5') = 0.3272150509115187; 
terminals('55', '1') = 0.9978100735772605; terminals('55', '2') = 0.9330617472742735; terminals('55', '3') = 0.09671018816008592; terminals('55', '4') = 0.3006510065887412; terminals('55', '5') = 0.1531042418047024; 
terminals('56', '1') = 0.17429933804018571; terminals('56', '2') = 0.2316073299374296; terminals('56', '3') = 0.7030323779753567; terminals('56', '4') = 0.20229242169864792; terminals('56', '5') = 0.0759863743938658; 
terminals('57', '1') = 0.0902494814017033; terminals('57', '2') = 0.7473446249969777; terminals('57', '3') = 0.2556834740162146; terminals('57', '4') = 0.7755116977087085; terminals('57', '5') = 0.010519923481384308; 
terminals('58', '1') = 0.9472818394110871; terminals('58', '2') = 0.5052478412419256; terminals('58', '3') = 0.4032612184421466; terminals('58', '4') = 0.2344951293847769; terminals('58', '5') = 0.9673213296056999; 
terminals('59', '1') = 0.7760692309711317; terminals('59', '2') = 0.7149918214987452; terminals('59', '3') = 0.9549035945570581; terminals('59', '4') = 0.25689826401642535; terminals('59', '5') = 0.6794717363656977; 
terminals('60', '1') = 0.19541223592831225; terminals('60', '2') = 0.051548084464686394; terminals('60', '3') = 0.5690275925259536; terminals('60', '4') = 0.8083072710433955; terminals('60', '5') = 0.5040999876188177; 
terminals('61', '1') = 0.6643674479806778; terminals('61', '2') = 0.21831388319719502; terminals('61', '3') = 0.19713581028545268; terminals('61', '4') = 0.48411189280950895; terminals('61', '5') = 0.5831664976227845; 
terminals('62', '1') = 0.3024178295011044; terminals('62', '2') = 0.5729675478663309; terminals('62', '3') = 0.46546376813727386; terminals('62', '4') = 0.10160080553829376; terminals('62', '5') = 0.23614187884964044; 
terminals('63', '1') = 0.12412473516921907; terminals('63', '2') = 0.4498248158257302; terminals('63', '3') = 0.8492062841370265; terminals('63', '4') = 0.24432954313979716; terminals('63', '5') = 0.17729585199587816; 
terminals('64', '1') = 0.42110065965169297; terminals('64', '2') = 0.8424936424540698; terminals('64', '3') = 0.15231965270734105; terminals('64', '4') = 0.45410820539560537; terminals('64', '5') = 0.5448272074191527; 
terminals('65', '1') = 0.40954018660926816; terminals('65', '2') = 0.11548242555330546; terminals('65', '3') = 0.9821678835961776; terminals('65', '4') = 0.10590530593993375; terminals('65', '5') = 0.8744639376076658; 
Parameter bigM / 2.23606797749979 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
