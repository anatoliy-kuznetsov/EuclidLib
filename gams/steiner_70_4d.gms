Sets
i Steiner points / 1*68 /
j terminals / 1*70 /
k dimensions / 1*4 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.309585336204264; terminals('1', '2') = 0.6559568028801646; terminals('1', '3') = 0.897430256623686; terminals('1', '4') = 0.6254499995349947; 
terminals('2', '1') = 0.26125227996679334; terminals('2', '2') = 0.5488211761076858; terminals('2', '3') = 0.554802907690706; terminals('2', '4') = 0.7646168173732196; 
terminals('3', '1') = 0.4907320862411827; terminals('3', '2') = 0.6528013500962937; terminals('3', '3') = 0.9378388718189977; terminals('3', '4') = 0.6563112903087942; 
terminals('4', '1') = 0.7613460755422797; terminals('4', '2') = 0.46844884175370716; terminals('4', '3') = 0.6596878440413178; terminals('4', '4') = 0.8622002555826215; 
terminals('5', '1') = 0.8698193469636545; terminals('5', '2') = 0.6497160926402039; terminals('5', '3') = 0.47733262706280943; terminals('5', '4') = 0.34794112573588964; 
terminals('6', '1') = 0.27303772202999144; terminals('6', '2') = 0.2976764959656386; terminals('6', '3') = 0.5405181373602068; terminals('6', '4') = 0.021066686030276727; 
terminals('7', '1') = 0.5996066261849436; terminals('7', '2') = 0.09575178019746255; terminals('7', '3') = 0.8960723611966683; terminals('7', '4') = 0.6979424607881269; 
terminals('8', '1') = 0.14098994327788883; terminals('8', '2') = 0.41494494982924135; terminals('8', '3') = 0.8301803385328022; terminals('8', '4') = 0.9560455120916483; 
terminals('9', '1') = 0.7427388675418233; terminals('9', '2') = 0.2631657222774617; terminals('9', '3') = 0.5554989335808048; terminals('9', '4') = 0.6503831778691473; 
terminals('10', '1') = 0.49726501753625507; terminals('10', '2') = 0.09283720533108564; terminals('10', '3') = 0.36714690296308616; terminals('10', '4') = 0.5737119947418095; 
terminals('11', '1') = 0.8957522657474184; terminals('11', '2') = 0.946941485878492; terminals('11', '3') = 0.8391779265101351; terminals('11', '4') = 0.5694983825492437; 
terminals('12', '1') = 0.07145787184965258; terminals('12', '2') = 0.9285126688016422; terminals('12', '3') = 0.01895457153985214; terminals('12', '4') = 0.5021983038560599; 
terminals('13', '1') = 0.884975848687376; terminals('13', '2') = 0.1275017602962264; terminals('13', '3') = 0.906836463619693; terminals('13', '4') = 0.09093862622824123; 
terminals('14', '1') = 0.33014821238212766; terminals('14', '2') = 0.47368240383893845; terminals('14', '3') = 0.8315763460581179; terminals('14', '4') = 0.2231381631502639; 
terminals('15', '1') = 0.9189751742281116; terminals('15', '2') = 0.46837902533046305; terminals('15', '3') = 0.41010603591372286; terminals('15', '4') = 0.4871210071000981; 
terminals('16', '1') = 0.8927658207286648; terminals('16', '2') = 0.2548154022876088; terminals('16', '3') = 0.04057641666450107; terminals('16', '4') = 0.09706353460079753; 
terminals('17', '1') = 0.6850571459615541; terminals('17', '2') = 0.7912193261482209; terminals('17', '3') = 0.9031441123119814; terminals('17', '4') = 0.30864686152885223; 
terminals('18', '1') = 0.9667017750821806; terminals('18', '2') = 0.035306438074521274; terminals('18', '3') = 0.3492639608387639; terminals('18', '4') = 0.7694923647068049; 
terminals('19', '1') = 0.9807844817292964; terminals('19', '2') = 0.09266017436298524; terminals('19', '3') = 0.9055222761592584; terminals('19', '4') = 0.7395577744344303; 
terminals('20', '1') = 0.9057473399361591; terminals('20', '2') = 0.8685299079605237; terminals('20', '3') = 0.8026076813743994; terminals('20', '4') = 0.44508071881416356; 
terminals('21', '1') = 0.5841948780634606; terminals('21', '2') = 0.9975629373461473; terminals('21', '3') = 0.01728561758817382; terminals('21', '4') = 0.09466546696830302; 
terminals('22', '1') = 0.7782463734088121; terminals('22', '2') = 0.3754145662918401; terminals('22', '3') = 0.7587000868870564; terminals('22', '4') = 0.4739170154921719; 
terminals('23', '1') = 0.7530055402636782; terminals('23', '2') = 0.5549511213457796; terminals('23', '3') = 0.062358314605308274; terminals('23', '4') = 0.41754591718689427; 
terminals('24', '1') = 0.2689500667962895; terminals('24', '2') = 0.8228310314367754; terminals('24', '3') = 0.6854828749714397; terminals('24', '4') = 0.12075600252694108; 
terminals('25', '1') = 0.09113274601558186; terminals('25', '2') = 0.3407195743312045; terminals('25', '3') = 0.5779161046840267; terminals('25', '4') = 0.9242036292414769; 
terminals('26', '1') = 0.7669843761148926; terminals('26', '2') = 0.6237034803438172; terminals('26', '3') = 0.5893095830689409; terminals('26', '4') = 0.7625021237281595; 
terminals('27', '1') = 0.17983828457873496; terminals('27', '2') = 0.4890725889839983; terminals('27', '3') = 0.027023611957863847; terminals('27', '4') = 0.303256571376453; 
terminals('28', '1') = 0.17065404771034776; terminals('28', '2') = 0.6564579036512542; terminals('28', '3') = 0.4037829553965411; terminals('28', '4') = 0.8563241587249533; 
terminals('29', '1') = 0.38821613253884013; terminals('29', '2') = 0.5767834213259779; terminals('29', '3') = 0.6275942970130016; terminals('29', '4') = 0.6505332583610091; 
terminals('30', '1') = 0.31967377106469275; terminals('30', '2') = 0.34407555135963586; terminals('30', '3') = 0.9500244036211216; terminals('30', '4') = 0.48382217941594896; 
terminals('31', '1') = 0.758348555425525; terminals('31', '2') = 0.1562440174906491; terminals('31', '3') = 0.4462329303829059; terminals('31', '4') = 0.44818046109587273; 
terminals('32', '1') = 0.08624276916550955; terminals('32', '2') = 0.7564911386319724; terminals('32', '3') = 0.01903918959878259; terminals('32', '4') = 0.6174486802941157; 
terminals('33', '1') = 0.41846664546472223; terminals('33', '2') = 0.9909561088745502; terminals('33', '3') = 0.10017305321718928; terminals('33', '4') = 0.03982915969324763; 
terminals('34', '1') = 0.3508168065383003; terminals('34', '2') = 0.34798577445715373; terminals('34', '3') = 0.47019590150517865; terminals('34', '4') = 0.5206356720460923; 
terminals('35', '1') = 0.7203543557534988; terminals('35', '2') = 0.3080298197650585; terminals('35', '3') = 0.8012152979721382; terminals('35', '4') = 0.4676526862886303; 
terminals('36', '1') = 0.3125477803898853; terminals('36', '2') = 0.6536031213599063; terminals('36', '3') = 0.162621240372527; terminals('36', '4') = 0.9401438766748281; 
terminals('37', '1') = 0.17203907615835157; terminals('37', '2') = 0.6579271652685823; terminals('37', '3') = 0.30716564300834825; terminals('37', '4') = 0.5303075364523343; 
terminals('38', '1') = 0.9871756531995677; terminals('38', '2') = 0.05238399757650514; terminals('38', '3') = 0.2869453792652392; terminals('38', '4') = 0.5177895630930633; 
terminals('39', '1') = 0.6310124908045008; terminals('39', '2') = 0.14419727213087208; terminals('39', '3') = 0.4405986940014447; terminals('39', '4') = 0.06201600849542155; 
terminals('40', '1') = 0.6262075818851265; terminals('40', '2') = 0.5561486683186203; terminals('40', '3') = 0.031813281646940306; terminals('40', '4') = 0.5047402283648256; 
terminals('41', '1') = 0.5666355676188501; terminals('41', '2') = 0.5083928080864327; terminals('41', '3') = 0.1606219736804142; terminals('41', '4') = 0.6170002312929788; 
terminals('42', '1') = 0.9004143108553877; terminals('42', '2') = 0.6183395573205132; terminals('42', '3') = 0.00520790328313625; terminals('42', '4') = 0.41794739565551153; 
terminals('43', '1') = 0.5341394405740572; terminals('43', '2') = 0.37022944972530625; terminals('43', '3') = 0.9709497184493391; terminals('43', '4') = 0.46051844662891095; 
terminals('44', '1') = 0.7406103379528349; terminals('44', '2') = 0.06590833704228671; terminals('44', '3') = 0.86905823920679; terminals('44', '4') = 0.697848788607564; 
terminals('45', '1') = 0.41468183130972236; terminals('45', '2') = 0.5496499565081985; terminals('45', '3') = 0.4311208078429106; terminals('45', '4') = 0.6291229693542542; 
terminals('46', '1') = 0.9515932858533585; terminals('46', '2') = 0.47840155943245377; terminals('46', '3') = 0.4929971313764002; terminals('46', '4') = 0.8028945414140355; 
terminals('47', '1') = 0.8883127017048692; terminals('47', '2') = 0.6894265594952712; terminals('47', '3') = 0.49301619671815444; terminals('47', '4') = 0.5604915427782533; 
terminals('48', '1') = 0.3893982925856534; terminals('48', '2') = 0.895865984897686; terminals('48', '3') = 0.40012659060935063; terminals('48', '4') = 0.5147222059158785; 
terminals('49', '1') = 0.2609996168025658; terminals('49', '2') = 0.10166875400168351; terminals('49', '3') = 0.5845655500689907; terminals('49', '4') = 0.09992192304529235; 
terminals('50', '1') = 0.8167452982289396; terminals('50', '2') = 0.24540342468371223; terminals('50', '3') = 0.040720082244256495; terminals('50', '4') = 0.19579891361415647; 
terminals('51', '1') = 0.30455145717998633; terminals('51', '2') = 0.8851919753974229; terminals('51', '3') = 0.3961354094780357; terminals('51', '4') = 0.1557155045379358; 
terminals('52', '1') = 0.8541383451286211; terminals('52', '2') = 0.7144359620776205; terminals('52', '3') = 0.1926690821460435; terminals('52', '4') = 0.17827569919592445; 
terminals('53', '1') = 0.8058337609113922; terminals('53', '2') = 0.23833071914907722; terminals('53', '3') = 0.47642909423827395; terminals('53', '4') = 0.5320787101303485; 
terminals('54', '1') = 0.8655158953450971; terminals('54', '2') = 0.06023709193776827; terminals('54', '3') = 0.9032566229630502; terminals('54', '4') = 0.40752210800483024; 
terminals('55', '1') = 0.3006979777820856; terminals('55', '2') = 0.3345071879095972; terminals('55', '3') = 0.5755556803447905; terminals('55', '4') = 0.8074002468645594; 
terminals('56', '1') = 0.8903250990778439; terminals('56', '2') = 0.7654809475235503; terminals('56', '3') = 0.22586596444095508; terminals('56', '4') = 0.2520778572151755; 
terminals('57', '1') = 0.5926972825964948; terminals('57', '2') = 0.5998987244049554; terminals('57', '3') = 0.8673492801799404; terminals('57', '4') = 0.482257618005265; 
terminals('58', '1') = 0.870708623242557; terminals('58', '2') = 0.6582889391923875; terminals('58', '3') = 0.5089937648720957; terminals('58', '4') = 0.9589563908341479; 
terminals('59', '1') = 0.14136963181952023; terminals('59', '2') = 0.6337952958980664; terminals('59', '3') = 0.12618365637416928; terminals('59', '4') = 0.797292312780774; 
terminals('60', '1') = 0.8925475339938326; terminals('60', '2') = 0.29849572716252615; terminals('60', '3') = 0.6730759068806758; terminals('60', '4') = 0.579082158817671; 
terminals('61', '1') = 0.6709662462838306; terminals('61', '2') = 0.2026194963230301; terminals('61', '3') = 0.49819103384852115; terminals('61', '4') = 0.5304651681954345; 
terminals('62', '1') = 0.475244180077505; terminals('62', '2') = 0.6184441048115894; terminals('62', '3') = 0.021869524192483225; terminals('62', '4') = 0.5984664034977836; 
terminals('63', '1') = 0.014089095554873032; terminals('63', '2') = 0.45727863732315666; terminals('63', '3') = 0.20835469598605993; terminals('63', '4') = 0.13856478399591066; 
terminals('64', '1') = 0.6380526050280598; terminals('64', '2') = 0.6012549237765235; terminals('64', '3') = 0.9104878309858999; terminals('64', '4') = 0.3290318267615111; 
terminals('65', '1') = 0.14664889477502485; terminals('65', '2') = 0.057056241053211165; terminals('65', '3') = 0.5096655601375762; terminals('65', '4') = 0.47375583115551; 
terminals('66', '1') = 0.787980330775673; terminals('66', '2') = 0.39383155663655334; terminals('66', '3') = 0.4559468875463275; terminals('66', '4') = 0.9229212329692279; 
terminals('67', '1') = 0.897074643472738; terminals('67', '2') = 0.4643878290814064; terminals('67', '3') = 0.5583262511097696; terminals('67', '4') = 0.23213501800815317; 
terminals('68', '1') = 0.555247184595743; terminals('68', '2') = 0.0657558341651624; terminals('68', '3') = 0.6047292648391847; terminals('68', '4') = 0.6708347170161421; 
terminals('69', '1') = 0.2706201865693425; terminals('69', '2') = 0.196568389021901; terminals('69', '3') = 0.23575727367743182; terminals('69', '4') = 0.2730556623745609; 
terminals('70', '1') = 0.6116960255914187; terminals('70', '2') = 0.45564340122533675; terminals('70', '3') = 0.9160876253767034; terminals('70', '4') = 0.42583545962281244; 
Parameter bigM / 2.0 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
