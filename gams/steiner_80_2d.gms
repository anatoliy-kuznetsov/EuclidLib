Sets
i Steiner points / 1*78 /
j terminals / 1*80 /
k dimensions / 1*2 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.1225370131751905; terminals('1', '2') = 0.3431822314819327; 
terminals('2', '1') = 0.1744005450563948; terminals('2', '2') = 0.5878093566854947; 
terminals('3', '1') = 0.7110658130816083; terminals('3', '2') = 0.523343112265681; 
terminals('4', '1') = 0.538930430318931; terminals('4', '2') = 0.8193635509367223; 
terminals('5', '1') = 0.7412592428128284; terminals('5', '2') = 0.46919680397548036; 
terminals('6', '1') = 0.2805900262437331; terminals('6', '2') = 0.11755634345587584; 
terminals('7', '1') = 0.04739955237980864; terminals('7', '2') = 0.048362995928107555; 
terminals('8', '1') = 0.41955092495596547; terminals('8', '2') = 0.507819260426035; 
terminals('9', '1') = 0.4543345219575432; terminals('9', '2') = 0.8329329288141009; 
terminals('10', '1') = 0.8061599282736964; terminals('10', '2') = 0.9533943035061309; 
terminals('11', '1') = 0.9391174372082302; terminals('11', '2') = 0.6801037803371692; 
terminals('12', '1') = 0.020889250547212357; terminals('12', '2') = 0.6197205313321044; 
terminals('13', '1') = 0.9278246110905561; terminals('13', '2') = 0.1812298555375783; 
terminals('14', '1') = 0.7388659919296462; terminals('14', '2') = 0.6756658547068377; 
terminals('15', '1') = 0.07754522703045652; terminals('15', '2') = 0.14975183572355122; 
terminals('16', '1') = 0.4113155637578412; terminals('16', '2') = 0.3108619280733803; 
terminals('17', '1') = 0.688665136322587; terminals('17', '2') = 0.0033395915843595914; 
terminals('18', '1') = 0.5850702396535009; terminals('18', '2') = 0.36996426450408026; 
terminals('19', '1') = 0.9536145382053353; terminals('19', '2') = 0.5414343603588745; 
terminals('20', '1') = 0.7659876050454744; terminals('20', '2') = 0.7970208954169636; 
terminals('21', '1') = 0.5863004602028798; terminals('21', '2') = 0.21127851859013191; 
terminals('22', '1') = 0.049132844862181835; terminals('22', '2') = 0.6206104043780724; 
terminals('23', '1') = 0.5501386924682434; terminals('23', '2') = 0.18744297719105107; 
terminals('24', '1') = 0.5325315169289423; terminals('24', '2') = 0.5980944846299043; 
terminals('25', '1') = 0.12463960619666936; terminals('25', '2') = 0.6307469353812161; 
terminals('26', '1') = 0.11812836962503526; terminals('26', '2') = 0.027670187842037897; 
terminals('27', '1') = 0.944525990898681; terminals('27', '2') = 0.2931229642388332; 
terminals('28', '1') = 0.1345231467268061; terminals('28', '2') = 0.7757319798072462; 
terminals('29', '1') = 0.03622326632207762; terminals('29', '2') = 0.1739611698345317; 
terminals('30', '1') = 0.18265409187023907; terminals('30', '2') = 0.6640366239306693; 
terminals('31', '1') = 0.6347718050618287; terminals('31', '2') = 0.11238178364654072; 
terminals('32', '1') = 0.028221041112648892; terminals('32', '2') = 0.8248494779000388; 
terminals('33', '1') = 0.10164158738341444; terminals('33', '2') = 0.46197094533701777; 
terminals('34', '1') = 0.023250743107664285; terminals('34', '2') = 0.5554925942206745; 
terminals('35', '1') = 0.19053588443421787; terminals('35', '2') = 0.036169514570501105; 
terminals('36', '1') = 0.9443011074076291; terminals('36', '2') = 0.45715565222636356; 
terminals('37', '1') = 0.10125691342119625; terminals('37', '2') = 0.1873805949047711; 
terminals('38', '1') = 0.7047790489235244; terminals('38', '2') = 0.5748037367879156; 
terminals('39', '1') = 0.9648226115173314; terminals('39', '2') = 0.1568285100595902; 
terminals('40', '1') = 0.9566157893653934; terminals('40', '2') = 0.5125104517688318; 
terminals('41', '1') = 0.38939125644803485; terminals('41', '2') = 0.4361838201101853; 
terminals('42', '1') = 0.8603038287278969; terminals('42', '2') = 0.1446791729925896; 
terminals('43', '1') = 0.979449333950464; terminals('43', '2') = 0.7310683912064427; 
terminals('44', '1') = 0.70921665469605; terminals('44', '2') = 0.6396948344165118; 
terminals('45', '1') = 0.5427593188240922; terminals('45', '2') = 0.5108655110161928; 
terminals('46', '1') = 0.4724697204996646; terminals('46', '2') = 0.813509098439519; 
terminals('47', '1') = 0.3625157227229946; terminals('47', '2') = 0.8701362494994886; 
terminals('48', '1') = 0.726056503121134; terminals('48', '2') = 0.8583895467609348; 
terminals('49', '1') = 0.8381388788504163; terminals('49', '2') = 0.8175523342032778; 
terminals('50', '1') = 0.6413458977285103; terminals('50', '2') = 0.1778865273611645; 
terminals('51', '1') = 0.2731428313039702; terminals('51', '2') = 0.286100559724501; 
terminals('52', '1') = 0.4201944962040829; terminals('52', '2') = 0.18280152283621154; 
terminals('53', '1') = 0.36878035934561615; terminals('53', '2') = 0.02763856764377115; 
terminals('54', '1') = 0.5663862772754837; terminals('54', '2') = 0.8309960596013122; 
terminals('55', '1') = 0.1325850001710347; terminals('55', '2') = 0.1342814973510975; 
terminals('56', '1') = 0.5624087133778234; terminals('56', '2') = 0.998619271572656; 
terminals('57', '1') = 0.4000346186325089; terminals('57', '2') = 0.2596185445444459; 
terminals('58', '1') = 0.5383310872703015; terminals('58', '2') = 0.7529565289555947; 
terminals('59', '1') = 0.20197644092044387; terminals('59', '2') = 0.7976272738492551; 
terminals('60', '1') = 0.4768436701567512; terminals('60', '2') = 0.16268644637051666; 
terminals('61', '1') = 0.4359228451944871; terminals('61', '2') = 0.6452852815655182; 
terminals('62', '1') = 0.7460578112718211; terminals('62', '2') = 0.8699194258785496; 
terminals('63', '1') = 0.23582708274579156; terminals('63', '2') = 0.7617040844763541; 
terminals('64', '1') = 0.285015433287222; terminals('64', '2') = 0.41105111331871214; 
terminals('65', '1') = 0.7348860047459298; terminals('65', '2') = 0.8073842739734383; 
terminals('66', '1') = 0.7884500410162654; terminals('66', '2') = 0.3494969152695727; 
terminals('67', '1') = 0.11057111762612415; terminals('67', '2') = 0.6728527539524788; 
terminals('68', '1') = 0.20340670033494057; terminals('68', '2') = 0.1462593161481074; 
terminals('69', '1') = 0.34998480023040346; terminals('69', '2') = 0.3976232897075498; 
terminals('70', '1') = 0.29181092411573084; terminals('70', '2') = 0.25597368682581; 
terminals('71', '1') = 0.44084453624373565; terminals('71', '2') = 0.014307571783667372; 
terminals('72', '1') = 0.38140377163152006; terminals('72', '2') = 0.6747106150903116; 
terminals('73', '1') = 0.6367026008612071; terminals('73', '2') = 0.8740266204151044; 
terminals('74', '1') = 0.44032511145304876; terminals('74', '2') = 0.11977640848449622; 
terminals('75', '1') = 0.7880618435309391; terminals('75', '2') = 0.8949996503767634; 
terminals('76', '1') = 0.544770981903088; terminals('76', '2') = 0.09788964863745342; 
terminals('77', '1') = 0.053694242454106256; terminals('77', '2') = 0.9633902653313823; 
terminals('78', '1') = 0.40100072549982513; terminals('78', '2') = 0.21044023665041223; 
terminals('79', '1') = 0.868046243057454; terminals('79', '2') = 0.9800913407062133; 
terminals('80', '1') = 0.5941958942531421; terminals('80', '2') = 0.34635785537878805; 
Parameter bigM / 1.4142135623730951 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
