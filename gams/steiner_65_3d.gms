Sets
i Steiner points / 1*63 /
j terminals / 1*65 /
k dimensions / 1*3 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.5955187335288273; terminals('1', '2') = 0.04214217250850749; terminals('1', '3') = 0.19934882896870632; 
terminals('2', '1') = 0.6741916377032944; terminals('2', '2') = 0.8614444152149541; terminals('2', '3') = 0.39748910128928316; 
terminals('3', '1') = 0.6414622686907453; terminals('3', '2') = 0.7116503459403931; terminals('3', '3') = 0.6177722528452448; 
terminals('4', '1') = 0.7195322313795081; terminals('4', '2') = 0.8564210410486216; terminals('4', '3') = 0.23615517514724083; 
terminals('5', '1') = 0.549097072428497; terminals('5', '2') = 0.930326941839256; terminals('5', '3') = 0.7781915791541077; 
terminals('6', '1') = 0.1469499966367832; terminals('6', '2') = 0.9101895921228239; terminals('6', '3') = 0.23592716965285154; 
terminals('7', '1') = 0.09574696484088774; terminals('7', '2') = 0.9133520343655491; terminals('7', '3') = 0.5231040711806283; 
terminals('8', '1') = 0.936409881883211; terminals('8', '2') = 0.8058275659201926; terminals('8', '3') = 0.9021247833839653; 
terminals('9', '1') = 0.05422140766039896; terminals('9', '2') = 0.6476265753879484; terminals('9', '3') = 0.6936001827001091; 
terminals('10', '1') = 0.852671564793064; terminals('10', '2') = 0.13580564646723892; terminals('10', '3') = 0.5252452121427983; 
terminals('11', '1') = 0.4098306861621368; terminals('11', '2') = 0.6818274431478812; terminals('11', '3') = 0.6279759936726517; 
terminals('12', '1') = 0.35746723577983963; terminals('12', '2') = 0.8623153016650696; terminals('12', '3') = 0.6253583854396213; 
terminals('13', '1') = 0.41799403145707215; terminals('13', '2') = 0.6178807511997579; terminals('13', '3') = 0.5820145346771238; 
terminals('14', '1') = 0.949942570171405; terminals('14', '2') = 0.838224680682583; terminals('14', '3') = 0.20208697977649193; 
terminals('15', '1') = 0.9836337032426699; terminals('15', '2') = 0.7831394274325086; terminals('15', '3') = 0.03273121388753719; 
terminals('16', '1') = 0.6481367104539595; terminals('16', '2') = 0.2975396786031075; terminals('16', '3') = 0.4454360548267142; 
terminals('17', '1') = 0.25077535959950314; terminals('17', '2') = 0.7790164013668143; terminals('17', '3') = 0.9227994874808276; 
terminals('18', '1') = 0.6522743401902791; terminals('18', '2') = 0.0408980751073712; terminals('18', '3') = 0.05414711544188011; 
terminals('19', '1') = 0.16020137016135827; terminals('19', '2') = 0.5673052229663491; terminals('19', '3') = 0.014222121281974975; 
terminals('20', '1') = 0.9715302949694318; terminals('20', '2') = 0.08136749650112529; terminals('20', '3') = 0.6592139480191349; 
terminals('21', '1') = 0.2586576295359887; terminals('21', '2') = 0.3205017138923957; terminals('21', '3') = 0.5590751795192453; 
terminals('22', '1') = 0.48032024334999535; terminals('22', '2') = 0.7738131879266422; terminals('22', '3') = 0.6091965753030971; 
terminals('23', '1') = 0.661960266837919; terminals('23', '2') = 0.6518261870105713; terminals('23', '3') = 0.9024631020299809; 
terminals('24', '1') = 0.48670229173369484; terminals('24', '2') = 0.5337454893861661; terminals('24', '3') = 0.2284074732511876; 
terminals('25', '1') = 0.384014792759769; terminals('25', '2') = 0.9977321829341386; terminals('25', '3') = 0.382433998233514; 
terminals('26', '1') = 0.12772145026535175; terminals('26', '2') = 0.7706867181934796; terminals('26', '3') = 0.8740447408509693; 
terminals('27', '1') = 0.3414535116701439; terminals('27', '2') = 0.2451257563162207; terminals('27', '3') = 0.5949846309115094; 
terminals('28', '1') = 0.44582558635664016; terminals('28', '2') = 0.6299476315088052; terminals('28', '3') = 0.29038200422875815; 
terminals('29', '1') = 0.2510087433627427; terminals('29', '2') = 0.2414996353420602; terminals('29', '3') = 0.18327773236427325; 
terminals('30', '1') = 0.6474292592394659; terminals('30', '2') = 0.40775899526834547; terminals('30', '3') = 0.685581734508995; 
terminals('31', '1') = 0.21937172583322184; terminals('31', '2') = 0.4948425469448635; terminals('31', '3') = 0.7816456660206236; 
terminals('32', '1') = 0.2326254494780402; terminals('32', '2') = 0.28046320427052907; terminals('32', '3') = 0.7403961465097102; 
terminals('33', '1') = 0.8821804352586623; terminals('33', '2') = 0.015274846268506947; terminals('33', '3') = 0.6190382422173415; 
terminals('34', '1') = 0.9904447532515437; terminals('34', '2') = 0.5845319824936566; terminals('34', '3') = 0.9999018109364902; 
terminals('35', '1') = 0.27049124446288175; terminals('35', '2') = 0.8956928253546994; terminals('35', '3') = 0.19078616048706087; 
terminals('36', '1') = 0.9296792096306532; terminals('36', '2') = 0.1527584436108782; terminals('36', '3') = 0.725980538818129; 
terminals('37', '1') = 0.3430261621498333; terminals('37', '2') = 0.15076514458428902; terminals('37', '3') = 0.8295017282893182; 
terminals('38', '1') = 0.4677997833971651; terminals('38', '2') = 0.32198086316984353; terminals('38', '3') = 0.05886277002646989; 
terminals('39', '1') = 0.27656067313602795; terminals('39', '2') = 0.9560831677864835; terminals('39', '3') = 0.8874584908334625; 
terminals('40', '1') = 0.011534172075816085; terminals('40', '2') = 0.046373417469135036; terminals('40', '3') = 0.4495630464754672; 
terminals('41', '1') = 0.3298108415506059; terminals('41', '2') = 0.9327026262228699; terminals('41', '3') = 0.10268845687781447; 
terminals('42', '1') = 0.5937104181233477; terminals('42', '2') = 0.8236129774225774; terminals('42', '3') = 0.7488475133323383; 
terminals('43', '1') = 0.21580763858521812; terminals('43', '2') = 0.41077462951244237; terminals('43', '3') = 0.06391399026447442; 
terminals('44', '1') = 0.05453475046595502; terminals('44', '2') = 0.08099401551394703; terminals('44', '3') = 0.6913904840821178; 
terminals('45', '1') = 0.825637502509944; terminals('45', '2') = 0.26198970775191865; terminals('45', '3') = 0.44045418627237787; 
terminals('46', '1') = 0.33081823487193507; terminals('46', '2') = 0.5743457849091868; terminals('46', '3') = 0.3853865872544142; 
terminals('47', '1') = 0.6027296133173018; terminals('47', '2') = 0.994824046518161; terminals('47', '3') = 0.4617520537464702; 
terminals('48', '1') = 0.32005806109228585; terminals('48', '2') = 0.13591688420239123; terminals('48', '3') = 0.1889224567328761; 
terminals('49', '1') = 0.06738958237108095; terminals('49', '2') = 0.7651057911075094; terminals('49', '3') = 0.7076596213452571; 
terminals('50', '1') = 0.45141559022240096; terminals('50', '2') = 0.3545976331875811; terminals('50', '3') = 0.7895948787117393; 
terminals('51', '1') = 0.041038827189281535; terminals('51', '2') = 0.33164204900346006; terminals('51', '3') = 0.9337824634941757; 
terminals('52', '1') = 0.7170556785953432; terminals('52', '2') = 0.4516807360133843; terminals('52', '3') = 0.2746433691190523; 
terminals('53', '1') = 0.18406225343364613; terminals('53', '2') = 0.2346566246240992; terminals('53', '3') = 0.27896608465218475; 
terminals('54', '1') = 0.8913800485774772; terminals('54', '2') = 0.08031479492505966; terminals('54', '3') = 0.6497771279392072; 
terminals('55', '1') = 0.1471438227630264; terminals('55', '2') = 0.14831764160976013; terminals('55', '3') = 0.20009122388280376; 
terminals('56', '1') = 0.6246697371782607; terminals('56', '2') = 0.7988157604894299; terminals('56', '3') = 0.6116580425171891; 
terminals('57', '1') = 0.5339494320321749; terminals('57', '2') = 0.39040122051502524; terminals('57', '3') = 0.7034937239206868; 
terminals('58', '1') = 0.2772953303955046; terminals('58', '2') = 0.38943996171507556; terminals('58', '3') = 0.9660796923081585; 
terminals('59', '1') = 0.11301988685913511; terminals('59', '2') = 0.6464387212582969; terminals('59', '3') = 0.5789731941056593; 
terminals('60', '1') = 0.352219108585364; terminals('60', '2') = 0.7129282766021229; terminals('60', '3') = 0.5193380966088273; 
terminals('61', '1') = 0.8135981397509259; terminals('61', '2') = 0.2229194502461076; terminals('61', '3') = 0.5770009421048092; 
terminals('62', '1') = 0.0006929144748457627; terminals('62', '2') = 0.75940901896689; terminals('62', '3') = 0.7486758177183873; 
terminals('63', '1') = 0.7934294155694622; terminals('63', '2') = 0.8126560303124648; terminals('63', '3') = 0.780171743276721; 
terminals('64', '1') = 0.789934116695195; terminals('64', '2') = 0.9941179576181429; terminals('64', '3') = 0.32576980640441133; 
terminals('65', '1') = 0.9582319165097436; terminals('65', '2') = 0.8607979504813402; terminals('65', '3') = 0.3745203412591619; 
Parameter bigM / 1.7320508075688772 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
