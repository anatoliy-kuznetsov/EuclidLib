Sets
i Steiner points / 1*83 /
j terminals / 1*85 /
k dimensions / 1*5 /;
Alias(i,ii);
Parameters terminals(j,k);
terminals('1', '1') = 0.4190157956595312; terminals('1', '2') = 0.1718489031939716; terminals('1', '3') = 0.058022228000917275; terminals('1', '4') = 0.7385423895153291; terminals('1', '5') = 0.7340410262669369; 
terminals('2', '1') = 0.5515613125532609; terminals('2', '2') = 0.6035553874081164; terminals('2', '3') = 0.7442603170006825; terminals('2', '4') = 0.22640991659118959; terminals('2', '5') = 0.671923997734794; 
terminals('3', '1') = 0.4206921074371567; terminals('3', '2') = 0.5374495577775669; terminals('3', '3') = 0.05080628324152314; terminals('3', '4') = 0.195135178958749; terminals('3', '5') = 0.5164868739031669; 
terminals('4', '1') = 0.7203437721342749; terminals('4', '2') = 0.10064040513728056; terminals('4', '3') = 0.8053297832104013; terminals('4', '4') = 0.0469315322900955; terminals('4', '5') = 0.06006626570088214; 
terminals('5', '1') = 0.6636537492769075; terminals('5', '2') = 0.48561914405524365; terminals('5', '3') = 0.7555267385604421; terminals('5', '4') = 0.32583846497449387; terminals('5', '5') = 0.18632636724585516; 
terminals('6', '1') = 0.3785832029910756; terminals('6', '2') = 0.4031358815370478; terminals('6', '3') = 0.4929488958647875; terminals('6', '4') = 0.814713972897826; terminals('6', '5') = 0.20220748092467566; 
terminals('7', '1') = 0.5362036133445385; terminals('7', '2') = 0.7796489670064325; terminals('7', '3') = 0.061750876366931884; terminals('7', '4') = 0.2180822812160158; terminals('7', '5') = 0.8434320904232682; 
terminals('8', '1') = 0.6801519589381525; terminals('8', '2') = 0.3077528825933574; terminals('8', '3') = 0.3852490811011725; terminals('8', '4') = 0.7884980734619497; terminals('8', '5') = 0.6279391269081324; 
terminals('9', '1') = 0.37203613100832844; terminals('9', '2') = 0.7567440010954314; terminals('9', '3') = 0.06530169738380165; terminals('9', '4') = 0.8219970708025391; terminals('9', '5') = 0.1693011506764538; 
terminals('10', '1') = 0.2061662063738151; terminals('10', '2') = 0.8200719864725884; terminals('10', '3') = 0.6314859187205878; terminals('10', '4') = 0.6933446782314016; terminals('10', '5') = 0.8412507465151304; 
terminals('11', '1') = 0.22780041925469652; terminals('11', '2') = 0.017376074433511857; terminals('11', '3') = 0.35329121640451333; terminals('11', '4') = 0.2520411648400346; terminals('11', '5') = 0.7903106935523716; 
terminals('12', '1') = 0.9071313879886166; terminals('12', '2') = 0.48532133204312844; terminals('12', '3') = 0.11831081796274978; terminals('12', '4') = 0.41052703813098557; terminals('12', '5') = 0.3336636750843073; 
terminals('13', '1') = 0.7260898787123; terminals('13', '2') = 0.18296852847839773; terminals('13', '3') = 0.007778836473929851; terminals('13', '4') = 0.12183365609576435; terminals('13', '5') = 0.6914605408655301; 
terminals('14', '1') = 0.8807771105188503; terminals('14', '2') = 0.900821790854426; terminals('14', '3') = 0.5438780737751584; terminals('14', '4') = 0.11988497079227944; terminals('14', '5') = 0.21549253037841498; 
terminals('15', '1') = 0.5735344015191036; terminals('15', '2') = 0.6574218021854884; terminals('15', '3') = 0.8158062613134707; terminals('15', '4') = 0.6201684817706599; terminals('15', '5') = 0.4074446814675693; 
terminals('16', '1') = 0.8643754007054048; terminals('16', '2') = 0.7357468575105703; terminals('16', '3') = 0.8156544534291797; terminals('16', '4') = 0.7169125606314823; terminals('16', '5') = 0.9715279570651791; 
terminals('17', '1') = 0.2369653587179924; terminals('17', '2') = 0.7213176557664709; terminals('17', '3') = 0.8454647739519161; terminals('17', '4') = 0.20162916374815598; terminals('17', '5') = 0.31519544122744636; 
terminals('18', '1') = 0.06987898498089673; terminals('18', '2') = 0.8078058442745841; terminals('18', '3') = 0.08834738296221079; terminals('18', '4') = 0.6135468253165192; terminals('18', '5') = 0.25441816064333656; 
terminals('19', '1') = 0.9405503274162899; terminals('19', '2') = 0.6647547012744172; terminals('19', '3') = 0.8032084112420073; terminals('19', '4') = 0.8768655004288886; terminals('19', '5') = 0.6408262507396963; 
terminals('20', '1') = 0.37285971036886456; terminals('20', '2') = 0.5647921830927136; terminals('20', '3') = 0.31126586438300785; terminals('20', '4') = 0.5622054316797453; terminals('20', '5') = 0.12579926225036808; 
terminals('21', '1') = 0.4160891146658485; terminals('21', '2') = 0.5408204546106552; terminals('21', '3') = 0.9846149858967005; terminals('21', '4') = 0.11215756147790168; terminals('21', '5') = 0.39546357824925626; 
terminals('22', '1') = 0.9685002054011946; terminals('22', '2') = 0.6434460637720145; terminals('22', '3') = 0.33802916856073817; terminals('22', '4') = 0.4738802843906651; terminals('22', '5') = 0.07155720549097144; 
terminals('23', '1') = 0.40602422049520237; terminals('23', '2') = 0.3837881799010109; terminals('23', '3') = 0.8953156406447389; terminals('23', '4') = 0.0073810135647928155; terminals('23', '5') = 0.27452086342581994; 
terminals('24', '1') = 0.2262954299896559; terminals('24', '2') = 0.02754494514524486; terminals('24', '3') = 0.2993845828812569; terminals('24', '4') = 0.31963296644409367; terminals('24', '5') = 0.0959468672471111; 
terminals('25', '1') = 0.46388241021822163; terminals('25', '2') = 0.9330360490242814; terminals('25', '3') = 0.20852774797643725; terminals('25', '4') = 0.2634126817391623; terminals('25', '5') = 0.5207932697978943; 
terminals('26', '1') = 0.9848052846662204; terminals('26', '2') = 0.5717262678047303; terminals('26', '3') = 0.11415875323234403; terminals('26', '4') = 0.8151761025244533; terminals('26', '5') = 0.9177701312168479; 
terminals('27', '1') = 0.07788408288869286; terminals('27', '2') = 0.9852408904074523; terminals('27', '3') = 0.8609385804789512; terminals('27', '4') = 0.7740669827899296; terminals('27', '5') = 0.13443514130845202; 
terminals('28', '1') = 0.7386791830577832; terminals('28', '2') = 0.6467703528975806; terminals('28', '3') = 0.6183541041130965; terminals('28', '4') = 0.26451503790910214; terminals('28', '5') = 0.26528296289907427; 
terminals('29', '1') = 0.6135402195720647; terminals('29', '2') = 0.004185088412470783; terminals('29', '3') = 0.04552896972849929; terminals('29', '4') = 0.8159939839725129; terminals('29', '5') = 0.5023838945966417; 
terminals('30', '1') = 0.20423047403305494; terminals('30', '2') = 0.801910173316541; terminals('30', '3') = 0.48250705617071443; terminals('30', '4') = 0.9505174074993341; terminals('30', '5') = 0.9285670911612387; 
terminals('31', '1') = 0.5291808502403588; terminals('31', '2') = 0.6593574211215595; terminals('31', '3') = 0.13245047300324264; terminals('31', '4') = 0.7398786993285185; terminals('31', '5') = 0.4159580636868526; 
terminals('32', '1') = 0.287627451118177; terminals('32', '2') = 0.956112579229782; terminals('32', '3') = 0.741980857443376; terminals('32', '4') = 0.04233137501567463; terminals('32', '5') = 0.2655744222224562; 
terminals('33', '1') = 0.6120876948746767; terminals('33', '2') = 0.7473701528091393; terminals('33', '3') = 0.8309649621301516; terminals('33', '4') = 0.01998326651018556; terminals('33', '5') = 0.24265649369952647; 
terminals('34', '1') = 0.7879074585634145; terminals('34', '2') = 0.624850423308356; terminals('34', '3') = 0.7876645788928787; terminals('34', '4') = 0.008800452520959623; terminals('34', '5') = 0.0403466025230087; 
terminals('35', '1') = 0.48227765941611; terminals('35', '2') = 0.6136442542112793; terminals('35', '3') = 0.0675870873833353; terminals('35', '4') = 0.04196169734502675; terminals('35', '5') = 0.9340119551036555; 
terminals('36', '1') = 0.8856888628353679; terminals('36', '2') = 0.39959035535864196; terminals('36', '3') = 0.007064562592830059; terminals('36', '4') = 0.3078847156566731; terminals('36', '5') = 0.0351324987247279; 
terminals('37', '1') = 0.9085777877099352; terminals('37', '2') = 0.9073739024684874; terminals('37', '3') = 0.8070233246516604; terminals('37', '4') = 0.9630615826384421; terminals('37', '5') = 0.5475405108040889; 
terminals('38', '1') = 0.5507194584110676; terminals('38', '2') = 0.6306521946756252; terminals('38', '3') = 0.9073781552575754; terminals('38', '4') = 0.8429331658476075; terminals('38', '5') = 0.2785099185822899; 
terminals('39', '1') = 0.9879866276316825; terminals('39', '2') = 0.7808353337146974; terminals('39', '3') = 0.019951791132516772; terminals('39', '4') = 0.10358239917711443; terminals('39', '5') = 0.23572413532160985; 
terminals('40', '1') = 0.1595974233081231; terminals('40', '2') = 0.21964864845945742; terminals('40', '3') = 0.3911538178620626; terminals('40', '4') = 0.3730636998477018; terminals('40', '5') = 0.9058965575498931; 
terminals('41', '1') = 0.4837684735593747; terminals('41', '2') = 0.58170696993365; terminals('41', '3') = 0.06847013669639646; terminals('41', '4') = 0.7080517692605107; terminals('41', '5') = 0.6953792788419144; 
terminals('42', '1') = 0.765928743892813; terminals('42', '2') = 0.54273867917333; terminals('42', '3') = 0.9944799132063736; terminals('42', '4') = 0.8287136316239309; terminals('42', '5') = 0.13706158327360773; 
terminals('43', '1') = 0.9395255247618286; terminals('43', '2') = 0.5676710736966133; terminals('43', '3') = 0.4845933586176847; terminals('43', '4') = 0.06438789084618446; terminals('43', '5') = 0.2616418996642451; 
terminals('44', '1') = 0.5808587311680817; terminals('44', '2') = 0.25906467016662416; terminals('44', '3') = 0.8528255446864262; terminals('44', '4') = 0.26924349899470446; terminals('44', '5') = 0.8425729101477997; 
terminals('45', '1') = 0.17467567516207672; terminals('45', '2') = 0.9768755193087894; terminals('45', '3') = 0.8807401433198555; terminals('45', '4') = 0.30435029263254154; terminals('45', '5') = 0.7694648035755753; 
terminals('46', '1') = 0.1761356579485973; terminals('46', '2') = 0.5863229527925099; terminals('46', '3') = 0.006458696354462612; terminals('46', '4') = 0.1448459576185912; terminals('46', '5') = 0.6222998348324789; 
terminals('47', '1') = 0.0316883454899769; terminals('47', '2') = 0.9426416351482111; terminals('47', '3') = 0.0077437065656355; terminals('47', '4') = 0.8319101311886371; terminals('47', '5') = 0.8997599017902326; 
terminals('48', '1') = 0.12557849469985982; terminals('48', '2') = 0.3794917695715988; terminals('48', '3') = 0.8255442738391359; terminals('48', '4') = 0.19148335089083723; terminals('48', '5') = 0.08864532041633244; 
terminals('49', '1') = 0.8540391584827057; terminals('49', '2') = 0.3080408191676819; terminals('49', '3') = 0.24417080872632235; terminals('49', '4') = 0.2601229235977509; terminals('49', '5') = 0.09146286993398955; 
terminals('50', '1') = 0.46319542076779374; terminals('50', '2') = 0.5189160337900424; terminals('50', '3') = 0.24900461148775865; terminals('50', '4') = 0.4943864544707438; terminals('50', '5') = 0.04537766775971108; 
terminals('51', '1') = 0.7047497894986758; terminals('51', '2') = 0.005610668585786516; terminals('51', '3') = 0.6619461816418215; terminals('51', '4') = 0.32146162793158417; terminals('51', '5') = 0.4308239803123963; 
terminals('52', '1') = 0.522505107267512; terminals('52', '2') = 0.5455017961627135; terminals('52', '3') = 0.5303654309097084; terminals('52', '4') = 0.7765501897846769; terminals('52', '5') = 0.27319688511253093; 
terminals('53', '1') = 0.9978782834169325; terminals('53', '2') = 0.8875678655003042; terminals('53', '3') = 0.7923702753594297; terminals('53', '4') = 0.68491914551972; terminals('53', '5') = 0.5123935988525751; 
terminals('54', '1') = 0.40683911304807485; terminals('54', '2') = 0.5034317906348638; terminals('54', '3') = 0.7017409214833169; terminals('54', '4') = 0.13501534511736923; terminals('54', '5') = 0.7414519025762898; 
terminals('55', '1') = 0.7125246051279914; terminals('55', '2') = 0.3939587540123859; terminals('55', '3') = 0.06448138230701983; terminals('55', '4') = 0.44091322155656165; terminals('55', '5') = 0.32807845581302997; 
terminals('56', '1') = 0.3036973822240886; terminals('56', '2') = 0.16051615699942634; terminals('56', '3') = 0.793766804796804; terminals('56', '4') = 0.3233018874974287; terminals('56', '5') = 0.581996072091485; 
terminals('57', '1') = 0.9095700622255947; terminals('57', '2') = 0.2733683376347227; terminals('57', '3') = 0.029922310855191037; terminals('57', '4') = 0.4916949125484651; terminals('57', '5') = 0.473911233753037; 
terminals('58', '1') = 0.9646491606490966; terminals('58', '2') = 0.7777079910235827; terminals('58', '3') = 0.943644989800378; terminals('58', '4') = 0.6908333028854863; terminals('58', '5') = 0.6539773495832941; 
terminals('59', '1') = 0.7815740163791594; terminals('59', '2') = 0.8268944145423953; terminals('59', '3') = 0.280041626200785; terminals('59', '4') = 0.4983256093546431; terminals('59', '5') = 0.4215635555892483; 
terminals('60', '1') = 0.3318728817145502; terminals('60', '2') = 0.6074604421659819; terminals('60', '3') = 0.8621143567005922; terminals('60', '4') = 0.746315620825971; terminals('60', '5') = 0.7403193968196243; 
terminals('61', '1') = 0.1334265441485487; terminals('61', '2') = 0.7431710615849648; terminals('61', '3') = 0.6248874184297508; terminals('61', '4') = 0.7114291430936578; terminals('61', '5') = 0.712166385032141; 
terminals('62', '1') = 0.06953698904475025; terminals('62', '2') = 0.8064199665569534; terminals('62', '3') = 0.09036549573979669; terminals('62', '4') = 0.4821400427825905; terminals('62', '5') = 0.20581395925987012; 
terminals('63', '1') = 0.31079125161041277; terminals('63', '2') = 0.9211839477244051; terminals('63', '3') = 0.899127722468627; terminals('63', '4') = 0.6430695079609365; terminals('63', '5') = 0.4635241512994468; 
terminals('64', '1') = 0.06490939904125159; terminals('64', '2') = 0.10905153882864826; terminals('64', '3') = 0.42318364051178736; terminals('64', '4') = 0.4239312500226814; terminals('64', '5') = 0.046401131527798234; 
terminals('65', '1') = 0.4888660642475333; terminals('65', '2') = 0.4247650882394304; terminals('65', '3') = 0.5274096458043468; terminals('65', '4') = 0.24799727519741788; terminals('65', '5') = 0.4192105376564069; 
terminals('66', '1') = 0.7622594556585989; terminals('66', '2') = 0.9133473889397462; terminals('66', '3') = 0.6809095510628248; terminals('66', '4') = 0.350393258083487; terminals('66', '5') = 0.9285960692139603; 
terminals('67', '1') = 0.9399943473354019; terminals('67', '2') = 0.48306219106206194; terminals('67', '3') = 0.23201895470028344; terminals('67', '4') = 0.7483138778279899; terminals('67', '5') = 0.4665713449164419; 
terminals('68', '1') = 0.7900213787502806; terminals('68', '2') = 0.5026668980553584; terminals('68', '3') = 0.33278093182397483; terminals('68', '4') = 0.4493257719814938; terminals('68', '5') = 0.9367470667276875; 
terminals('69', '1') = 0.34391246489773053; terminals('69', '2') = 0.6193430256288966; terminals('69', '3') = 0.9157604114700908; terminals('69', '4') = 0.5715909080207553; terminals('69', '5') = 0.2588427438358637; 
terminals('70', '1') = 0.6320917845340858; terminals('70', '2') = 0.5334103225859164; terminals('70', '3') = 0.902670336402783; terminals('70', '4') = 0.9293081728502159; terminals('70', '5') = 0.6827632217191522; 
terminals('71', '1') = 0.19464252448328834; terminals('71', '2') = 0.29804732568692405; terminals('71', '3') = 0.9405275406570802; terminals('71', '4') = 0.35736783386895365; terminals('71', '5') = 0.9365715069810698; 
terminals('72', '1') = 0.2331403750357559; terminals('72', '2') = 0.28355593532179646; terminals('72', '3') = 0.18898392297567568; terminals('72', '4') = 0.2528200136261023; terminals('72', '5') = 0.7400048162004932; 
terminals('73', '1') = 0.3510932731413793; terminals('73', '2') = 0.8595666945099378; terminals('73', '3') = 0.6368932449699065; terminals('73', '4') = 0.8886729957122994; terminals('73', '5') = 0.1950512876169126; 
terminals('74', '1') = 0.7326069253190469; terminals('74', '2') = 0.00987932543522585; terminals('74', '3') = 0.6425625351600709; terminals('74', '4') = 0.08701619195012178; terminals('74', '5') = 0.6465882359879283; 
terminals('75', '1') = 0.3150731456238991; terminals('75', '2') = 0.7136457201143799; terminals('75', '3') = 0.6990141262307518; terminals('75', '4') = 0.9183520419742706; terminals('75', '5') = 0.3853691982123566; 
terminals('76', '1') = 0.7325679097948299; terminals('76', '2') = 0.8616026413277471; terminals('76', '3') = 0.8707074903912744; terminals('76', '4') = 0.4973418842875844; terminals('76', '5') = 0.6724604064364669; 
terminals('77', '1') = 0.8198010346249375; terminals('77', '2') = 0.4228673783620974; terminals('77', '3') = 0.4681070665577912; terminals('77', '4') = 0.9748731549195809; terminals('77', '5') = 0.9324126112009495; 
terminals('78', '1') = 0.024968184826269835; terminals('78', '2') = 0.08017523027740625; terminals('78', '3') = 0.31597224571371874; terminals('78', '4') = 0.3220781994785217; terminals('78', '5') = 0.38878120583477305; 
terminals('79', '1') = 0.00854967390213146; terminals('79', '2') = 0.07473038251769237; terminals('79', '3') = 0.38696585833288466; terminals('79', '4') = 0.20555339087685753; terminals('79', '5') = 0.4406733669285954; 
terminals('80', '1') = 0.5704965617534168; terminals('80', '2') = 0.13941675842131862; terminals('80', '3') = 0.27849624104530923; terminals('80', '4') = 0.48313162998954085; terminals('80', '5') = 0.9448468444147032; 
terminals('81', '1') = 0.7107853485064538; terminals('81', '2') = 0.6760621848764502; terminals('81', '3') = 0.176128743923742; terminals('81', '4') = 0.4063064802930578; terminals('81', '5') = 0.32042497535882797; 
terminals('82', '1') = 0.6631446274373215; terminals('82', '2') = 0.6356385037799681; terminals('82', '3') = 0.6809844983648333; terminals('82', '4') = 0.17591527029329568; terminals('82', '5') = 0.10951975891773524; 
terminals('83', '1') = 0.29885209330402374; terminals('83', '2') = 0.024798899303872357; terminals('83', '3') = 0.768882953078484; terminals('83', '4') = 0.1548758444494761; terminals('83', '5') = 0.11467155219638114; 
terminals('84', '1') = 0.9444287100643658; terminals('84', '2') = 0.4975323397333328; terminals('84', '3') = 0.9042131651443438; terminals('84', '4') = 0.5600270868856142; terminals('84', '5') = 0.9306881529540689; 
terminals('85', '1') = 0.4735883602326161; terminals('85', '2') = 0.17446980185051053; terminals('85', '3') = 0.9270591686840005; terminals('85', '4') = 0.049792165094170615; terminals('85', '5') = 0.47371591539244906; 
Parameter bigM / 2.23606797749979 /;
Positive Variables distance_Steiner_Steiner(i,ii), distance_Steiner_terminal(i,j), Steiner_points(i,k);
Steiner_points.up(i,k) = 1; distance_Steiner_Steiner.up(i,ii) = bigM; distance_Steiner_terminal.up(i,j) = bigM;
Binary Variables is_connected_Steiner_Steiner(i,ii), is_connected_Steiner_terminal(i,j);
Variable objective;
Equations objective_definition, distance_Steiner_Steiner_def(i,ii), distance_Steiner_terminal_def(i,j), assignment(j), cardinality(i), Steiner_connectivity(i);
objective_definition.. objective =e= sum(i, sum(ii$(ord(i)<ord(ii)), distance_Steiner_Steiner(i,ii)) + sum(j, distance_Steiner_terminal(i,j)));
distance_Steiner_Steiner_def(i,ii)$(ord(i)<ord(ii)).. distance_Steiner_Steiner(i,ii) =g= sqrt(sum(k, power(Steiner_points(i,k) - Steiner_points(ii,k), 2))) - bigM * (1 - is_connected_Steiner_Steiner(i,ii));
distance_Steiner_terminal_def(i,j).. distance_Steiner_terminal(i,j) =g= sqrt(sum(k, power(Steiner_points(i,k) - terminals(j,k), 2))) - bigM * (1 - is_connected_Steiner_terminal(i,j));
assignment(j).. sum(i, is_connected_Steiner_terminal(i,j)) =e= 1;
cardinality(i).. sum(j, is_connected_Steiner_terminal(i,j)) + sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) + sum(ii$(ord(i)<ord(ii)), is_connected_Steiner_Steiner(i,ii)) =e= 3;
Steiner_connectivity(i)$(ord(i)>1).. sum(ii$(ord(ii)<ord(i)), is_connected_Steiner_Steiner(ii,i)) =e= 1;
Model m / all /;
Solve m using minlp minimizing objective;
